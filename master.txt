--------------------------------------------------------------------------------
      name:  <unnamed>
       log:  C:\Users\gmetcalf\Dropbox\Metcalf_Stock\AER PP Submission Materials
> \Metcalf Stock Data Replication Public Folder\master.txt
  log type:  text
 opened on:  21 Mar 2022, 16:16:22

. set more off 

. set scheme s1color

. pause on

. 
. 
. ******************************************************************************
> *
.                 * 1. Setting up all the datasets
. ******************************************************************************
> *
. * INSTALL the following package if not already installed:
. net install tidy, from("https://raw.githubusercontent.com/matthieugomez/tidy.a
> do/master/") replace
checking tidy consistency and verifying not already installed...
installing into C:\Users\gmetcalf\ado\plus\...
installation complete.

. 
. 
. ************* Names ********************
. include "`root'/do_files/names.do"

. clear

. cd "`root'/stata"
C:\Users\gmetcalf\Dropbox\Metcalf_Stock\AER PP Submission Materials\Metcalf Stoc
> k Data Replication Public Folder\stata

. set more off 

. 
. ******************************************************************************
> *
. *
. *     Correct names data set 05/26/20 
. *       Edited, 2/14/22, S. Doshi
. *
. ******************************************************************************
> *
. import excel using "raw_data/names_2digit_corrected.xlsx", case(lower) first c
> lear 
(3 vars, 242 obs)

. 
. duplicates tag country,gen(tag)

Duplicates in terms of country

. gsort -tag

. drop tag

. replace country="MNE" if country2=="ME" //according to google
(1 real change made)

. replace country="MKD" if country2=="MK" //according to google
(1 real change made)

. drop if inlist(country2,"EU28","EA19","EA12","EU15","EU27_2019","EA")
(6 observations deleted)

. drop if country=="EURO"
(1 observation deleted)

. 
. *change country names to match names.dta 
. replace name="Uganda" if country=="UGA" //country==unknown
(1 real change made)

. replace name="Kosovo" if country=="UNK" //country==unknown
(1 real change made)

. replace name="Azerbaijan" if name=="Azerbaidjan"
(0 real changes made)

. replace name="Bosnia and Herzegovina" if name=="Bosnia-Herzegovina"
(0 real changes made)

. replace name="Congo_the Democratic Republic of the" if name=="Congo, Dem. Rep.
>  Of"
(1 real change made)

. replace name="Cote d'Ivoire" if name=="Côte d'Ivoire"
(1 real change made)

. replace name="Falkland Islands (Malvinas)" if name=="Falkland Islands"
(1 real change made)

. replace name="Iran, Islamic Republic of" if name=="Iran"
(1 real change made)

. replace name="Korea, Democratic People's Republic of" if name=="North Korea"
(1 real change made)

. replace name="Korea, Republic of" if name=="South Korea"
(1 real change made)

. replace name="Kyrgyzstan" if name=="Kirghizistan"
(1 real change made)

. replace name="Lao People's Democratic Republic" if name=="Laos"
(1 real change made)

. replace name="Libyan Arab Jamahiriya" if name=="Libya"
(1 real change made)

. replace name="Macao" if name=="Macau"
(1 real change made)

. replace name="Macedonia, the former Yugoslav Republic of" if name=="Macedonia"
(1 real change made)

. replace name="Micronesia, Federated States of" if name=="Micronesia, Federated
>  states of"
(1 real change made)

. replace name="Moldova, Republic of" if name=="Moldova"
(1 real change made)

. replace name="Palau" if name=="Pacific Islands (Palau)"
(1 real change made)

. replace name="Russian Federation" if name=="Russia"
(1 real change made)

. replace name="Syrian Arab Republic" if name=="Syria"
(1 real change made)

. replace name="Taiwan_Province of China" if name=="Chinese Taipei"
(1 real change made)

. replace name="Tajikistan" if name=="Tadjikistan"
(1 real change made)

. replace name="Tanzania_United Republic of" if name=="United Republic of Tanzan
> ia"
(1 real change made)

. replace name="Turkmenistan" if name=="Turkménistan"
(1 real change made)

. replace name="Viet Nam" if name=="Vietnam"
(1 real change made)

. replace name="Virgin Islands_USA" if name=="United States Virgin Islands"
(1 real change made)

. replace name="Slovakia" if name=="Slovak Republic"
(1 real change made)

. replace name="Czech Rep" if name=="Czech Republic"
(1 real change made)

. 
. *change 3-digit code to match names.dta
. replace country="HRV" if country=="FYUG-HRV"
(1 real change made)

. replace country="EST" if country=="USSR-EST"
(1 real change made)

. replace country="LVA" if country=="USSR-LVA"
(1 real change made)

. replace country="LTU" if country=="USSR-LTU"
(1 real change made)

. replace country="RUS" if country=="USSR-RUS"
(1 real change made)

. 
. rename (country name country2) (ID country ID_2digit)

. save data/names.dta,replace
(file data/names.dta not found)
file data/names.dta saved

. 
. 
. 
. ************* GDP data ********************
. *This file compiles the GDP dataset 
. 
. include "`root'/do_files/gdp.do"

. clear

. cd "`root'/stata"
C:\Users\gmetcalf\Dropbox\Metcalf_Stock\AER PP Submission Materials\Metcalf Stoc
> k Data Replication Public Folder\stata

. set more off 

. 
. ******************************************************************************
> *
. *
. *     Create GDP data set 01/25/20 
. *  Updated 03/14/22 by Siddhi D.
. *
. ******************************************************************************
> *
. *
. * create index2016 tempfile - US GDP deflator
. import excel using "raw_data\OECD_GDP.xlsx",sheet(US gdp deflator (FRED)) case
> (lower) first clear 
(5 vars, 59 obs)

. keep year index2016 index2015

. rename index2016 igdp16

.  label var igdp16 "US GDP deflator (2016=100)"

. tempfile igdp16

. save "`igdp16'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000001.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000001.tmp saved as .dta
    format

. *
. * create OECD ppp tempfile
. import excel using "raw_data\OECD_GDP.xlsx",sheet(OECD ppp) case(lower) first 
> clear 
(8 vars, 2,431 obs)

. keep location time value

. keep if location=="SWE"
(2,372 observations deleted)

. replace location="LIE" if location=="SWE"
(59 real changes made)

. tempfile pppLIE

. save "`pppLIE'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000002.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000002.tmp saved as .dta
    format

. 
. import excel using "raw_data\OECD_GDP.xlsx",sheet(OECD ppp) case(lower) first 
> clear 
(8 vars, 2,431 obs)

. keep location time value

. drop if location=="LIE"
(0 observations deleted)

. append using "`pppLIE'"

. rename location ID

. rename time year

. rename value ppp

.  label var ppp "Purchasing power parity (OECD)"

. tempfile ppp

. save "`ppp'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000003.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000003.tmp saved as .dta
    format

. 
. import excel using "raw_data\OECD_GDP.xlsx",sheet(GDP constant LCU) cellrange(
> A4:BK268) first clear
(63 vars, 264 obs)

. drop CountryName IndicatorName IndicatorCode

. reshape long _, i(CountryCode) j(year)
(j = 1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 
> 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 199
> 0 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2
> 006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018)

Data                               Wide   ->   Long
-----------------------------------------------------------------------------
Number of observations              264   ->   15,576      
Number of variables                  60   ->   3           
j variable (59 values)                    ->   year
xij variables:
                  _1960 _1961 ... _2018   ->   _
-----------------------------------------------------------------------------

. rename (CountryCode year _) (ID year rgdp)

.  label var rgdp "Real GDP, local currency"

. tempfile rgdp

. save "`rgdp'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000004.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000004.tmp saved as .dta
    format

. 
. * create gdp deflator local currency tempfile
. import excel using "raw_data\OECD_GDP.xlsx",sheet(GDP deflator) cellrange(A4:B
> K268) first clear
(63 vars, 264 obs)

. drop CountryName IndicatorName IndicatorCode

. reshape long _, i(CountryCode) j(year)
(j = 1960 1961 1962 1963 1964 1965 1966 1967 1968 1969 1970 1971 1972 1973 1974 
> 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988 1989 199
> 0 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2
> 006 2007 2008 2009 2010 2011 2012 2013 2014 2015 2016 2017 2018)

Data                               Wide   ->   Long
-----------------------------------------------------------------------------
Number of observations              264   ->   15,576      
Number of variables                  60   ->   3           
j variable (59 values)                    ->   year
xij variables:
                  _1960 _1961 ... _2018   ->   _
-----------------------------------------------------------------------------

. rename (CountryCode year _) (location time value)

. 
. preserve

. keep if location=="SWE"
(15,517 observations deleted)

. replace location="LIE" if location=="SWE"
(59 real changes made)

. tempfile pgdpLIE

. save "`pgdpLIE'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000006.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000006.tmp saved as .dta
    format

. restore

. 
. *import excel using "raw_data\OECD_GDP.xlsx",sheet(GDP deflator LCU) case(lowe
> r) first clear 
. *keep location time value
. drop if location=="LIE"
(59 observations deleted)

. append using "`pgdpLIE'"

. rename location ID

. rename time year

. rename value pgdp

.  label var pgdp "GDP deflator, local currency"

. tempfile pgdp

. save "`pgdp'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000007.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000007.tmp saved as .dta
    format

. *
. 
. * Modified Gross National Income and CPI for Ireland
. import excel using "raw_data\Irish Modified GNI.xlsx",sheet(data) case(lower) 
> first clear 
(11 vars, 35 obs)

. keep id year cpi_irl gnim_irl

. rename id ID

. tempfile gnim_irl

. save "`gnim_irl'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000008.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000008.tmp saved as .dta
    format

. 
. * Mainland GDP for Norway
. import excel using "raw_data\Norway_mainland_gdp.xlsx",sheet(tostata) case(low
> er) first clear 
(4 vars, 49 obs)

. gen pgdp_nor = 100*ngdp_nor/rgdp_nor

. rename id ID

. tempfile gdpm_nor

. save "`gdpm_nor'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000009.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_000009.tmp saved as .dta
    format

. 
. * merge 
. use "`igdp16'"

. merge 1:m year using "`ppp'" 

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             2,490  (_merge==3)
    -----------------------------------------

.  drop _merge

. merge 1:1 ID year using "`rgdp'" 

    Result                      Number of obs
    -----------------------------------------
    Not matched                        13,254
        from master                        84  (_merge==1)
        from using                     13,170  (_merge==2)

    Matched                             2,406  (_merge==3)
    -----------------------------------------

.  drop _merge

. merge 1:1 ID year using "`pgdp'" 

    Result                      Number of obs
    -----------------------------------------
    Not matched                            84
        from master                        84  (_merge==1)
        from using                          0  (_merge==2)

    Matched                            15,576  (_merge==3)
    -----------------------------------------

.  drop _merge

. merge 1:1 ID year using "`gnim_irl'" 

    Result                      Number of obs
    -----------------------------------------
    Not matched                        15,625
        from master                    15,625  (_merge==1)
        from using                          0  (_merge==2)

    Matched                                35  (_merge==3)
    -----------------------------------------

.  drop _merge

. merge 1:1 ID year using "`gdpm_nor'" 

    Result                      Number of obs
    -----------------------------------------
    Not matched                        15,611
        from master                    15,611  (_merge==1)
        from using                          0  (_merge==2)

    Matched                                49  (_merge==3)
    -----------------------------------------

.  drop _merge

. merge m:1 ID using "data/names" 
(variable ID was str4, now str8 to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                         4,435
        from master                     4,391  (_merge==1)
        from using                         44  (_merge==2)

    Matched                            11,269  (_merge==3)
    -----------------------------------------

.  drop if _merge==2
(44 observations deleted)

.  drop _merge

. 
.  
. * Ireland: eliminate for intellectual property investment boom
. *     (1) splice GDP (<=1995) and modified GNI using 1995 splice year
. *     (2) replace pgdp with cpi
. gen rgdp_wb = rgdp
(6,132 missing values generated)

.  label var rgdp_wb "Real GDP growth, World Bank, unadjusted"

. gen rgdp_x99 = rgdp
(6,132 missing values generated)

. gen pgdp_x99 = pgdp
(6,128 missing values generated)

. gen rgnim_irl = gnim_irl/cpi_irl
(15,636 missing values generated)

. su rgdp if (ID=="IRL")*(year==1995)

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
        rgdp |          1    8.09e+10           .   8.09e+10   8.09e+10

.  sca mrgdp95 = r(mean)

. su rgnim_irl if (ID=="IRL")*(year==1995)

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
   rgnim_irl |          1    758.0211           .   758.0211   758.0211

.  sca mrgni95 = r(mean)

. replace rgdp = (mrgdp95/mrgni95)*rgnim_irl if (ID=="IRL")*(year>=1995)
(23 real changes made)

. replace pgdp = cpi_irl if (ID=="IRL")
(49 real changes made, 14 to missing)

. list year ID cpi_irl pgdp_x99 pgdp gnim_irl rgdp_x99 rgnim_irl rgdp if (ID=="I
> RL")

       +---------------------------------------------------------------+
 6516. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1960 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6517. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1961 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6518. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1962 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6519. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1963 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6520. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1964 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6521. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1965 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6522. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1966 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6523. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1967 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6524. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1968 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6525. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1969 | IRL |       . |        . |     . |        . |        . |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |                   .            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6526. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1970 | IRL |       . |   8.1828 |     . |        . | 2.85e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           2.846e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6527. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1971 | IRL |       . |   9.0452 |     . |        . | 2.94e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           2.945e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6528. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1972 | IRL |       . | 10.25591 |     . |        . | 3.14e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           3.136e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6529. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1973 | IRL |       . | 11.82226 |     . |        . | 3.28e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           3.284e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6530. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1974 | IRL |       . | 12.54195 |     . |        . | 3.42e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           3.424e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6531. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1975 | IRL |       . | 15.06706 |     . |        . | 3.62e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           3.617e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6532. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1976 | IRL |       . |  18.2346 |     . |        . | 3.67e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           3.668e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6533. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1977 | IRL |       . | 20.65407 |     . |        . | 3.97e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           3.969e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6534. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1978 | IRL |       . | 22.82821 |     . |        . | 4.25e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           4.254e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6535. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1979 | IRL |       . | 25.95022 |     . |        . | 4.38e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           4.385e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6536. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1980 | IRL |       . | 29.76614 |     . |        . | 4.52e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           4.520e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6537. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1981 | IRL |       . | 34.95811 |     . |        . | 4.67e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           4.670e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6538. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1982 | IRL |       . | 40.26551 |     . |        . | 4.78e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           4.777e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6539. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1983 | IRL |       . |  44.5775 |     . |        . | 4.77e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           4.765e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6540. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1984 | IRL |    47.2 | 47.42122 |  47.2 |        . | 4.97e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           4.973e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6541. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1985 | IRL |    49.7 | 49.88063 |  49.7 |        . | 5.13e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           5.126e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6542. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1986 | IRL |    51.6 | 53.14767 |  51.6 |        . | 5.10e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           5.104e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6543. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1987 | IRL |    53.2 | 54.31554 |  53.2 |        . | 5.34e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           5.342e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6544. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1988 | IRL |    54.4 | 56.07879 |  54.4 |        . | 5.62e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           5.621e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6545. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1989 | IRL |    56.6 | 59.17533 |  56.6 |        . | 5.95e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           5.948e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6546. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1990 | IRL |    58.5 | 58.74383 |  58.5 |        . | 6.45e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           6.451e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6547. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1991 | IRL |    60.3 | 59.80204 |  60.3 |        . | 6.58e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           6.576e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6548. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1992 | IRL |    62.2 | 61.48381 |  62.2 |        . | 6.80e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           6.796e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6549. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1993 | IRL |    63.1 | 64.66605 |  63.1 |        . | 6.98e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           6.979e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6550. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1994 | IRL |    64.6 | 65.76184 |  64.6 |        . | 7.38e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |                  .           |           7.380e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6551. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1995 | IRL |    66.2 | 67.75706 |  66.2 |    50181 | 8.09e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           758.0211           |           8.091e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6552. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1996 | IRL |    67.3 | 69.28705 |  67.3 |    55399 | 8.69e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           823.1649           |           8.787e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6553. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1997 | IRL |    68.3 | 71.97429 |  68.3 |    62757 | 9.64e+10 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           918.8433           |           9.808e+10            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6554. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1998 | IRL |      70 | 76.67175 |    70 |    72150 | 1.05e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1030.714           |           1.100e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6555. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 1999 | IRL |    71.1 | 80.01381 |  71.1 |    80559 | 1.16e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1133.038           |           1.209e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6556. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2000 | IRL |    75.1 | 85.53698 |  75.1 |    94108 | 1.27e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1253.103           |           1.338e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6557. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2001 | IRL |    78.7 |  91.4274 |  78.7 |   103496 | 1.33e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |            1315.07           |           1.404e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6558. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2002 | IRL |    82.4 | 96.22684 |  82.4 |   112787 | 1.41e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1368.774           |           1.461e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6559. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2003 | IRL |    85.2 | 99.99907 |  85.2 |   123714 | 1.46e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1452.042           |           1.550e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6560. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2004 | IRL |    87.1 | 100.5166 |  87.1 |   132446 | 1.55e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |            1520.62           |           1.623e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6561. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2005 | IRL |    89.2 | 103.6489 |  89.2 |   144016 | 1.64e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1614.529           |           1.723e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6562. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2006 | IRL |    92.7 | 107.2292 |  92.7 |   157896 | 1.73e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1703.301           |           1.818e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6563. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2007 | IRL |    97.3 | 108.5273 |  97.3 |   165560 | 1.82e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1701.542           |           1.816e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6564. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2008 | IRL |   101.2 |  108.183 | 101.2 |   156906 | 1.74e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1550.455           |           1.655e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6565. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2009 | IRL |    96.7 | 103.2475 |  96.7 |   134841 | 1.65e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1394.426           |           1.488e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6566. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2010 | IRL |    95.8 |      100 |  95.8 |   128960 | 1.68e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1346.138           |           1.437e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6567. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2011 | IRL |    98.3 | 101.4964 |  98.3 |   126358 | 1.68e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1285.432           |           1.372e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6568. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2012 | IRL |    99.9 | 103.8102 |  99.9 |   126498 | 1.69e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1266.246           |           1.352e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6569. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2013 | IRL |   100.4 | 105.0845 | 100.4 |   136959 | 1.71e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1364.133           |           1.456e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6570. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2014 | IRL |   100.6 | 104.9681 | 100.6 |   148738 | 1.86e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1478.509           |           1.578e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6571. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2015 | IRL |   100.3 | 113.1447 | 100.3 |   162656 | 2.32e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1621.695           |           1.731e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6572. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2016 | IRL |   100.3 | 112.8057 | 100.3 |   175631 | 2.41e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1751.057           |           1.869e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6573. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2017 | IRL |   100.7 | 114.0795 | 100.7 |   183955 | 2.60e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1826.763           |           1.950e+11            |
       +---------------------------------------------------------------+

       +---------------------------------------------------------------+
 6574. | year |  ID | cpi_irl | pgdp_x99 |  pgdp | gnim_irl | rgdp_x99 |
       | 2018 | IRL |   101.2 | 115.0138 | 101.2 |   197460 | 2.82e+11 |
       |---------------------------------------------------------------|
       |           rgnim_~l           |                rgdp            |
       |           1951.186           |           2.083e+11            |
       +---------------------------------------------------------------+

. list year ID pgdp rgdp if (ID=="IRL")

       +--------------------------------+
       | year    ID    pgdp        rgdp |
       |--------------------------------|
 6516. | 1960   IRL       .           . |
 6517. | 1961   IRL       .           . |
 6518. | 1962   IRL       .           . |
 6519. | 1963   IRL       .           . |
 6520. | 1964   IRL       .           . |
       |--------------------------------|
 6521. | 1965   IRL       .           . |
 6522. | 1966   IRL       .           . |
 6523. | 1967   IRL       .           . |
 6524. | 1968   IRL       .           . |
 6525. | 1969   IRL       .           . |
       |--------------------------------|
 6526. | 1970   IRL       .   2.846e+10 |
 6527. | 1971   IRL       .   2.945e+10 |
 6528. | 1972   IRL       .   3.136e+10 |
 6529. | 1973   IRL       .   3.284e+10 |
 6530. | 1974   IRL       .   3.424e+10 |
       |--------------------------------|
 6531. | 1975   IRL       .   3.617e+10 |
 6532. | 1976   IRL       .   3.668e+10 |
 6533. | 1977   IRL       .   3.969e+10 |
 6534. | 1978   IRL       .   4.254e+10 |
 6535. | 1979   IRL       .   4.385e+10 |
       |--------------------------------|
 6536. | 1980   IRL       .   4.520e+10 |
 6537. | 1981   IRL       .   4.670e+10 |
 6538. | 1982   IRL       .   4.777e+10 |
 6539. | 1983   IRL       .   4.765e+10 |
 6540. | 1984   IRL    47.2   4.973e+10 |
       |--------------------------------|
 6541. | 1985   IRL    49.7   5.126e+10 |
 6542. | 1986   IRL    51.6   5.104e+10 |
 6543. | 1987   IRL    53.2   5.342e+10 |
 6544. | 1988   IRL    54.4   5.621e+10 |
 6545. | 1989   IRL    56.6   5.948e+10 |
       |--------------------------------|
 6546. | 1990   IRL    58.5   6.451e+10 |
 6547. | 1991   IRL    60.3   6.576e+10 |
 6548. | 1992   IRL    62.2   6.796e+10 |
 6549. | 1993   IRL    63.1   6.979e+10 |
 6550. | 1994   IRL    64.6   7.380e+10 |
       |--------------------------------|
 6551. | 1995   IRL    66.2   8.091e+10 |
 6552. | 1996   IRL    67.3   8.787e+10 |
 6553. | 1997   IRL    68.3   9.808e+10 |
 6554. | 1998   IRL      70   1.100e+11 |
 6555. | 1999   IRL    71.1   1.209e+11 |
       |--------------------------------|
 6556. | 2000   IRL    75.1   1.338e+11 |
 6557. | 2001   IRL    78.7   1.404e+11 |
 6558. | 2002   IRL    82.4   1.461e+11 |
 6559. | 2003   IRL    85.2   1.550e+11 |
 6560. | 2004   IRL    87.1   1.623e+11 |
       |--------------------------------|
 6561. | 2005   IRL    89.2   1.723e+11 |
 6562. | 2006   IRL    92.7   1.818e+11 |
 6563. | 2007   IRL    97.3   1.816e+11 |
 6564. | 2008   IRL   101.2   1.655e+11 |
 6565. | 2009   IRL    96.7   1.488e+11 |
       |--------------------------------|
 6566. | 2010   IRL    95.8   1.437e+11 |
 6567. | 2011   IRL    98.3   1.372e+11 |
 6568. | 2012   IRL    99.9   1.352e+11 |
 6569. | 2013   IRL   100.4   1.456e+11 |
 6570. | 2014   IRL   100.6   1.578e+11 |
       |--------------------------------|
 6571. | 2015   IRL   100.3   1.731e+11 |
 6572. | 2016   IRL   100.3   1.869e+11 |
 6573. | 2017   IRL   100.7   1.950e+11 |
 6574. | 2018   IRL   101.2   2.083e+11 |
       +--------------------------------+

. drop rgnim_irl gnim_irl cpi_irl rgdp_x99 pgdp_x99

. 
. * Norway: replace WB GDP with mainland GDP
. list year ID rgdp rgdp_nor pgdp pgdp_nor if ID=="NOR"

       +----------------------------------------------------------+
       | year    ID        rgdp   rgdp_nor        pgdp   pgdp_nor |
       |----------------------------------------------------------|
10410. | 1960   NOR   5.018e+11          .   7.4993114          . |
10411. | 1961   NOR   5.333e+11          .    7.697865          . |
10412. | 1962   NOR   5.483e+11          .   8.0647778          . |
10413. | 1963   NOR   5.691e+11          .   8.3383914          . |
10414. | 1964   NOR   5.976e+11          .   8.7321413          . |
       |----------------------------------------------------------|
10415. | 1965   NOR   6.292e+11          .   9.1490691          . |
10416. | 1966   NOR   6.530e+11          .   9.5129351          . |
10417. | 1967   NOR   6.938e+11          .   9.7949913          . |
10418. | 1968   NOR   7.095e+11          .    10.22831          . |
10419. | 1969   NOR   7.415e+11          .   10.657442          . |
       |----------------------------------------------------------|
10420. | 1970   NOR   7.559e+11     683922   12.109052   10.67929 |
10421. | 1971   NOR   7.988e+11     718831   12.882129   11.36623 |
10422. | 1972   NOR   8.413e+11     748128     13.5929   12.22652 |
10423. | 1973   NOR   8.795e+11     770318    14.77338   13.44081 |
10424. | 1974   NOR   9.140e+11     813804   16.453281   14.93369 |
       |----------------------------------------------------------|
10425. | 1975   NOR   9.592e+11     843214   17.915192   16.59401 |
10426. | 1976   NOR   1.015e+12     878275   19.319843   18.07167 |
10427. | 1977   NOR   1.057e+12     905074   20.898237   19.79175 |
10428. | 1978   NOR   1.098e+12     920192    22.20664   21.14146 |
10429. | 1979   NOR   1.146e+12     948075   23.472899   21.89088 |
       |----------------------------------------------------------|
10430. | 1980   NOR   1.199e+12     973862   26.553974   23.71055 |
10431. | 1981   NOR   1.218e+12     985831   29.973922   26.45697 |
10432. | 1982   NOR   1.221e+12     993323   33.124169   29.45276 |
10433. | 1983   NOR   1.269e+12    1010269   35.430406   31.69275 |
10434. | 1984   NOR   1.346e+12    1057724   37.630634   33.44067 |
       |----------------------------------------------------------|
10435. | 1985   NOR   1.421e+12    1110764   39.586678    35.2298 |
10436. | 1986   NOR   1.478e+12    1138247   39.368621   38.19883 |
10437. | 1987   NOR   1.504e+12    1164352   42.211574   41.86285 |
10438. | 1988   NOR   1.500e+12    1164398   44.266658   45.01596 |
10439. | 1989   NOR   1.516e+12    1155703   46.750941    46.6144 |
       |----------------------------------------------------------|
10440. | 1990   NOR   1.545e+12    1164329    48.53282    47.7779 |
10441. | 1991   NOR   1.593e+12    1182869   49.606222   49.10958 |
10442. | 1992   NOR   1.650e+12    1212448   49.288888   49.71191 |
10443. | 1993   NOR   1.697e+12    1242030   50.418921   50.49822 |
10444. | 1994   NOR   1.782e+12    1287604   50.340297   50.87628 |
       |----------------------------------------------------------|
10445. | 1995   NOR   1.856e+12    1325012   51.881456   52.88473 |
10446. | 1996   NOR   1.950e+12    1370417   54.092383   53.76342 |
10447. | 1997   NOR   2.053e+12    1440451   55.599244   55.21521 |
10448. | 1998   NOR   2.107e+12    1492660    55.21543   57.75937 |
10449. | 1999   NOR   2.149e+12    1527840   58.895667   59.37238 |
       |----------------------------------------------------------|
10450. | 2000   NOR   2.218e+12    1575368   67.985891   61.34357 |
10451. | 2001   NOR   2.264e+12    1599396   69.101284   64.34361 |
10452. | 2002   NOR   2.297e+12    1616829    67.93014   66.54903 |
10453. | 2003   NOR   2.318e+12    1635235   69.875064   68.76577 |
10454. | 2004   NOR   2.410e+12    1715157   73.952316   70.50987 |
       |----------------------------------------------------------|
10455. | 2005   NOR   2.473e+12    1797906   80.430144    72.3633 |
10456. | 2006   NOR   2.532e+12    1885224   87.488805   75.53139 |
10457. | 2007   NOR   2.608e+12    1989297   90.157282   78.69559 |
10458. | 2008   NOR   2.620e+12    2035170   99.564034   82.77122 |
10459. | 2009   NOR   2.576e+12    1995164   94.381651   85.32206 |
       |----------------------------------------------------------|
10460. | 2010   NOR   2.594e+12    2029881         100   88.27601 |
10461. | 2011   NOR   2.619e+12    2064297   106.75105   90.28207 |
10462. | 2012   NOR   2.690e+12    2141780   110.33488   92.70415 |
10463. | 2013   NOR   2.718e+12    2193405   113.14237   95.60555 |
10464. | 2014   NOR   2.772e+12    2243070   113.51552     98.147 |
       |----------------------------------------------------------|
10465. | 2015   NOR   2.827e+12    2271762   110.31241        100 |
10466. | 2016   NOR   2.860e+12    2287658   109.05923   101.9882 |
10467. | 2017   NOR   2.917e+12    2330013   113.28873   103.7104 |
10468. | 2018   NOR   2.959e+12    2385445   119.48641   105.4074 |
       +----------------------------------------------------------+

. replace rgdp = rgdp_nor if ID=="NOR"
(59 real changes made, 10 to missing)

. replace pgdp = pgdp_nor if ID=="NOR"
(59 real changes made, 10 to missing)

. drop rgdp_nor pgdp_nor ngdp_nor

. cap drop cnum*

. drop igdp16 rgdp_wb

. sort ID year

. save data/gdpdata, replace
(file data/gdpdata.dta not found)
file data/gdpdata.dta saved

. *
. 
. 
. 
. 
. ************* Carbon tax data ********************
. /*Compiles carbon tax data from various sources, mainly the World Bank's carbo
> n pricing dashboard.*/
. include "`root'/do_files/ctax.do"

. clear 

. cd "`root'/stata"
C:\Users\gmetcalf\Dropbox\Metcalf_Stock\AER PP Submission Materials\Metcalf Stoc
> k Data Replication Public Folder\stata

. set more off 

. 
. ******************************************************************************
> *
. *
. *     Create carbon tax data set 01/25/20 
. *               Edited, 2/12/22, G. Metcalf
. *
. ******************************************************************************
> *
. *
. ***************************** create ctax.dta ********************************
> **
. global EUctax CHE DNK ESP EST FIN FRA GBR IRL ISL LVA NOR POL PRT SVN SWE LIE

. 
. * read in the degree to which carbon tax revenues were initially intended to r
> educe existing tax rates
. import excel using "raw_data\WB_CarbonTaxData.xlsx", sheet(CTaxDetails) cellra
> nge(A2:U19) first case(l) clear 
(21 vars, 17 obs)

. replace country="United Kingdom" if country=="UK"
variable country was str13 now str14
(1 real change made)

. rename revenuerecyclingvariable IntRevRec

. label var IntRevRec "Fraction of carbon tax revenues initially earmarked for t
> ax reduction"

. keep country IntRevRec

. merge 1:1 country using data/names
(variable country was str14, now str66 to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                           218
        from master                         0  (_merge==1)
        from using                        218  (_merge==2)

    Matched                                17  (_merge==3)
    -----------------------------------------

. drop if _merge!=3
(218 observations deleted)

. drop _merge ID_2digit

. tempfile IntRevRec

. save "`IntRevRec'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000a.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000a.tmp saved as .dta
    format

. 
. * create share tempfile 
. import excel using "raw_data\WB_CarbonTaxData.xlsx",sheet(share) first clear 
(17 vars, 1 obs)

. gather $EUctax, variable(ID) value(share) 
(j = 1 10 11 12 13 14 15 16 2 3 4 5 6 7 8 9)

Data                               Wide   ->   Long
-----------------------------------------------------------------------------
Number of observations                1   ->   16          
Number of variables                  17   ->   3           
j variable (16 values)                    ->   ID
xij variables:
                 ____1 ____10 ... ____9   ->   ____
-----------------------------------------------------------------------------

. label var share "share of jurisdiction's GHG emissions covered by tax"

. tempfile share

. save "`share'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000b.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000b.tmp saved as .dta
    format

. 
. * read in carbon tax rate in local currency
. import excel using "raw_data\WB_CarbonTaxData.xlsx",sheet(rate_LCU) cellrange(
> A2:Q32) first clear 
(17 vars, 30 obs)

. desc

Contains data
 Observations:            30                  
    Variables:            17                  
--------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
--------------------------------------------------------------------------------
year            int     %10.0g                year
CHE             byte    %14.2fc               CHE
DNK             double  %14.2fc               DNK
ESP             byte    %14.2fc               ESP
EST             double  %14.2fc               EST
FIN             double  %14.2fc               FIN
FRA             double  %14.2fc               FRA
GBR             double  %14.2fc               GBR
IRL             byte    %14.2fc               IRL
ISL             double  %14.2fc               ISL
LVA             double  %14.2fc               LVA
NOR             int     %14.2fc               NOR
POL             double  %14.2fc               POL
PRT             double  %14.2fc               PRT
SVN             double  %14.2fc               SVN
SWE             int     %14.2fc               SWE
LIE             byte    %14.2fc               LIE
--------------------------------------------------------------------------------
Sorted by: 
     Note: Dataset has changed since last saved.

. gather $EUctax, variable(ID) value(rate_CTI_LCU) 
(j = 1 10 11 12 13 14 15 16 2 3 4 5 6 7 8 9)

Data                               Wide   ->   Long
-----------------------------------------------------------------------------
Number of observations               30   ->   480         
Number of variables                  17   ->   3           
j variable (16 values)                    ->   ID
xij variables:
                 ____1 ____10 ... ____9   ->   ____
-----------------------------------------------------------------------------

. label var rate_CTI_LCU "Carbon tax rate from WB CTI (nominal local currency)"

. tempfile rate_CTI_LCU

. save "`rate_CTI_LCU'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000c.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000c.tmp saved as .dta
    format

. 
. * merge
. merge 1:1 ID year using "`share'"

    Result                      Number of obs
    -----------------------------------------
    Not matched                           464
        from master                       464  (_merge==1)
        from using                          0  (_merge==2)

    Matched                                16  (_merge==3)
    -----------------------------------------

. drop _merge

. merge 1:1 ID year using "`rate_CTI_LCU'"

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                               480  (_merge==3)
    -----------------------------------------

. drop _merge

. merge m:1 ID using "`IntRevRec'"
(variable ID was str3, now str8 to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             1
        from master                         0  (_merge==1)
        from using                          1  (_merge==2)

    Matched                               480  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. *
. * share of emissions covered by ctax in 2019
. sort ID year

. by ID: egen share19 = max(share)
(1 missing value generated)

. replace share19 = 0 if share19 == .
(1 real change made)

.  label var share19 "share GHG emissions covered by tax in 2019"

. list ID year share share19 if (ID=="SWE")|(ID=="USA")

     +------------------------------+
     |  ID   year   share   share19 |
     |------------------------------|
451. | SWE   1990       .        .4 |
452. | SWE   1991       .        .4 |
453. | SWE   1992       .        .4 |
454. | SWE   1993       .        .4 |
455. | SWE   1994       .        .4 |
     |------------------------------|
456. | SWE   1995       .        .4 |
457. | SWE   1996       .        .4 |
458. | SWE   1997       .        .4 |
459. | SWE   1998       .        .4 |
460. | SWE   1999       .        .4 |
     |------------------------------|
461. | SWE   2000       .        .4 |
462. | SWE   2001       .        .4 |
463. | SWE   2002       .        .4 |
464. | SWE   2003       .        .4 |
465. | SWE   2004       .        .4 |
     |------------------------------|
466. | SWE   2005       .        .4 |
467. | SWE   2006       .        .4 |
468. | SWE   2007       .        .4 |
469. | SWE   2008       .        .4 |
470. | SWE   2009       .        .4 |
     |------------------------------|
471. | SWE   2010       .        .4 |
472. | SWE   2011       .        .4 |
473. | SWE   2012       .        .4 |
474. | SWE   2013       .        .4 |
475. | SWE   2014       .        .4 |
     |------------------------------|
476. | SWE   2015       .        .4 |
477. | SWE   2016       .        .4 |
478. | SWE   2017       .        .4 |
479. | SWE   2018       .        .4 |
480. | SWE   2019      .4        .4 |
     +------------------------------+

. *
. * save ctax data
. sort ID year

. label var ID "3-digit country code"

. desc

Contains data from C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000c.tmp
 Observations:           481                  
    Variables:             7                  21 Mar 2022 16:16
--------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
--------------------------------------------------------------------------------
year            int     %10.0g                year
ID              str8    %9s                   3-digit country code
rate_CTI_LCU    double  %14.2fc               Carbon tax rate from WB CTI
                                                (nominal local currency)
share           double  %10.0g                share of jurisdiction's GHG
                                                emissions covered by tax
country         str66   %66s                  Country
IntRevRec       double  %10.0g                Fraction of carbon tax revenues
                                                initially earmarked for tax
                                                reduction
share19         float   %9.0g                 share GHG emissions covered by tax
                                                in 2019
--------------------------------------------------------------------------------
Sorted by: ID  year
     Note: Dataset has changed since last saved.

. save data/ctax_CTI, replace
(file data/ctax_CTI.dta not found)
file data/ctax_CTI.dta saved

. 
. 
. 
. *************  Employment data ********************
. *Total employment data
. include "`root'/do_files/employment.do"

. clear

. *local root "/Users//`=c(username)'/Dropbox/Metcalf_Stock/stata/_Siddhi/AEA Pa
> ndP Data Construction and Replication/Replication_AEAPP_cleaning" //for mac
. cd "`root'/stata"
C:\Users\gmetcalf\Dropbox\Metcalf_Stock\AER PP Submission Materials\Metcalf Stoc
> k Data Replication Public Folder\stata

. set more off 

. 
. ******************************************************************************
> *
. *
. *     Create employment data set 01/25/20 
. *
. ******************************************************************************
> *
. *
. global country Austria Belgium Bulgaria Switzerland Cyprus Czechia Germanyunti
> l1990formerterri Denmark EuroareaEA112000EA122006 Euroarea12countries Euroarea
> 19countries Estonia Greece Spain EuropeanUnion15countries1 EuropeanUnion27coun
> triesf EuropeanUnion28countries Finland France Croatia Hungary Ireland Iceland
>  Italy Liechtenstein Lithuania Luxembourg Latvia Montenegro NorthMacedonia Mal
> ta Netherlands Norway Poland Portugal Romania Serbia Sweden Slovenia Slovakia 
> UnitedKingdom

. 
. ***** Total Employment *****
. import excel using "raw_data/Total employment domestic_Thousand persons", shee
> t(Data1) cellrange(A11:AP55) firstrow clear
(42 vars, 44 obs)

. foreach i in $country {
  2. if "`i'" != "Denmark" & "`i'" != "France" & "`i'" != "Norway" {
  3. qui replace `i' = "" if `i' == ":" 
  4. qui destring `i', replace
  5. }
  6. }

. gather $country, variable(country) value(total_employment) 
(j = 1 10 11 12 13 14 15 16 17 18 19 2 20 21 22 23 24 25 26 27 28 29 3 30 31 32 
> 33 34 35 36 37 38 39 4 40 41 5 6 7 8 9)

Data                               Wide   ->   Long
-----------------------------------------------------------------------------
Number of observations               44   ->   1,804       
Number of variables                  42   ->   3           
j variable (41 values)                    ->   country
xij variables:
                 ____1 ____10 ... ____9   ->   ____
-----------------------------------------------------------------------------

. 
. tempfile total_employment

. save "`total_employment'", replace
(file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000d.tmp not found)
file C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000d.tmp saved as .dta
    format

. 
. /*
> ***** Manufacturing Employment *****
> import excel using "raw_data/Total employment domestic_Thousand persons", shee
> t(Data4) cellrange(A11:AP55) firstrow clear
> foreach i in $country {
> if "`i'" != "Denmark" & "`i'" != "France" & "`i'" != "Norway" {
> qui replace `i' = "" if `i' == ":" 
> qui destring `i', replace
> }
> }
> gather $country, variable(country) value(manufacturing_employment) 
> */
. 
. ***** merge with Total Employment dataset *****
. merge 1:1 country TIMEGEO using "`total_employment'"

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             1,804  (_merge==3)
    -----------------------------------------

. drop _merge

. 
. *rename countries
. replace country="Czech Republic" if country=="Czechia"
(44 real changes made)

. replace country="Germany" if country=="Germanyuntil1990formerterri"
(44 real changes made)

. replace country="United Kingdom" if country=="UnitedKingdom"
(44 real changes made)

. replace country="Slovak Republic" if country=="Slovakia"
(44 real changes made)

. rename TIMEGEO year

. 
. label var total_employment "Total employment domestic concept (thousand person
> s)"

. *label var manufacturing_employment "Manufacturing employment domestic concept
>  (thousand persons)"
. label var country "Country name"

. 
. destring year,replace
year: all characters numeric; replaced as int

. merge m:1 country using "data/names"
(variable country was str27, now str66 to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                           644
        from master                       440  (_merge==1)
        from using                        204  (_merge==2)

    Matched                             1,364  (_merge==3)
    -----------------------------------------

. tab country if _merge==1

                           Country name |      Freq.     Percent        Cum.
----------------------------------------+-----------------------------------
                         Czech Republic |         44       10.00       10.00
                    Euroarea12countries |         44       10.00       20.00
                    Euroarea19countries |         44       10.00       30.00
               EuroareaEA112000EA122006 |         44       10.00       40.00
              EuropeanUnion15countries1 |         44       10.00       50.00
              EuropeanUnion27countriesf |         44       10.00       60.00
               EuropeanUnion28countries |         44       10.00       70.00
                         NorthMacedonia |         44       10.00       80.00
                                 Serbia |         44       10.00       90.00
                        Slovak Republic |         44       10.00      100.00
----------------------------------------+-----------------------------------
                                  Total |        440      100.00

. drop if _merge!=3
(644 observations deleted)

. drop _merge

. desc

Contains data from C:\Users\gmetcalf\AppData\Local\Temp\ST_3c24_00000d.tmp
 Observations:         1,364                  
    Variables:             5                  21 Mar 2022 16:16
--------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
--------------------------------------------------------------------------------
year            int     %10.0g                TIME/GEO
country         str66   %66s                  Country name
total_employm~t double  %10.0g                Total employment domestic concept
                                                (thousand persons)
ID              str8    %9s                   country
ID_2digit       str9    %9s                   country2
--------------------------------------------------------------------------------
Sorted by: 
     Note: Dataset has changed since last saved.

. save "data/employment.dta",replace
(file data/employment.dta not found)
file data/employment.dta saved

. 
. 
. 
. 
. ******************************************************************************
> *
. * 2. Merging the datasets and running calculations to create the final dataset
>  
. ******************************************************************************
> *
. include "`root'/do_files/merge and calculate 2018.do"

. cd "`root'/stata"
C:\Users\gmetcalf\Dropbox\Metcalf_Stock\AER PP Submission Materials\Metcalf Stoc
> k Data Replication Public Folder\stata

. 
. ******************************************************************************
> *
. *
. * Merge gdpdata, ctax, diesel price, and employment data and do calculations  
> 01/25/20 
. *
. ******************************************************************************
> *
. *
. *********************************************************
. * merge gdpdata, ctax, energy price, and employment data
. *********************************************************
. *
. use data/gdpdata, clear

. 
. merge 1:1 ID year using data/ctax_CTI

    Result                      Number of obs
    -----------------------------------------
    Not matched                        15,213
        from master                    15,196  (_merge==1)
        from using                         17  (_merge==2)

    Matched                               464  (_merge==3)
    -----------------------------------------

. drop _merge

. merge 1:1 ID year using data/employment

    Result                      Number of obs
    -----------------------------------------
    Not matched                        14,313
        from master                    14,313  (_merge==1)
        from using                          0  (_merge==2)

    Matched                             1,364  (_merge==3)
    -----------------------------------------

. drop _merge

. rename total_employment emptot

. sort country year

. drop if inlist(ID,"DEW","EA19","EU28","OECDE","OEU")
(84 observations deleted)

. drop if country==""
(4,307 observations deleted)

. order country ID year

. sort ID year

. *
. *********************************************************
. *  Work on merged data set
. *********************************************************
. *
. * extend share of emissions to earlier dates
. cap drop x99=.

. sort ID year

. by ID: egen x99 = max(share19)
(10,325 missing values generated)

. replace share19 = x99
(480 real changes made)

. replace share19 = 0 if share19==.
(10,325 real changes made)

. drop x99

. *
. *********************************************************
. *  Create OECD- and FSU-wide growth rates: gdp, gdppc, emptot, empman
. *********************************************************
. 
. sort ID year

. egen cnum = group(ID)

. xtset cnum year

Panel variable: cnum (unbalanced)
 Time variable: year, 1960 to 2019
         Delta: 1 unit

. 
. * Growth rates
. *foreach yy of varlist rgdp rgdppc rgdp_oecd rgdppc_oecd empman emptot emitot 
> emih emilevel emission2 emission2pc emission6 emission6pc emission_ctsectors e
> mission_ctsectorspc{
. foreach yy of varlist rgdp emptot{
  2.  gen l`yy' = ln(`yy')
  3.  gen dl`yy' = 100*D.l`yy'
  4. }
(2,450 missing values generated)
(2,640 missing values generated)
(10,517 missing values generated)
(10,547 missing values generated)

. label var dlrgdp   "Real GDP annual growth rate (percent)"

. label var dlemptot "Total employment annual growth rate (percent)"

. 
. *
. *********************************************************
. *  Create ctax related variables working with merged gdp and ctax data
. *********************************************************
. *
. replace rate_CTI_LCU = 0 if rate_CTI_LCU==.
(11,012 real changes made)

. gen ctax = (rate_CTI_LCU>0)

.  label var ctax "= 1 if carbon tax in effect"

. sort ID year

. by ID: egen ctaxever = max(ctax)

.  label var ctaxever "carbon tax in any year"

. 
. * Create deflator which is GDP deflator, adjusted for exchange rate conversion
>  
. *   for countries switching to the Euro in-sample, normalized to 2018 = 100 
. 
. gen x99 = .
(11,286 missing values generated)

.  replace x99 = pgdp if year==2018
(172 real changes made)

. by ID: egen pindex = max(x99)
(1,122 missing values generated)

.  replace pindex = 100*pgdp/pindex
(10,164 real changes made, 1,938 to missing)

. * Estonia: EUR 1 = 15.6466 Estonian kroonid, 1/1/2011, https://ec.europa.eu/in
> fo/business-economy-euro/euro-area/euro/eu-countries-and-euro/estonia-and-euro
> _en
. *           tax rate in Euros starting 2011, revenues always in Euros 
. replace pindex = pindex*15.6466 if (ID=="EST")*(year<2011)
(16 real changes made)

. * Finland: 1 = 5.94573 mk, 1/1/2002, https://ec.europa.eu/info/business-econom
> y-euro/euro-area/euro/eu-countries-and-euro/finland-and-euro_en
. *     both tax rate and revenues are in Finmarks through 1999, in Euros 2000+
. replace pindex = pindex*5.94573 if (ID=="FIN")*(year<2000)
(40 real changes made)

. * Latvia: 1 = 0.702804 Latvian lat, 1/1/2014, https://ec.europa.eu/info/busine
> ss-economy-euro/euro-area/euro/eu-countries-and-euro/latvia-and-euro_en
. *     both tax rate and revenues are in LVL through 2013, in Euros 2014+
. replace pindex = pindex*0.702804 if (ID=="LVA")*(year<2014)
(20 real changes made)

. * Slovenia: EUR 1 = SIT 239.64, 1/1/2007, https://ec.europa.eu/info/business-e
> conomy-euro/euro-area/euro/eu-countries-and-euro/slovenia-and-euro_en
. *           tax rate in Euros starting 2007, revenues in Euros starting 2000
. replace pindex = pindex*239.64 if (ID=="SVN")*(year<2007)
(17 real changes made)

.  label var pindex "LCU price index (GDP deflator, adjusted for Euro entry, 201
> 8=100)"

. 
. 
. replace x99 = .
(172 real changes made, 172 to missing)

.  replace x99 = ppp if year==2018
(53 real changes made)

. by ID: egen ppp18 = max(x99)
(8,143 missing values generated)

.  label var ppp18 "PPP in 2018"

. 
. * Nominal carbon tax rate, local currency, normalized to USD using 2018 PPP
. gen rate_LCU_USD18 = rate_CTI_LCU/ppp18
(8,143 missing values generated)

.  label var rate_LCU_USD18 "Carbon tax rate (nominal, LCU, 2018 USD @ PPP)"

. 
. * Real carbon tax rate, local currency, 2018 LCUs
. gen rater_LCU = rate_CTI_LCU/(pindex/100)
(3,060 missing values generated)

.  label var rater_LCU "Carbon tax rate (real, LCU, 2018 LCU)"

. 
. * Real carbon tax rate, 2018 USD, PPP conversion
. gen rater_LCU_USD18 = rater_LCU/ppp18
(8,668 missing values generated)

.  label var rater_LCU_USD18 "Carbon tax rate (real, LCU, 2018 USD @ PPP)"

.  
. *
. * First year of carbon tax
. cap drop cnum

. egen cnum = group(ID)

. su cnum, d

                          group(ID)
-------------------------------------------------------------
      Percentiles      Smallest
 1%            2              1
 5%           10              1
10%           20              1       Obs              11,286
25%           48              1       Sum of wgt.      11,286

50%           96                      Mean           96.05954
                        Largest       Std. dev.       55.2204
75%          144            192
90%          172            192       Variance       3049.293
95%          183            192       Skewness       .0055582
99%          191            192       Kurtosis       1.806289

. local cnummax = r(max)

. dis `cnummax'
192

. gen ctaxyear = .
(11,286 missing values generated)

. gen c99 = .
(11,286 missing values generated)

.  replace c99 = ctax*year if ctax==1
(274 real changes made)

. forvalues i = 1/`cnummax' {
  2.  qui su c99 if cnum==`i', d
  3.  qui replace ctaxyear = r(min) if cnum==`i'
  4. }

. label var ctaxyear "First year of carbon tax (else missing)"

. drop c99 cnum

. 
. *********************************************************
. * Dummy variables for Europe ETS participants and other country groups
. *********************************************************
. gen EU = 0

.  replace EU = 1 if inlist(ID,"AUT","BEL","BGR","CYP","CZE","DEU","DNK","ESP") 
(474 real changes made)

.  replace EU = 1 if inlist(ID,"EST","FIN","FRA","GBR","GRC","HRV","HUN","IRL") 
(477 real changes made)

.  replace EU = 1 if inlist(ID,"ISL","ITA","LTU","LUX","LVA","MLT","NLD","NOR")
(475 real changes made)

.  replace EU = 1 if inlist(ID,"POL","PRT","ROU","SVK","SVN","SWE","LIE" )
(418 real changes made)

. 
.  label var EU "member of EU ETS"

. gen EU2 = EU

.  replace EU2 = 1 if ID=="CHE"
(60 real changes made)

.  label var EU2 "EU plus Iceland, Norway, Switzerland"

. gen EU3 = EU2

.  replace EU3 = 1 if inlist(ID,"CHE","USA","CAN","JPN") 
(177 real changes made)

.  label var EU3 "EUETS+CHE+US+CA+JPN"

. *
. 
. *
. sort ID year

. label var year "Year"

. cap drop x99

. cap drop y99

. keep if EU3
(9,205 observations deleted)

.  
. *desc
. *save data/ctax_gdp2018,replace
. 
. *
. * AER P&P data set
. keep ID country year dlrgdp dlemptot rater_LCU_USD18 ctaxyear share19 EU EU2 c
> taxever

. keep if EU2
(177 observations deleted)

. keep if (year>=1985)*(year<=2018)
(816 observations deleted)

. save data/ctax_gdp_AERPP2018, replace
file data/ctax_gdp_AERPP2018.dta saved

. desc

Contains data from data/ctax_gdp_AERPP2018.dta
 Observations:         1,088                  
    Variables:            11                  21 Mar 2022 16:16
--------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
--------------------------------------------------------------------------------
country         str66   %66s                  name
ID              str8    %9s                   LOCATION
year            int     %10.0g                Year
share19         float   %9.0g                 share GHG emissions covered by tax
                                                in 2019
dlrgdp          float   %9.0g                 Real GDP annual growth rate
                                                (percent)
dlemptot        float   %9.0g                 Total employment annual growth
                                                rate (percent)
ctaxever        float   %9.0g                 carbon tax in any year
rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018
                                                USD @ PPP)
ctaxyear        float   %9.0g                 First year of carbon tax (else
                                                missing)
EU              float   %9.0g                 member of EU ETS
EU2             float   %9.0g                 EU plus Iceland, Norway,
                                                Switzerland
--------------------------------------------------------------------------------
Sorted by: ID  year

. 
. 
. 
. 
. erase "`root'/stata/data/names.dta"

. erase "`root'/stata/data/gdpdata.dta"

. erase "`root'/stata/data/ctax_CTI.dta"

. erase "`root'/stata/data/employment.dta"

. 
. ******************************************************************************
> *
. * 3. AERPP replication
. ******************************************************************************
> *
. include "`root'/do_files/EUctax_IRF_AERPP.do"

. *********************************************
. *  EUctax_IRF_AERPP.do           JS 1/8/20
. *     IRFS and dynamic causal effects of carbon tax on gdp growth
. *     Results for Metcalf-Stock AER P&P (2020)
. *      Builds on e1123_mid19_2.do and Table6.do
. *
. /* ------- Variables ------------
> Icountry         str32   %32s                  country
> ID              str8    %9s                   LOCATION
> year            int     %10.0g                Year
> share19         float   %9.0g                 share GHG emissions covered by t
> ax in 2019
> dlrgdp          float   %9.0g                 Real GDP annual growth rate (per
> cent)
> dlemptot        float   %9.0g                 Total employment annual growth r
> ate (percent)
> ctaxever        float   %9.0g                 carbon tax in any year
> rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018
>  USD @ PPP)
> ctaxyear        float   %9.0g                 First year of carbon tax (else m
> issing)
> EU              float   %9.0g                 member of EU ETS
> EU2             float   %9.0g                 EU plus Iceland, Norway, Switzer
> land
> *********************************************/
. *read in data
. use data/ctax_gdp_AERPP2018, clear

. desc

Contains data from data/ctax_gdp_AERPP2018.dta
 Observations:         1,088                  
    Variables:            11                  21 Mar 2022 16:16
--------------------------------------------------------------------------------
Variable      Storage   Display    Value
    name         type    format    label      Variable label
--------------------------------------------------------------------------------
country         str66   %66s                  name
ID              str8    %9s                   LOCATION
year            int     %10.0g                Year
share19         float   %9.0g                 share GHG emissions covered by tax
                                                in 2019
dlrgdp          float   %9.0g                 Real GDP annual growth rate
                                                (percent)
dlemptot        float   %9.0g                 Total employment annual growth
                                                rate (percent)
ctaxever        float   %9.0g                 carbon tax in any year
rater_LCU_USD18 float   %9.0g                 Carbon tax rate (real, LCU, 2018
                                                USD @ PPP)
ctaxyear        float   %9.0g                 First year of carbon tax (else
                                                missing)
EU              float   %9.0g                 member of EU ETS
EU2             float   %9.0g                 EU plus Iceland, Norway,
                                                Switzerland
--------------------------------------------------------------------------------
Sorted by: ID  year

. *
. ************************************************************
. * Create variables
. ************************************************************
. *
. global fxlsout "results/AERPP_Tables.xlsx"

. gen rater_LCU_USD18sw = rater_LCU_USD18*share19
(72 missing values generated)

.  label var rater_LCU_USD18sw "Carbon tax rate (real, 2018 USD) wtd by coverage
>  share"

. *
. egen x99 = max(rater_LCU_USD18), by(ID)

. gen CT20 = (x99>=20)

. drop x99

. *
. * Table 1
. preserve

.  keep if (year==2018)*ctaxever
(1,072 observations deleted)

.  sort ctaxyear ID

.  keep country ctaxyear rater_LCU_USD18 share19 

.  order country ctaxyear rater_LCU_USD18 share19

.  label variable ctaxyear "Year"

.  label variable country "Country"

.  label variable rater_LCU_USD18 "Rate in 2018 (USD)"

.  label variable share19 "Coverage (2019)"

.  export excel $fxlsout, replace firstrow(varlabels) sheet("Table 1")  keepcell
> fmt
file results/AERPP_Tables.xlsx saved

. restore

. 
. ************************************************************
. * lag parameters and globals
. ************************************************************
. global p = 6  // number of horizons, also number of lags in DL specifications

. global lplags = 2  // number of lags in LP and XTVAR specifications

. 
. global YE "i.year"

. 
. 
. ************************************************************
. *
. * housekeeping
. local p $p

. local lplags $lplags

. local pm2 = `p'-2

. local pm1 = `p'-1

. local pp1 = `p'+1

. local lplagsm1 = `lplags'-1

. 
. ************************************************************
. * IRFs
. *    Frameworks: DL, LP, panel VAR (as check on LP)
. *    X vbles: real rate equal-wtd (rrate) and share19-wtd (rratesw)
. *    Various controls
. ************************************************************
. local controls "YE"

. global controls "`controls'"

. sca irfno = 0

. foreach y in "lrgdp" "lemptot" {
  2. 
.  foreach smple in "EU2" "CT20" {
  3.   preserve
  4.   keep if `smple'
  5. 
.   if "`smple'"=="EU2" {
  6.    local x "rater_LCU_USD18sw"
  7.   }
  8.   else {
  9.    local x "rater_LCU_USD18"
 10.   }
 11.   *
.   * set panel
.   cap drop cdum
 12.   cap drop cnum
 13.   egen cnum = group(ID)
 14.   xtset cnum year
 15.   tab year, gen(ydum)
 16.   tab ID, gen(cdum)
 17.   local nc = r(r)
 18.   
.   * carbon tax path
.   sca rateinit = 40
 19.   if strmatch("`x'","lctaxratio*") sca rateinit = ln(1 + .40/3) // $40/ton 
> = $0.40/gal @ $3/gal diesel
 20.   sca swfac = 1
 21.    if strmatch("`x'","*sw") sca swfac = 0.3
 22.   mat xpath = J(`pp1',1,rateinit) // real carbon tax path
 23. 
.   global y "`y'"
 24.   global x "`x'"
 25.   global smple "`smple'"
 26. 
.  *----------------------------------------------------------------------------
> ---------------
.  *             DL estimation 
.  * effect on GDP growth h-periods hence of unit step-up in x, allowing for LR 
> effect of level of tax on GDP growth
.  *----------------------------------------------------------------------------
> ---------------
.  *
.    global est "DL"
 27.    sca irfno = irfno+1
 28.     xtreg d`y' L(0/`pm1').D.`x' L`p'.`x' $`controls', fe vce(cluster cnum)
 29.      mat b99 = e(b)'
 30.      mat v99 = e(V)
 31. 
.     do "`root'/do_files/EUctax_IRF_AERPP_out_r1.do"
 32.  *
.  *----------------------------------------------------------------------------
> ---------------
.  *             LP estimation II
.  *  Via individual regs with dummy variables 
.  *  Notes on SE computation:
.  *    1. HAC SEs not needed, these are HR (Montiel Olea- Plagborg Moller (2019
> ))
.  *    2. SEs computed for full covariance matrix of IRFs across regressions us
> ing
.  *       x's*resids for different horizon regressions. The messiness below is 
> because
.  *       the different horizon regressions are computed over different samples
> , so VCV matrix
.  *       must be computed for the overlapping data in each covariance matrix p
> air.
.  *    3. It is easiest coding to use SUREG to estimate all equestions at once,
>  unfortunately
.  *       sureg estimates them all on the same sample which is the sample for l
> ongest-horizon
.  *       thus it is inefficient relative to OLS one-at-a-time. For sureg imple
> mentation see
.  *       EUctax_IRF_2.do ("LP estimation III")
.  *----------------------------------------------------------------------------
> ---------------
.  *
.    global est "LP"
 33.    mat theta11 = J(`pp1',1,1)
 34.    sca irfno = irfno+1
 35.     mat b99 = J(`pp1',1,0)
 36.     mat s99 = b99
 37.     cap drop e99*
 38.     forvalues h = 0/`p' {
 39.      local hp1 = `h'+1
 40.      * effect on GDP growth h-periods hence of unit innovation in x, allowi
> ng for LR effect of level of tax on GDP growth
.       reg F`h'.d`y' L(0/`lplags').`x' L(1/`lplags').d`y' $`controls' cdum*, r
 41.      mat b98 = e(b)
 42.      mat b99[`hp1',1] = b98[1,1]
 43.      * create product of X projected off of controls * resids for computing
>  HR VCV matrix
.      local k = e(df_m)
 44.      cap drop smpl`h' e`h' etax`h' zz`h'
 45.          qui gen smpl`h' = e(sample)
 46.          qui predict e`h', resid
 47.      qui reg `x' L(1/`lplags').`x' L(1/`lplags').d`y' $`controls' cdum* if 
> smpl`h', r
 48.          qui predict etax`h', resid
 49.          qui su etax`h' if smpl`h'
 50.      gen zz`h' = (r(N)/(r(N)-1))*(e`h'*etax`h'/r(Var))/sqrt(r(N)-`k') if sm
> pl`h'
 51.      * IRF from rate shock to rate - for inverting rate path to shocks
.      if `h'>0 {
 52.       qui areg F`h'.`x' L(0/`lplags').`x' L(1/`lplags').d`y' $`controls', a
> bsorb(cnum) vce(r)
 53.       mat b97 = e(b)
 54.       mat theta11[`h'+1,1] = b97[1,1]
 55.      }
 56.     } // end of loop over horizon
 57.         * Compute covariance matrix over different subsamples for different
>  horizon LP estimation
.         mat v99 = I(`p'+1)
 58.         forvalues i = 0/`p' {
 59.          qui su zz`i'
 60.          mat v99[`i'+1,`i'+1] = r(Var)
 61.          dis `i' "   " b99[`i'+1,1] "   " sqrt(v99[`i'+1,`i'+1])
 62.          local ip1 = `i'+1
 63.          forvalues j = `ip1'/`p' {
 64.           qui corr zz`i' zz`j', cov
 65.           mat v99[`i'+1,`j'+1] = r(cov_12)
 66.           mat v99[`j'+1,`i'+1] = r(cov_12)
 67.          }
 68.     }
 69.         
.     do "`root'/do_files/EUctax_IRF_AERPP_out_r1.do"
 70. *
.  restore
 71.  } // smple loop
 72. } // y loop
(0 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         32        2.94        2.94
       1986 |         32        2.94        5.88
       1987 |         32        2.94        8.82
       1988 |         32        2.94       11.76
       1989 |         32        2.94       14.71
       1990 |         32        2.94       17.65
       1991 |         32        2.94       20.59
       1992 |         32        2.94       23.53
       1993 |         32        2.94       26.47
       1994 |         32        2.94       29.41
       1995 |         32        2.94       32.35
       1996 |         32        2.94       35.29
       1997 |         32        2.94       38.24
       1998 |         32        2.94       41.18
       1999 |         32        2.94       44.12
       2000 |         32        2.94       47.06
       2001 |         32        2.94       50.00
       2002 |         32        2.94       52.94
       2003 |         32        2.94       55.88
       2004 |         32        2.94       58.82
       2005 |         32        2.94       61.76
       2006 |         32        2.94       64.71
       2007 |         32        2.94       67.65
       2008 |         32        2.94       70.59
       2009 |         32        2.94       73.53
       2010 |         32        2.94       76.47
       2011 |         32        2.94       79.41
       2012 |         32        2.94       82.35
       2013 |         32        2.94       85.29
       2014 |         32        2.94       88.24
       2015 |         32        2.94       91.18
       2016 |         32        2.94       94.12
       2017 |         32        2.94       97.06
       2018 |         32        2.94      100.00
------------+-----------------------------------
      Total |      1,088      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        AUT |         34        3.13        3.13
        BEL |         34        3.13        6.25
        BGR |         34        3.13        9.38
        CHE |         34        3.13       12.50
        CYP |         34        3.13       15.63
        CZE |         34        3.13       18.75
        DEU |         34        3.13       21.88
        DNK |         34        3.13       25.00
        ESP |         34        3.13       28.13
        EST |         34        3.13       31.25
        FIN |         34        3.13       34.38
        FRA |         34        3.13       37.50
        GBR |         34        3.13       40.63
        GRC |         34        3.13       43.75
        HRV |         34        3.13       46.88
        HUN |         34        3.13       50.00
        IRL |         34        3.13       53.13
        ISL |         34        3.13       56.25
        ITA |         34        3.13       59.38
        LIE |         34        3.13       62.50
        LTU |         34        3.13       65.63
        LUX |         34        3.13       68.75
        LVA |         34        3.13       71.88
        MLT |         34        3.13       75.00
        NLD |         34        3.13       78.13
        NOR |         34        3.13       81.25
        POL |         34        3.13       84.38
        PRT |         34        3.13       87.50
        ROU |         34        3.13       90.63
        SVK |         34        3.13       93.75
        SVN |         34        3.13       96.88
        SWE |         34        3.13      100.00
------------+-----------------------------------
      Total |      1,088      100.00

Fixed-effects (within) regression               Number of obs     =        815
Group variable: cnum                            Number of groups  =         32

R-squared:                                      Obs per group:
     Within  = 0.4527                                         min =         18
     Between = 0.0165                                         avg =       25.5
     Overall = 0.3962                                         max =         28

                                                F(31,31)          =          .
corr(u_i, Xb) = -0.0620                         Prob > F          =          .

                                   (Std. err. adjusted for 32 clusters in cnum)
-------------------------------------------------------------------------------
              |               Robust
       dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          D1. |   .0115754   .0344974     0.34   0.739    -.0587825    .0819334
          LD. |   .0330021   .0307593     1.07   0.292    -.0297319    .0957362
         L2D. |   .0442415   .0223995     1.98   0.057    -.0014425    .0899255
         L3D. |   .0320731   .0366249     0.88   0.388     -.042624    .1067701
         L4D. |   .0106998   .0240022     0.45   0.659     -.038253    .0596525
         L5D. |   .0511278   .0257184     1.99   0.056    -.0013253    .1035809
          L6. |   .0326645   .0167415     1.95   0.060    -.0014801    .0668091
              |
         year |
        1992  |  -.2761142   .6546888    -0.42   0.676    -1.611361    1.059133
        1993  |  -.8781932   .8080333    -1.09   0.285    -2.526188    .7698017
        1994  |   2.019608   .8922977     2.26   0.031     .1997552    3.839461
        1995  |   2.034186   .9678933     2.10   0.044     .0601551    4.008218
        1996  |   1.461615   .8697259     1.68   0.103    -.3122021    3.235433
        1997  |   1.962099   .9198684     2.13   0.041     .0860152    3.838183
        1998  |   2.467639   1.027996     2.40   0.023     .3710276     4.56425
        1999  |   1.800099   .7488874     2.40   0.022     .2727328    3.327465
        2000  |     2.7553   .8892391     3.10   0.004     .9416849    4.568915
        2001  |   1.086853   .9378612     1.16   0.255    -.8259276    2.999634
        2002  |   .9780385   .9598905     1.02   0.316     -.979671    2.935748
        2003  |   1.057523   1.024078     1.03   0.310    -1.031098    3.146143
        2004  |   2.417346   1.017293     2.38   0.024     .3425629    4.492128
        2005  |    2.26916   1.041416     2.18   0.037     .1451779    4.393142
        2006  |   3.252439   .9916781     3.28   0.003     1.229898     5.27498
        2007  |   3.075986   1.029065     2.99   0.005     .9771932    5.174779
        2008  |  -.6103806   1.149454    -0.53   0.599    -2.954707    1.733946
        2009  |  -7.300179   1.146753    -6.37   0.000    -9.638997   -4.961361
        2010  |  -.5102045   .9747857    -0.52   0.604    -2.498293    1.477884
        2011  |  -.1947012   1.061373    -0.18   0.856    -2.359386    1.969983
        2012  |  -1.849335   1.002142    -1.85   0.075    -3.893218     .194548
        2013  |  -.8220173   .9314608    -0.88   0.384    -2.721744    1.077709
        2014  |    .534178   .8312887     0.64   0.525    -1.161247    2.229603
        2015  |   1.144646   .8905897     1.29   0.208    -.6717236    2.961016
        2016  |   1.040018   .9455955     1.10   0.280    -.8885364    2.968573
        2017  |     1.4836   .9148916     1.62   0.115    -.3823341    3.349533
        2018  |   1.290361   .8781944     1.47   0.152    -.5007284     3.08145
              |
        _cons |   1.539005   .8092205     1.90   0.067    -.1114108    3.189421
--------------+----------------------------------------------------------------
      sigma_u |  1.0854285
      sigma_e |  2.3827021
          rho |  .17185734   (fraction of variance due to u_i)
-------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20 SD 02/19/22
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs
>  for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  putexcel set $fxlsout, modify sheet("Table 2")
.  qui putexcel A1 = "Table 2 - Estimated Growth Impacts"
.  qui putexcel A3 = "y"
.  qui putexcel B3 = "Method"
.  qui putexcel C3 = "Sample"
.  qui putexcel D2 = "Impact in year"
.  qui putexcel D3   = "0"
.  qui putexcel E3   = "1-2"
.  qui putexcel F3   = "3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .13890522
r2  .46346163
r3  .37560259

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .41396884
r2  .27118578
r3  .30642114

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`est'"

.  qui putexcel C`rn'   = "`smple'"

.  qui putexcel D`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel D`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        933
                                                F(67, 865)        =      17.73
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6038
                                                Root MSE          =     2.1102

-------------------------------------------------------------------------------
              |               Robust
       dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0212802   .0305422     0.70   0.486    -.0386652    .0812256
          L1. |   .0041081   .0488668     0.08   0.933    -.0918032    .1000195
          L2. |   .0035665   .0318545     0.11   0.911    -.0589546    .0660876
              |
       dlrgdp |
          L1. |   .5101627   .0603393     8.45   0.000     .3917343    .6285912
          L2. |  -.1144206   .0508241    -2.25   0.025    -.2141736   -.0146675
              |
         year |
        1988  |   .7589627   .7231813     1.05   0.294    -.6604327    2.178358
        1989  |  -.5128145   .6973635    -0.74   0.462    -1.881537    .8559081
        1990  |  -1.179275   .6681132    -1.77   0.078    -2.490587    .1320377
        1991  |  -2.026782   .7820128    -2.59   0.010    -3.561647   -.4919177
        1992  |  -1.737039   .7289879    -2.38   0.017    -3.167831   -.3062467
        1993  |   -2.08161   .6362526    -3.27   0.001     -3.33039   -.8328309
        1994  |   .6269076   .5572136     1.13   0.261    -.4667412    1.720556
        1995  |  -.6349115   .5939304    -1.07   0.285    -1.800625    .5308018
        1996  |  -1.075922   .5675262    -1.90   0.058    -2.189811    .0379678
        1997  |   -.006778   .6705216    -0.01   0.992    -1.322818    1.309262
        1998  |  -.3048434   .5931685    -0.51   0.607    -1.469061    .8593744
        1999  |  -1.369766   .7613777    -1.80   0.072     -2.86413    .1245982
        2000  |   .8062925   .6292261     1.28   0.200    -.4286961    2.041281
        2001  |  -1.826886   .5664324    -3.23   0.001    -2.938628   -.7151429
        2002  |  -.8976312   .5607057    -1.60   0.110    -1.998134    .2028716
        2003  |  -.9580536   .5964438    -1.61   0.109      -2.1287    .2125928
        2004  |   .3547883   .5845761     0.61   0.544    -.7925652    1.502142
        2005  |  -.4804535   .5779437    -0.83   0.406    -1.614789    .6538825
        2006  |   .7258513   .5679927     1.28   0.202    -.3889538    1.840656
        2007  |    .034159   .6337825     0.05   0.957    -1.209772    1.278091
        2008  |   -3.45196   .7556905    -4.57   0.000    -4.935162   -1.968759
        2009  |  -8.272134   .8118671   -10.19   0.000    -9.865594   -6.678675
        2010  |   1.556401   .8171485     1.90   0.057    -.0474247    3.160227
        2011  |  -2.426436   .7248686    -3.35   0.001    -3.849143   -1.003729
        2012  |  -3.459178    .574126    -6.03   0.000    -4.586021   -2.332335
        2013  |   -1.54282   .6086709    -2.53   0.011    -2.737464   -.3481749
        2014  |  -.9246267   .5500188    -1.68   0.093    -2.004154    .1549009
        2015  |  -.8735647   .5621711    -1.55   0.121    -1.976944    .2298142
        2016  |  -1.133314   .5389262    -2.10   0.036     -2.19107    -.075558
        2017  |  -.5743432   .5317349    -1.08   0.280    -1.617985    .4692983
        2018  |  -1.024295   .5194058    -1.97   0.049    -2.043738   -.0048522
              |
        cdum1 |   .9600827   .4378907     2.19   0.029     .1006301    1.819535
        cdum2 |    .858793   .4516713     1.90   0.058    -.0277069    1.745293
        cdum3 |   .7239631   .8998891     0.80   0.421    -1.042258    2.490185
        cdum4 |   .6586881   .4095175     1.61   0.108    -.1450762    1.462452
        cdum5 |   1.820323   .6377292     2.85   0.004     .5686455    3.072001
        cdum6 |    1.30271   .5266242     2.47   0.014     .2690997    2.336321
        cdum7 |   .7660983   .4678486     1.64   0.102    -.1521529     1.68435
        cdum8 |    .384735   .4057983     0.95   0.343    -.4117294    1.181199
        cdum9 |   1.127324   .4422248     2.55   0.011     .2593645    1.995283
       cdum10 |   1.921593   .9591881     2.00   0.045     .0389851    3.804202
       cdum11 |   .5540918   .4135556     1.34   0.181    -.2575981    1.365782
       cdum12 |   .7429522   .4187858     1.77   0.076     -.079003    1.564907
       cdum13 |   .9872773   .4434414     2.23   0.026     .1169302    1.857624
       cdum14 |   .2960802   .6059995     0.49   0.625    -.8933212    1.485482
       cdum15 |    .902974   .5300225     1.70   0.089    -.1373065    1.943255
       cdum16 |   1.231424   .5110732     2.41   0.016     .2283354    2.234512
       cdum17 |   2.354373   .7150852     3.29   0.001     .9508677    3.757878
       cdum18 |   1.347634   .6241394     2.16   0.031     .1226293    2.572639
       cdum19 |    .300851    .420594     0.72   0.475    -.5246532    1.126355
       cdum20 |   2.053134   .6875036     2.99   0.003     .7037632    3.402504
       cdum21 |   2.126652   .9343147     2.28   0.023      .292863    3.960441
       cdum22 |   1.920394   .6197227     3.10   0.002     .7040579     3.13673
       cdum23 |   2.251071   .8299345     2.71   0.007     .6221497    3.879991
       cdum24 |   2.423647   .5558125     4.36   0.000     1.332749    3.514546
       cdum25 |   1.044914   .4398817     2.38   0.018     .1815534    1.908274
       cdum26 |   .2562492   .3238051     0.79   0.429    -.3792864    .8917849
       cdum27 |   2.248529   .5568438     4.04   0.000     1.155606    3.341452
       cdum28 |   .8356971   .4831301     1.73   0.084    -.1125473    1.783942
       cdum29 |   1.779218   .8042296     2.21   0.027     .2007483    3.357688
       cdum30 |   2.124318   .5728457     3.71   0.000      .999988    3.248648
       cdum31 |   1.396454   .4888693     2.86   0.004      .436945    2.355962
       cdum32 |          0  (omitted)
        _cons |   1.355167   .5642359     2.40   0.017     .2477353    2.462598
-------------------------------------------------------------------------------
(155 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        901
                                                F(66, 834)        =      13.03
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5002
                                                Root MSE          =     2.3824

-------------------------------------------------------------------------------
              |               Robust
     F.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0396156   .0430923     0.92   0.358    -.0449665    .1241978
          L1. |   .0118462   .0569089     0.21   0.835    -.0998553    .1235478
          L2. |  -.0091103   .0291536    -0.31   0.755    -.0663334    .0481127
              |
       dlrgdp |
          L1. |    .172026   .0584525     2.94   0.003     .0572948    .2867573
          L2. |  -.0761688   .0440985    -1.73   0.084    -.1627258    .0103882
              |
         year |
        1988  |  -.8953604   .7517045    -1.19   0.234    -2.370815    .5800946
        1989  |  -2.227558   .8501554    -2.62   0.009    -3.896253    -.558862
        1990  |  -3.326746   .8446403    -3.94   0.000    -4.984616   -1.668875
        1991  |  -3.492071   .7702978    -4.53   0.000    -5.004022   -1.980121
        1992  |   -3.97466   .6047893    -6.57   0.000    -5.161748   -2.787572
        1993  |  -1.163876   .5835413    -1.99   0.046    -2.309258   -.0184937
        1994  |  -1.044833   .6589347    -1.59   0.113    -2.338198    .2485321
        1995  |  -2.185977   .6172069    -3.54   0.000    -3.397438    -.974515
        1996  |   -1.43105   .7315585    -1.96   0.051    -2.866962    .0048618
        1997  |  -.8219745   .6725528    -1.22   0.222     -2.14207    .4981205
        1998  |  -2.296388   .7860053    -2.92   0.004    -3.839169   -.7536069
        1999  |  -.6454505   .6079756    -1.06   0.289    -1.838793    .5478916
        2000  |  -2.139654   .6402396    -3.34   0.001    -3.396324   -.8829838
        2001  |  -2.610157   .6178347    -4.22   0.000    -3.822851   -1.397464
        2002  |  -2.122647   .6691796    -3.17   0.002    -3.436121   -.8091734
        2003  |  -.8697439   .6282069    -1.38   0.167    -2.102796    .3633085
        2004  |  -1.046428   .6124265    -1.71   0.088    -2.248506    .1556505
        2005  |  -.2999037   .6270226    -0.48   0.633    -1.530631    .9308241
        2006  |   -.345171   .6857686    -0.50   0.615    -1.691206    1.000864
        2007  |  -4.204537   .8252569    -5.09   0.000    -5.824361   -2.584712
        2008  |  -10.78549   .9668548   -11.16   0.000    -12.68325    -8.88774
        2009  |  -3.377243   .7419739    -4.55   0.000    -4.833598   -1.920887
        2010  |  -2.182977   .8512025    -2.56   0.011    -3.853728   -.5122258
        2011  |  -5.557557   .7581396    -7.33   0.000    -7.045643   -4.069472
        2012  |   -4.05611   .6571126    -6.17   0.000    -5.345898   -2.766321
        2013  |  -2.398086   .6155737    -3.90   0.000    -3.606342   -1.189831
        2014  |  -2.089707   .6234337    -3.35   0.001     -3.31339   -.8660231
        2015  |   -2.34553   .5994111    -3.91   0.000    -3.522062   -1.168999
        2016  |  -1.913568   .5710459    -3.35   0.001    -3.034424   -.7927124
        2017  |  -2.055666   .5575523    -3.69   0.000    -3.150037   -.9612955
              |
        cdum1 |   1.471424   .5202072     2.83   0.005     .4503548    2.492493
        cdum2 |    1.29472   .5218238     2.48   0.013     .2704782    2.318963
        cdum3 |   .9901155    1.02905     0.96   0.336    -1.029717    3.009948
        cdum4 |   1.006898   .4991939     2.02   0.044     .0270738    1.986722
        cdum5 |   2.629733   .6912793     3.80   0.000     1.272881    3.986585
        cdum6 |   1.990858    .621257     3.20   0.001      .771447    3.210269
        cdum7 |   1.187313   .5665474     2.10   0.036     .0752868    2.299339
        cdum8 |   .6834229   .4581706     1.49   0.136    -.2158801    1.582726
        cdum9 |   1.618316   .5201325     3.11   0.002     .5973935    2.639239
       cdum10 |   3.062708   1.118745     2.74   0.006     .8668215    5.258595
       cdum11 |   .8243769   .5030738     1.64   0.102    -.1630626    1.811816
       cdum12 |   1.134332   .5014512     2.26   0.024     .1500777    2.118587
       cdum13 |   1.418192    .526127     2.70   0.007     .3855029     2.45088
       cdum14 |   .5438664   .6886646     0.79   0.430    -.8078532    1.895586
       cdum15 |   1.456753   .6303541     2.31   0.021      .219486     2.69402
       cdum16 |   1.797725   .5970247     3.01   0.003     .6258773    2.969572
       cdum17 |   3.425598   .8974312     3.82   0.000     1.664109    5.187087
       cdum18 |   1.890112   .6805008     2.78   0.006      .554417    3.225808
       cdum19 |   .4274969   .5026875     0.85   0.395    -.5591844    1.414178
       cdum20 |   2.795948   .7795674     3.59   0.000     1.265803    4.326093
       cdum21 |   3.152031    1.04391     3.02   0.003     1.103031    5.201031
       cdum22 |   2.980804   .6678816     4.46   0.000     1.669878     4.29173
       cdum23 |   3.161163   1.028486     3.07   0.002     1.142438    5.179889
       cdum24 |   3.636892    .660411     5.51   0.000     2.340629    4.933155
       cdum25 |   1.596273   .5232037     3.05   0.002     .5693219    2.623224
       cdum26 |   .4027613   .3859306     1.04   0.297    -.3547481    1.160271
       cdum27 |   3.319569   .6473371     5.13   0.000     2.048968     4.59017
       cdum28 |   1.164767   .5851883     1.99   0.047      .016152    2.313382
       cdum29 |   2.505681   .8808325     2.84   0.005     .7767723     4.23459
       cdum30 |   3.142641   .6819019     4.61   0.000     1.804195    4.481087
       cdum31 |   1.899656   .5178426     3.67   0.000      .883228    2.916084
       cdum32 |          0  (omitted)
        _cons |   2.810835   .6659079     4.22   0.000     1.503782    4.117887
-------------------------------------------------------------------------------
(187 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        869
                                                F(65, 803)        =      12.60
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4977
                                                Root MSE          =     2.3902

-------------------------------------------------------------------------------
              |               Robust
    F2.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0454165   .0345092     1.32   0.189    -.0223224    .1131555
          L1. |  -.0140986   .0506104    -0.28   0.781    -.1134429    .0852457
          L2. |   .0074641   .0307305     0.24   0.808    -.0528576    .0677857
              |
       dlrgdp |
          L1. |    .058158   .0526684     1.10   0.270    -.0452259    .1615419
          L2. |  -.1079106   .0411345    -2.62   0.009    -.1886545   -.0271668
              |
         year |
        1988  |  -1.217285   .8279271    -1.47   0.142    -2.842442    .4078716
        1989  |  -2.539608   .8718754    -2.91   0.004    -4.251032   -.8281841
        1990  |    -2.6022   .7771302    -3.35   0.001    -4.127647   -1.076754
        1991  |  -3.282464   .5919763    -5.54   0.000    -4.444468    -2.12046
        1992  |    -.45875   .5792703    -0.79   0.429    -1.595813    .6783128
        1993  |  -.5741317   .6280148    -0.91   0.361    -1.806876    .6586128
        1994  |  -1.352724   .6107775    -2.21   0.027    -2.551632   -.1538146
        1995  |  -.8206587   .7336997    -1.12   0.264    -2.260854     .619537
        1996  |  -.0742849   .6841047    -0.11   0.914    -1.417129     1.26856
        1997  |  -.7882441   .7780138    -1.01   0.311    -2.315425    .7389368
        1998  |    .166331   .6031946     0.28   0.783    -1.017693    1.350355
        1999  |  -1.424361   .6083342    -2.34   0.019    -2.618474   -.2302485
        2000  |  -1.471312   .6329202    -2.32   0.020    -2.713685   -.2289385
        2001  |  -1.608428   .6633666    -2.42   0.016    -2.910565   -.3062906
        2002  |   .0259474   .6262381     0.04   0.967    -1.203309    1.255204
        2003  |   -.300718    .622323    -0.48   0.629     -1.52229    .9208539
        2004  |   .6488419   .6309357     1.03   0.304    -.5896361     1.88732
        2005  |   .4023634   .6977943     0.58   0.564    -.9673529     1.77208
        2006  |  -3.124781   .8358259    -3.74   0.000    -4.765442   -1.484119
        2007  |  -9.869079   .9553048   -10.33   0.000    -11.74427   -7.993889
        2008  |  -2.987496   .7440909    -4.01   0.000    -4.448089   -1.526903
        2009  |   -2.44389   .7376615    -3.31   0.001    -3.891862   -.9959172
        2010  |  -4.122797   .7861798    -5.24   0.000    -5.666007   -2.579587
        2011  |  -4.231087   .7369595    -5.74   0.000    -5.677681   -2.784492
        2012  |  -2.163181   .6076013    -3.56   0.000    -3.355855   -.9705069
        2013  |   -1.40334   .6206636    -2.26   0.024    -2.621654   -.1850252
        2014  |  -1.747307   .5942698    -2.94   0.003    -2.913813   -.5808013
        2015  |  -1.273978   .5727124    -2.22   0.026    -2.398169   -.1497883
        2016  |  -1.376359   .5576465    -2.47   0.014    -2.470976   -.2817423
              |
        cdum1 |   1.283114   .5045501     2.54   0.011     .2927216    2.273507
        cdum2 |   1.035533   .5093699     2.03   0.042     .0356791    2.035387
        cdum3 |   .4876932   1.046259     0.47   0.641    -1.566031    2.541418
        cdum4 |    .810391   .4955291     1.64   0.102    -.1622944    1.783076
        cdum5 |   2.527305   .6822008     3.70   0.000     1.188197    3.866412
        cdum6 |   1.840027   .6128551     3.00   0.003       .63704    3.043014
        cdum7 |   .9361218   .5671536     1.65   0.099    -.1771568      2.0494
        cdum8 |    .552091   .4378953     1.26   0.208    -.3074635    1.411646
        cdum9 |   1.422363   .5065989     2.81   0.005     .4279491    2.416778
       cdum10 |   3.427733    1.06817     3.21   0.001     1.330998    5.524468
       cdum11 |   .6117218   .4965757     1.23   0.218    -.3630178    1.586461
       cdum12 |   .8751842   .4942183     1.77   0.077    -.0949282    1.845297
       cdum13 |   1.190617   .5123049     2.32   0.020     .1850021    2.196232
       cdum14 |   .1219682   .6961765     0.18   0.861    -1.244572    1.488509
       cdum15 |   1.433188    .601981     2.38   0.018     .2515456     2.61483
       cdum16 |   1.674398   .5830369     2.87   0.004     .5299418    2.818854
       cdum17 |   3.567672   .8899545     4.01   0.000      1.82076    5.314584
       cdum18 |   1.949698   .6514904     2.99   0.003     .6708723    3.228523
       cdum19 |   .0285688   .4938396     0.06   0.954    -.9408002    .9979378
       cdum20 |   2.802113   .7691128     3.64   0.000     1.292404    4.311822
       cdum21 |   3.556057   1.008198     3.53   0.000     1.577042    5.535073
       cdum22 |   2.980585   .6432286     4.63   0.000     1.717977    4.243193
       cdum23 |   3.170644   1.054468     3.01   0.003     1.100805    5.240482
       cdum24 |   3.673874   .6569396     5.59   0.000     2.384353    4.963396
       cdum25 |   1.429941   .5055455     2.83   0.005     .4375946    2.422288
       cdum26 |   .4844057   .3888729     1.25   0.213    -.2789217    1.247733
       cdum27 |   3.390251   .6420474     5.28   0.000     2.129961     4.65054
       cdum28 |   .8258936    .578459     1.43   0.154    -.3095768    1.961364
       cdum29 |   2.357561   .9167603     2.57   0.010     .5580318    4.157091
       cdum30 |   3.106121   .6823391     4.55   0.000     1.766742      4.4455
       cdum31 |   1.697226   .4974382     3.41   0.001     .7207932    2.673659
       cdum32 |          0  (omitted)
        _cons |   2.611574   .6525347     4.00   0.000     1.330699     3.89245
-------------------------------------------------------------------------------
(219 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        837
                                                F(64, 772)        =      12.35
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4957
                                                Root MSE          =     2.3971

-------------------------------------------------------------------------------
              |               Robust
    F3.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |    .035561   .0306051     1.16   0.246    -.0245181    .0956401
          L1. |  -.0207745   .0430995    -0.48   0.630    -.1053805    .0638315
          L2. |    .016305   .0287331     0.57   0.571    -.0400993    .0727094
              |
       dlrgdp |
          L1. |  -.0832693   .0463022    -1.80   0.073    -.1741624    .0076238
          L2. |   .0064603   .0398824     0.16   0.871    -.0718305    .0847511
              |
         year |
        1988  |  -1.276716   .9770905    -1.31   0.192    -3.194786    .6413528
        1989  |  -1.412691   .9018253    -1.57   0.118    -3.183012    .3576295
        1990  |  -2.043381   .7243401    -2.82   0.005    -3.465291   -.6214712
        1991  |   .6629867    .713864     0.93   0.353     -.738358    2.064331
        1992  |   .5370759   .7837327     0.69   0.493    -1.001424    2.075576
        1993  |  -.0478603   .7439973    -0.06   0.949    -1.508358    1.412637
        1994  |   .4594124   .8391796     0.55   0.584    -1.187932    2.106757
        1995  |   1.196692   .8130032     1.47   0.141     -.399267    2.792651
        1996  |   .4970145   .9029843     0.55   0.582    -1.275581     2.26961
        1997  |   1.381932   .7353454     1.88   0.061    -.0615814    2.825446
        1998  |   -.178294   .7451263    -0.24   0.811    -1.641008     1.28442
        1999  |  -.3070585   .7596182    -0.40   0.686    -1.798221    1.184104
        2000  |   -.323618   .7857189    -0.41   0.681    -1.866017    1.218781
        2001  |    1.19015   .7664627     1.55   0.121    -.3144483    2.694748
        2002  |   .8897192   .7549299     1.18   0.239    -.5922397    2.371678
        2003  |     1.8638   .7644433     2.44   0.015     .3631662    3.364434
        2004  |   1.685396   .8178783     2.06   0.040     .0798667    3.290925
        2005  |  -1.880826   .9418705    -2.00   0.046    -3.729756   -.0318947
        2006  |  -8.579645   1.047959    -8.19   0.000    -10.63683   -6.522457
        2007  |  -1.708423   .8646587    -1.98   0.049    -3.405784   -.0110616
        2008  |   -1.39776   .8736081    -1.60   0.110    -3.112689    .3171689
        2009  |  -3.354724   .8008593    -4.19   0.000    -4.926844   -1.782604
        2010  |  -2.874074   .8543625    -3.36   0.001    -4.551223   -1.196925
        2011  |  -.9149622   .8086967    -1.13   0.258    -2.502467    .6725431
        2012  |  -.3082877   .7490551    -0.41   0.681    -1.778714    1.162139
        2013  |  -.5343996   .7334134    -0.73   0.466    -1.974121    .9053214
        2014  |  -.0070383   .7240732    -0.01   0.992    -1.428424    1.414348
        2015  |  -.1043986   .7138459    -0.15   0.884    -1.505708    1.296911
              |
        cdum1 |   .9320808    .514351     1.81   0.070    -.0776116    1.941773
        cdum2 |    .691413    .520152     1.33   0.184    -.3296669    1.712493
        cdum3 |   .3460532   1.041983     0.33   0.740    -1.699402    2.391508
        cdum4 |   .4774349   .5145635     0.93   0.354    -.5326747    1.487544
        cdum5 |   2.116915   .6953353     3.04   0.002     .7519429    3.481887
        cdum6 |   1.474086   .6272142     2.35   0.019     .2428386    2.705334
        cdum7 |   .5669363   .5821626     0.97   0.330    -.5758731    1.709746
        cdum8 |   .3392391   .4410075     0.77   0.442     -.526477    1.204955
        cdum9 |   1.059471   .5164109     2.05   0.041     .0457345    2.073207
       cdum10 |   2.906183   1.075578     2.70   0.007     .7947796    5.017586
       cdum11 |   .2999283   .5049922     0.59   0.553    -.6913925    1.291249
       cdum12 |   .5100357   .5059636     1.01   0.314    -.4831918    1.503263
       cdum13 |   .8940013   .5211982     1.72   0.087    -.1291324    1.917135
       cdum14 |  -.2994138   .7209124    -0.42   0.678    -1.714595    1.115767
       cdum15 |   1.088676   .6188529     1.76   0.079    -.1261583     2.30351
       cdum16 |   1.484623   .5745615     2.58   0.010     .3567347    2.612511
       cdum17 |   3.334972   .9124253     3.66   0.000     1.543843    5.126101
       cdum18 |   1.778594   .6507947     2.73   0.006     .5010567    3.056131
       cdum19 |  -.3780853   .5017102    -0.75   0.451    -1.362963    .6067927
       cdum20 |   2.534513   .7934317     3.19   0.001     .9769734    4.092052
       cdum21 |    3.39746   1.016864     3.34   0.001     1.401315    5.393606
       cdum22 |   2.559002   .6437824     3.97   0.000      1.29523    3.822774
       cdum23 |    3.03789   1.071921     2.83   0.005     .9336649    5.142116
       cdum24 |   3.339402   .6666603     5.01   0.000      2.03072    4.648084
       cdum25 |   1.071749   .5140624     2.08   0.037     .0626235    2.080875
       cdum26 |   .5416195   .3920927     1.38   0.168    -.2280748    1.311314
       cdum27 |   3.082371   .6595196     4.67   0.000     1.787706    4.377035
       cdum28 |   .3776863    .583341     0.65   0.518    -.7674364    1.522809
       cdum29 |   2.019737   .9343387     2.16   0.031     .1855914    3.853883
       cdum30 |   2.769996   .7007044     3.95   0.000     1.394484    4.145508
       cdum31 |   1.450758   .5119819     2.83   0.005     .4457164      2.4558
       cdum32 |          0  (omitted)
        _cons |   1.802994   .7002956     2.57   0.010     .4282847    3.177704
-------------------------------------------------------------------------------
(251 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        805
                                                F(63, 741)        =      12.58
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5002
                                                Root MSE          =     2.3914

-------------------------------------------------------------------------------
              |               Robust
    F4.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0013828   .0299766     0.05   0.963    -.0574663     .060232
          L1. |   .0441674   .0421948     1.05   0.296    -.0386681    .1270029
          L2. |  -.0278064   .0280712    -0.99   0.322     -.082915    .0273022
              |
       dlrgdp |
          L1. |  -.0101964   .0404104    -0.25   0.801     -.089529    .0691361
          L2. |  -.0318876   .0487374    -0.65   0.513    -.1275674    .0637921
              |
         year |
        1988  |  -.2083193   .9881424    -0.21   0.833    -2.148211    1.731573
        1989  |  -.7384599   .8205704    -0.90   0.368     -2.34938    .8724597
        1990  |    2.16835   .7949494     2.73   0.007     .6077291    3.728972
        1991  |   2.084079    .874846     2.38   0.017     .3666073    3.801551
        1992  |   1.313097   .8381406     1.57   0.118    -.3323162     2.95851
        1993  |   1.872796   .9125479     2.05   0.040     .0813086    3.664283
        1994  |   2.456128   .8904969     2.76   0.006     .7079305    4.204325
        1995  |   1.772131   .9948502     1.78   0.075    -.1809296    3.725192
        1996  |   2.830653   .8279613     3.42   0.001     1.205223    4.456082
        1997  |   .9583915   .8300334     1.15   0.249    -.6711056    2.587889
        1998  |   1.027405   .8466032     1.21   0.225    -.6346212    2.689432
        1999  |   1.142641   .8865894     1.29   0.198    -.5978851    2.883167
        2000  |    2.49916    .840845     2.97   0.003     .8484374    4.149882
        2001  |   2.337095   .8345399     2.80   0.005     .6987508    3.975439
        2002  |   3.348661   .8402439     3.99   0.000     1.699118    4.998203
        2003  |   3.105143   .8898168     3.49   0.001     1.358281    4.852005
        2004  |  -.5873747   1.001887    -0.59   0.558    -2.554249      1.3795
        2005  |  -7.250675    1.12496    -6.45   0.000    -9.459164   -5.042186
        2006  |  -.3992545   .9408199    -0.42   0.671    -2.246244    1.447735
        2007  |  -.0663208   .9413908    -0.07   0.944    -1.914431     1.78179
        2008  |    -1.6838   .8826254    -1.91   0.057    -3.416544    .0489439
        2009  |  -.6965361   .8683836    -0.80   0.423    -2.401321    1.008249
        2010  |   .4644174   .8647663     0.54   0.591    -1.233266    2.162101
        2011  |   .9296562   .9347777     0.99   0.320    -.9054718    2.764784
        2012  |    1.06308   .8187065     1.30   0.195    -.5441806     2.67034
        2013  |   1.509826   .8063292     1.87   0.062    -.0731357    3.092788
        2014  |    1.27306   .8104507     1.57   0.117    -.3179928    2.864113
              |
        cdum1 |   .3949295   .5248901     0.75   0.452    -.6355193    1.425378
        cdum2 |   .1889402    .532661     0.35   0.723    -.8567641    1.234645
        cdum3 |   .2978274   .9627727     0.31   0.757     -1.59226    2.187914
        cdum4 |  -.0031479   .5240362    -0.01   0.995     -1.03192    1.025625
        cdum5 |   1.482026   .7209291     2.06   0.040     .0667197    2.897333
        cdum6 |   .9028665   .6441794     1.40   0.161    -.3617676    2.167501
        cdum7 |  -.0069023   .5832979    -0.01   0.991    -1.152016    1.138211
        cdum8 |  -.0064772   .4570149    -0.01   0.989    -.9036753     .890721
        cdum9 |   .5397501   .5331294     1.01   0.312    -.5068739    1.586374
       cdum10 |   2.209146   1.146579     1.93   0.054    -.0417834    4.460076
       cdum11 |   .0000625   .5176339     0.00   1.000    -1.016141    1.016266
       cdum12 |   .0222261   .5210761     0.04   0.966    -1.000735    1.045187
       cdum13 |   .4789688   .5345809     0.90   0.371    -.5705046    1.528442
       cdum14 |  -.6850624   .7430586    -0.92   0.357    -2.143813    .7736884
       cdum15 |   .5415922   .6436966     0.84   0.400    -.7220941    1.805278
       cdum16 |   .9921865   .5866473     1.69   0.091    -.1595023    2.143875
       cdum17 |   2.688638   .9214024     2.92   0.004     .8797677    4.497508
       cdum18 |   1.368353   .6525904     2.10   0.036     .0872072      2.6495
       cdum19 |  -.8407508   .5128185    -1.64   0.102    -1.847501    .1659993
       cdum20 |   2.125181   .8362415     2.54   0.011     .4834959    3.766865
       cdum21 |   2.704316   1.067833     2.53   0.012     .6079768    4.800655
       cdum22 |   1.961641   .6674346     2.94   0.003     .6513526    3.271928
       cdum23 |   2.496842    1.15416     2.16   0.031     .2310287    4.762656
       cdum24 |    2.73205   .6829401     4.00   0.000     1.391323    4.072778
       cdum25 |   .5388703   .5270152     1.02   0.307    -.4957505    1.573491
       cdum26 |   .5111147   .3956032     1.29   0.197    -.2655218    1.287751
       cdum27 |   2.444163   .6732884     3.63   0.000     1.122383    3.765943
       cdum28 |  -.1574052   .5981912    -0.26   0.793    -1.331757    1.016946
       cdum29 |   1.474602   1.013781     1.45   0.146    -.5156233    3.464828
       cdum30 |   2.278033   .7329924     3.11   0.002     .8390443    3.717023
       cdum31 |   .9910317   .5250626     1.89   0.059    -.0397559    2.021819
       cdum32 |          0  (omitted)
        _cons |   .8058601    .813849     0.99   0.322    -.7918643    2.403585
-------------------------------------------------------------------------------
(283 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        773
                                                F(62, 710)        =      12.97
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5281
                                                Root MSE          =     2.3092

-------------------------------------------------------------------------------
              |               Robust
    F5.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0320771   .0271228     1.18   0.237    -.0211735    .0853277
          L1. |  -.0090172   .0407646    -0.22   0.825    -.0890508    .0710163
          L2. |  -.0095893   .0248602    -0.39   0.700    -.0583975    .0392189
              |
       dlrgdp |
          L1. |  -.0693058   .0440697    -1.57   0.116    -.1558283    .0172167
          L2. |  -.0000502     .04565    -0.00   0.999    -.0896752    .0895749
              |
         year |
        1988  |  -.5231787   .7180672    -0.73   0.466    -1.932968    .8866104
        1989  |   2.428883   .6913918     3.51   0.000     1.071466      3.7863
        1990  |   2.329797   .7737164     3.01   0.003     .8107512    3.848843
        1991  |   1.556431    .747976     2.08   0.038     .0879221    3.024941
        1992  |   2.597149   .7955691     3.26   0.001     1.035199    4.159098
        1993  |   2.578395   .7952716     3.24   0.001     1.017029     4.13976
        1994  |   2.057087    .896177     2.30   0.022     .2976134    3.816561
        1995  |   3.028354   .7435199     4.07   0.000     1.568593    4.488115
        1996  |   1.104185   .7300927     1.51   0.131    -.3292144    2.537584
        1997  |   .9489287   .7378183     1.29   0.199     -.499638    2.397495
        1998  |   1.375391   .7980768     1.72   0.085    -.1914814    2.942264
        1999  |   2.744139   .7437471     3.69   0.000     1.283932    4.204346
        2000  |   2.519073   .7187106     3.50   0.000      1.10802    3.930125
        2001  |   3.606668   .7438887     4.85   0.000     2.146183    5.067152
        2002  |   3.304167   .7960864     4.15   0.000     1.741202    4.867132
        2003  |  -.3940367   .9120006    -0.43   0.666    -2.184577    1.396504
        2004  |  -7.068192   1.041167    -6.79   0.000    -9.112326   -5.024059
        2005  |  -.1636754   .8553366    -0.19   0.848    -1.842967    1.515616
        2006  |   .1552637   .8532239     0.18   0.856     -1.51988    1.830407
        2007  |  -1.428544   .7856407    -1.82   0.069    -2.971001    .1139128
        2008  |  -.3993282   .7807097    -0.51   0.609    -1.932104    1.133448
        2009  |   .6865961   .7322746     0.94   0.349    -.7510865    2.124279
        2010  |   .8336656   .7985479     1.04   0.297     -.734132    2.401463
        2011  |   1.219747    .811001     1.50   0.133    -.3724998    2.811994
        2012  |   1.694586   .7032523     2.41   0.016     .3138832    3.075289
        2013  |   1.386871   .6975574     1.99   0.047      .017349    2.756393
              |
        cdum1 |   .1069941   .4835447     0.22   0.825    -.8423545    1.056343
        cdum2 |  -.0517137   .4985402    -0.10   0.917    -1.030503    .9270758
        cdum3 |   .4410722   .8788715     0.50   0.616    -1.284426     2.16657
        cdum4 |  -.1522809   .5022919    -0.30   0.762    -1.138436    .8338742
        cdum5 |   1.380968   .7327929     1.88   0.060    -.0577323    2.819668
        cdum6 |   .9513124   .5817889     1.64   0.102    -.1909202    2.093545
        cdum7 |  -.3795861   .5221085    -0.73   0.467    -1.404647    .6454752
        cdum8 |  -.2247305   .4298917    -0.52   0.601    -1.068741    .6192805
        cdum9 |   .2984012   .5025503     0.59   0.553    -.6882613    1.285064
       cdum10 |   1.950501   1.184259     1.65   0.100    -.3745671    4.275569
       cdum11 |   .0783881   .4642167     0.17   0.866    -.8330136    .9897898
       cdum12 |  -.1989596   .4910469    -0.41   0.685    -1.163037    .7651181
       cdum13 |   .3596929   .4960634     0.73   0.469    -.6142337     1.33362
       cdum14 |  -1.028708   .7257546    -1.42   0.157     -2.45359    .3961735
       cdum15 |   .1677744   .5976371     0.28   0.779    -1.005573    1.341122
       cdum16 |   .8174197    .564812     1.45   0.148    -.2914819    1.926321
       cdum17 |   2.582578   .9316559     2.77   0.006     .7534482    4.411708
       cdum18 |   1.261054    .639923     1.97   0.049     .0046863    2.517422
       cdum19 |  -1.132506   .4744748    -2.39   0.017    -2.064047   -.2009643
       cdum20 |    2.01174   .8394941     2.40   0.017     .3635521    3.659928
       cdum21 |   2.438484   1.074537     2.27   0.024     .3288337    4.548134
       cdum22 |   1.602463   .6022665     2.66   0.008     .4200264    2.784899
       cdum23 |   2.266331   1.200545     1.89   0.059    -.0907119    4.623374
       cdum24 |   2.476235   .6580958     3.76   0.000     1.184188    3.768281
       cdum25 |   .2959787   .4898052     0.60   0.546    -.6656613    1.257619
       cdum26 |   .4271456   .3886178     1.10   0.272    -.3358319    1.190123
       cdum27 |   2.281888   .6590112     3.46   0.001     .9880442    3.575732
       cdum28 |  -.5007727   .5490482    -0.91   0.362    -1.578725    .5771796
       cdum29 |   1.755127    .895106     1.96   0.050    -.0022445    3.512498
       cdum30 |   2.426082   .6724057     3.61   0.000     1.105941    3.746224
       cdum31 |   .8000139   .5103107     1.57   0.117    -.2018847    1.801912
       cdum32 |          0  (omitted)
        _cons |   .8606834   .7066681     1.22   0.224    -.5267257    2.248092
-------------------------------------------------------------------------------
(315 missing values generated)
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        741
                                                F(61, 679)        =      14.03
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5569
                                                Root MSE          =     2.2309

-------------------------------------------------------------------------------
              |               Robust
    F6.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0173003   .0280832     0.62   0.538    -.0378401    .0724407
          L1. |   -.048234   .0306182    -1.58   0.116    -.1083518    .0118838
          L2. |   .0425528    .017681     2.41   0.016     .0078367    .0772688
              |
       dlrgdp |
          L1. |  -.0534768   .0425862    -1.26   0.210    -.1370934    .0301397
          L2. |  -.0509991   .0428841    -1.19   0.235    -.1352005    .0332024
              |
         year |
        1988  |   2.911331   .3968237     7.34   0.000     2.132181     3.69048
        1989  |   2.946031   .5348214     5.51   0.000     1.895928    3.996133
        1990  |   2.336597   .4570599     5.11   0.000     1.439176    3.234017
        1991  |   3.330286   .5778396     5.76   0.000     2.195718    4.464853
        1992  |   3.952903   .4737111     8.34   0.000     3.022789    4.883018
        1993  |   2.483113   .7107375     3.49   0.001     1.087606     3.87862
        1994  |   3.441674   .4591324     7.50   0.000     2.540184    4.343164
        1995  |   1.508269   .4543358     3.32   0.001     .6161971    2.400341
        1996  |   1.433975   .4539606     3.16   0.002     .5426395     2.32531
        1997  |   1.440248   .5052262     2.85   0.004      .448255    2.432242
        1998  |   3.295541   .4600755     7.16   0.000     2.392199    4.198882
        1999  |   3.194899   .4555838     7.01   0.000     2.300377    4.089421
        2000  |   4.108163   .4558177     9.01   0.000     3.213182    5.003145
        2001  |   3.948894    .526494     7.50   0.000     2.915142    4.982646
        2002  |   .2492245   .6737345     0.37   0.712    -1.073629    1.572078
        2003  |  -6.511401   .8537666    -7.63   0.000    -8.187741   -4.835061
        2004  |   .3038131   .6267154     0.48   0.628    -.9267198    1.534346
        2005  |   .7100635   .6281392     1.13   0.259    -.5232651    1.943392
        2006  |  -.8958925   .5304602    -1.69   0.092    -1.937432     .145647
        2007  |   .1834316   .5164066     0.36   0.723    -.8305141    1.197377
        2008  |   1.570029   .4445066     3.53   0.000     .6972563    2.442802
        2009  |   2.012346   .4605266     4.37   0.000     1.108119    2.916574
        2010  |   1.360053   .5407555     2.52   0.012     .2982987    2.421806
        2011  |   1.841988   .5373508     3.43   0.001     .7869193    2.897057
        2012  |   2.010161   .3741097     5.37   0.000     1.275611    2.744712
              |
        cdum1 |  -.2310089   .4422058    -0.52   0.602    -1.099264    .6372462
        cdum2 |  -.3776819   .4654029    -0.81   0.417    -1.291484    .5361199
        cdum3 |   .4682102   .8224037     0.57   0.569     -1.14655     2.08297
        cdum4 |  -.3996177   .4758369    -0.84   0.401    -1.333906    .5346709
        cdum5 |   .9154753    .649205     1.41   0.159    -.3592153    2.190166
        cdum6 |   .9226275   .4994248     1.85   0.065     -.057975     1.90323
        cdum7 |  -.7451763   .4810695    -1.55   0.122    -1.689739    .1993863
        cdum8 |  -.5432565   .4000933    -1.36   0.175    -1.328825    .2423122
        cdum9 |   .0446394   .4725035     0.09   0.925    -.8831041    .9723829
       cdum10 |   1.501576    1.20298     1.25   0.212    -.8604323    3.863584
       cdum11 |   .0394481   .4223237     0.09   0.926    -.7897692    .8686655
       cdum12 |  -.5384205   .4518817    -1.19   0.234    -1.425674    .3488329
       cdum13 |   .1034526   .4641541     0.22   0.824    -.8078972    1.014802
       cdum14 |  -1.338991    .705928    -1.90   0.058    -2.725055    .0470732
       cdum15 |  -.2947393   .5189905    -0.57   0.570    -1.313758    .7242798
       cdum16 |   .5915093   .5437545     1.09   0.277    -.4761329    1.659152
       cdum17 |    2.40227    .926648     2.59   0.010     .5828304     4.22171
       cdum18 |   1.209128   .5850171     2.07   0.039      .060468    2.357788
       cdum19 |  -1.487485   .4336387    -3.43   0.001    -2.338919   -.6360511
       cdum20 |   1.790363   .8338407     2.15   0.032     .1531468    3.427579
       cdum21 |    1.84202    1.06056     1.74   0.083    -.2403513    3.924391
       cdum22 |   1.410144   .5892796     2.39   0.017     .2531144    2.567173
       cdum23 |   1.859733   1.236222     1.50   0.133    -.5675434     4.28701
       cdum24 |   2.190561   .6380854     3.43   0.001      .937703    3.443418
       cdum25 |  -.0055513   .4501505    -0.01   0.990    -.8894056     .878303
       cdum26 |   .2281251    .374885     0.61   0.543    -.5079481    .9641983
       cdum27 |   2.138934   .6420795     3.33   0.001     .8782346    3.399634
       cdum28 |  -.7977819   .5211622    -1.53   0.126    -1.821065    .2255012
       cdum29 |   1.828295   .8297867     2.20   0.028     .1990385    3.457551
       cdum30 |   2.525311   .5904468     4.28   0.000      1.36599    3.684632
       cdum31 |   .6432058    .487782     1.32   0.188    -.3145365    1.600948
       cdum32 |          0  (omitted)
        _cons |   .6565489   .5220772     1.26   0.209    -.3685308    1.681629
-------------------------------------------------------------------------------
(347 missing values generated)
0   .02128021   .03054089
1   .03961565   .04309045
2   .04541651   .03450763
3   .03556098   .03060358
4   .00138282   .029975
5   .03207709   .02712132
6   .0173003   .02808151

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20 SD 02/19/22
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs
>  for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  putexcel set $fxlsout, modify sheet("Table 2")
.  qui putexcel A1 = "Table 2 - Estimated Growth Impacts"
.  qui putexcel A3 = "y"
.  qui putexcel B3 = "Method"
.  qui putexcel C3 = "Sample"
.  qui putexcel D2 = "Impact in year"
.  qui putexcel D3   = "0"
.  qui putexcel E3   = "1-2"
.  qui putexcel F3   = "3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  .25536256
r2  .49237514
r3  .36026922

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .36649067
r2  .41596946
r3  .26473218

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`est'"

.  qui putexcel C`rn'   = "`smple'"

.  qui putexcel D`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel D`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(714 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         11        2.94        2.94
       1986 |         11        2.94        5.88
       1987 |         11        2.94        8.82
       1988 |         11        2.94       11.76
       1989 |         11        2.94       14.71
       1990 |         11        2.94       17.65
       1991 |         11        2.94       20.59
       1992 |         11        2.94       23.53
       1993 |         11        2.94       26.47
       1994 |         11        2.94       29.41
       1995 |         11        2.94       32.35
       1996 |         11        2.94       35.29
       1997 |         11        2.94       38.24
       1998 |         11        2.94       41.18
       1999 |         11        2.94       44.12
       2000 |         11        2.94       47.06
       2001 |         11        2.94       50.00
       2002 |         11        2.94       52.94
       2003 |         11        2.94       55.88
       2004 |         11        2.94       58.82
       2005 |         11        2.94       61.76
       2006 |         11        2.94       64.71
       2007 |         11        2.94       67.65
       2008 |         11        2.94       70.59
       2009 |         11        2.94       73.53
       2010 |         11        2.94       76.47
       2011 |         11        2.94       79.41
       2012 |         11        2.94       82.35
       2013 |         11        2.94       85.29
       2014 |         11        2.94       88.24
       2015 |         11        2.94       91.18
       2016 |         11        2.94       94.12
       2017 |         11        2.94       97.06
       2018 |         11        2.94      100.00
------------+-----------------------------------
      Total |        374      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        CHE |         34        9.09        9.09
        DNK |         34        9.09       18.18
        ESP |         34        9.09       27.27
        FIN |         34        9.09       36.36
        FRA |         34        9.09       45.45
        GBR |         34        9.09       54.55
        IRL |         34        9.09       63.64
        ISL |         34        9.09       72.73
        NOR |         34        9.09       81.82
        SVN |         34        9.09       90.91
        SWE |         34        9.09      100.00
------------+-----------------------------------
      Total |        374      100.00

Fixed-effects (within) regression               Number of obs     =        303
Group variable: cnum                            Number of groups  =         11

R-squared:                                      Obs per group:
     Within  = 0.5546                                         min =         23
     Between = 0.0033                                         avg =       27.5
     Overall = 0.5029                                         max =         28

                                                F(10,10)          =          .
corr(u_i, Xb) = -0.0642                         Prob > F          =          .

                                   (Std. err. adjusted for 11 clusters in cnum)
-------------------------------------------------------------------------------
              |               Robust
       dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          D1. |   .0110595   .0201676     0.55   0.595    -.0338767    .0559958
          LD. |   .0125395   .0163549     0.77   0.461    -.0239014    .0489803
         L2D. |   .0085231   .0139086     0.61   0.554    -.0224672    .0395134
         L3D. |   .0089451   .0169838     0.53   0.610    -.0288973    .0467874
         L4D. |     .00513   .0114759     0.45   0.664    -.0204398    .0306999
         L5D. |   .0138829   .0090151     1.54   0.155    -.0062041    .0339698
          L6. |   .0113421   .0083732     1.35   0.205    -.0073145    .0299987
              |
         year |
        1992  |    .303711   .6916935     0.44   0.670    -1.237478      1.8449
        1993  |   .4950215   1.098264     0.45   0.662    -1.952063    2.942106
        1994  |   3.631771   1.181456     3.07   0.012     .9993242    6.264218
        1995  |   3.205825   1.310199     2.45   0.034     .2865194    6.125132
        1996  |   3.146302   1.053118     2.99   0.014     .7998093    5.492795
        1997  |   4.450225    1.25378     3.55   0.005      1.65663     7.24382
        1998  |   4.599474   1.250412     3.68   0.004     1.813383    7.385565
        1999  |   4.084883   1.069954     3.82   0.003     1.700877    6.468889
        2000  |   4.733798   1.121735     4.22   0.002     2.234416    7.233179
        2001  |    2.52558   1.003776     2.52   0.031     .2890281    4.762132
        2002  |   1.823852   .9570485     1.91   0.086    -.3085854    3.956289
        2003  |   2.137928   .9847203     2.17   0.055    -.0561658    4.332021
        2004  |   3.846408   1.105209     3.48   0.006     1.383849    6.308966
        2005  |   3.586563   1.041515     3.44   0.006     1.265924    5.907203
        2006  |   4.143141   1.041823     3.98   0.003     1.821814    6.464468
        2007  |   3.856622   1.538275     2.51   0.031     .4291316    7.284112
        2008  |   .0194623   1.655349     0.01   0.991    -3.668885     3.70781
        2009  |  -5.543217     1.2056    -4.60   0.001    -8.229461   -2.856972
        2010  |   1.071642   1.471486     0.73   0.483    -2.207032    4.350316
        2011  |   .7944093    1.43027     0.56   0.591    -2.392431     3.98125
        2012  |  -.2533875   1.235959    -0.21   0.842    -3.007275      2.5005
        2013  |   1.361007   1.196917     1.14   0.282    -1.305891    4.027906
        2014  |   2.173679   .8452194     2.57   0.028     .2904127    4.056945
        2015  |   2.686445    .911562     2.95   0.015     .6553588    4.717532
        2016  |   2.770932   1.171701     2.36   0.040      .160219    5.381646
        2017  |   2.524667   1.127223     2.24   0.049     .0130586    5.036276
        2018  |   2.541058   1.015006     2.50   0.031     .2794829    4.802633
              |
        _cons |   -.197494   .8961235    -0.22   0.830    -2.194182    1.799194
--------------+----------------------------------------------------------------
      sigma_u |  .86758751
      sigma_e |  2.0365344
          rho |  .15360824   (fraction of variance due to u_i)
-------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20 SD 02/19/22
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs
>  for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  putexcel set $fxlsout, modify sheet("Table 2")
.  qui putexcel A1 = "Table 2 - Estimated Growth Impacts"
.  qui putexcel A3 = "y"
.  qui putexcel B3 = "Method"
.  qui putexcel C3 = "Sample"
.  qui putexcel D2 = "Impact in year"
.  qui putexcel D3   = "0"
.  qui putexcel E3   = "1-2"
.  qui putexcel F3   = "3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .44238049
r2  .42125188
r3  .37277286

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .80670452
r2  .52292386
r3  .37908688

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`est'"

.  qui putexcel C`rn'   = "`smple'"

.  qui putexcel D`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel D`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        346
                                                F(46, 299)        =      14.37
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6980
                                                Root MSE          =     1.6829

-------------------------------------------------------------------------------
              |               Robust
       dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |   .0116907   .0145519     0.80   0.422    -.0169464    .0403279
          L1. |   -.009328    .022022    -0.42   0.672    -.0526658    .0340098
          L2. |    .004607   .0143482     0.32   0.748    -.0236292    .0328432
              |
       dlrgdp |
          L1. |   .6064693   .0789154     7.69   0.000     .4511694    .7617692
          L2. |  -.1236361   .0746749    -1.66   0.099    -.2705911    .0233188
              |
         year |
        1988  |  -1.106732   .9976409    -1.11   0.268    -3.070019    .8565555
        1989  |   -.849004   .6904635    -1.23   0.220    -2.207788    .5097796
        1990  |  -1.334107   .7550192    -1.77   0.078    -2.819932    .1517173
        1991  |  -3.644206   .9359198    -3.89   0.000    -5.486031   -1.802382
        1992  |  -1.791232   .8391017    -2.13   0.034    -3.442525   -.1399388
        1993  |  -1.755297   .8668744    -2.02   0.044    -3.461245   -.0493491
        1994  |   .8208003   .7765938     1.06   0.291    -.7074817    2.349082
        1995  |  -1.452362   .8480757    -1.71   0.088    -3.121315    .2165914
        1996  |  -.8227159   .7203901    -1.14   0.254    -2.240393    .5949611
        1997  |   .4714722   .7533752     0.63   0.532    -1.011117    1.954062
        1998  |  -.2042837   .7928566    -0.26   0.797     -1.76457    1.356002
        1999  |  -.6357525   .7094394    -0.90   0.371    -2.031879    .7603742
        2000  |   .3206879   .6908798     0.46   0.643    -1.038915    1.680291
        2001  |  -2.313698   .6928615    -3.34   0.001    -3.677201   -.9501958
        2002  |  -1.616534    .674534    -2.40   0.017     -2.94397   -.2890989
        2003  |  -1.132318   .6669077    -1.70   0.091    -2.444745    .1801099
        2004  |    .291004   .7999974     0.36   0.716    -1.283335    1.865343
        2005  |  -.9715275   .6848146    -1.42   0.157    -2.319194    .3761395
        2006  |  -.0573099   .6681627    -0.09   0.932    -1.372207    1.257587
        2007  |  -.7045926   1.029164    -0.68   0.494    -2.729915     1.32073
        2008  |  -4.299611   1.101181    -3.90   0.000    -6.466657   -2.132564
        2009  |  -7.548194   .9990002    -7.56   0.000    -9.514156   -5.582232
        2010  |   1.934802   1.048367     1.85   0.066    -.1283096    3.997914
        2011  |  -3.026031   1.009634    -3.00   0.003    -5.012921   -1.039142
        2012  |  -3.113353   .8555018    -3.64   0.000     -4.79692   -1.429786
        2013  |  -.8861008   .8298424    -1.07   0.286    -2.519172    .7469706
        2014  |  -1.213494   .7579597    -1.60   0.110    -2.705105    .2781175
        2015  |   -.943659   .7992657    -1.18   0.239    -2.516558    .6292397
        2016  |  -1.109639   .7620189    -1.46   0.146    -2.609238    .3899609
        2017  |  -1.337045   .7118547    -1.88   0.061    -2.737925    .0638345
        2018  |  -1.208849   .7327979    -1.65   0.100    -2.650944    .2332457
              |
        cdum1 |   .3360122   .3802404     0.88   0.378    -.4122743    1.084299
        cdum2 |   .1255311   .4091694     0.31   0.759    -.6796855    .9307476
        cdum3 |   .6896931   .4107546     1.68   0.094    -.1186431    1.498029
        cdum4 |   .2776751   .3975014     0.70   0.485    -.5045797     1.05993
        cdum5 |   .3918544   .4177369     0.94   0.349    -.4302226    1.213931
        cdum6 |   .5914652   .4253077     1.39   0.165    -.2455105    1.428441
        cdum7 |   1.834845   .7107297     2.58   0.010     .4361792    3.233511
        cdum8 |   .9022635   .6179291     1.46   0.145    -.3137776    2.118305
        cdum9 |   .3757056   .3236257     1.16   0.247    -.2611672    1.012578
       cdum10 |   .8755139   .4916201     1.78   0.076    -.0919598    1.842988
       cdum11 |          0  (omitted)
        _cons |    1.78234   .6419727     2.78   0.006     .5189831    3.045698
-------------------------------------------------------------------------------
(28 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        335
                                                F(45, 289)        =       9.32
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5907
                                                Root MSE          =     1.9699

-------------------------------------------------------------------------------
              |               Robust
     F.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |   .0129709     .01775     0.73   0.466    -.0219648    .0479066
          L1. |  -.0086531   .0242474    -0.36   0.721     -.056377    .0390707
          L2. |   .0053632   .0150185     0.36   0.721    -.0241963    .0349227
              |
       dlrgdp |
          L1. |   .2675073   .0867752     3.08   0.002     .0967158    .4382988
          L2. |  -.0551706   .0897464    -0.61   0.539      -.23181    .1214687
              |
         year |
        1988  |   -.425051   1.082068    -0.39   0.695    -2.554784    1.704682
        1989  |  -.7539729   .9631534    -0.78   0.434    -2.649658    1.141712
        1990  |  -3.229451   1.146482    -2.82   0.005    -5.485964    -.972938
        1991  |  -2.865184    1.05211    -2.72   0.007    -4.935953   -.7944138
        1992  |  -2.023278   .9474405    -2.14   0.034    -3.888036   -.1585194
        1993  |   1.066694   .9865891     1.08   0.281    -.8751166    3.008505
        1994  |   .3129119   1.076839     0.29   0.772    -1.806529    2.432353
        1995  |  -.4913642   .9712584    -0.51   0.613    -2.403001    1.420273
        1996  |    1.09739   .9444787     1.16   0.246    -.7615394    2.956319
        1997  |   1.246475   .9855688     1.26   0.207    -.6933275    3.186278
        1998  |   .3548116   .9228619     0.38   0.701    -1.461571    2.171194
        1999  |   1.020279   .9014594     1.13   0.259     -.753979    2.794537
        2000  |  -1.020365   .8723312    -1.17   0.243    -2.737293     .696563
        2001  |  -1.919135   .8997792    -2.13   0.034    -3.690086    -.148184
        2002  |  -.9681217   .8764277    -1.10   0.270    -2.693112    .7568689
        2003  |   .8126643   .9499766     0.86   0.393    -1.057086    2.682414
        2004  |   .3975981   .8956673     0.44   0.657     -1.36526    2.160456
        2005  |   .5104767   .8800477     0.58   0.562    -1.221639    2.242592
        2006  |   .3814902    1.19899     0.32   0.751     -1.97837     2.74135
        2007  |  -3.581265   1.493452    -2.40   0.017    -6.520687   -.6418425
        2008  |  -9.038766   1.330505    -6.79   0.000    -11.65747   -6.420058
        2009  |  -1.389338   1.125573    -1.23   0.218    -3.604698    .8260222
        2010  |  -.4019466   1.142354    -0.35   0.725    -2.650335    1.846442
        2011  |  -3.554168   1.379521    -2.58   0.010    -6.269351   -.8389846
        2012  |  -1.514588   1.086521    -1.39   0.164    -3.653085    .6239096
        2013  |  -.3786563   .9768036    -0.39   0.699    -2.301207    1.543895
        2014  |  -.4007372   1.029479    -0.39   0.697    -2.426964    1.625489
        2015  |  -.4163386   1.058642    -0.39   0.694    -2.499965    1.667288
        2016  |  -.7989541   .9404247    -0.85   0.396    -2.649904    1.051996
        2017  |   -.779916   .9095049    -0.86   0.392     -2.57001    1.010177
              |
        cdum1 |   .4689615   .4679347     1.00   0.317    -.4520305    1.389954
        cdum2 |   .2335694   .4425244     0.53   0.598      -.63741    1.104549
        cdum3 |   .9138532   .5046653     1.81   0.071    -.0794322    1.907139
        cdum4 |   .3697107   .4957591     0.75   0.456    -.6060455    1.345467
        cdum5 |   .5459116   .5011938     1.09   0.277    -.4405413    1.532364
        cdum6 |   .7618702   .5187554     1.47   0.143    -.2591476    1.782888
        cdum7 |   2.616634   .9131957     2.87   0.004     .8192768    4.413992
        cdum8 |   1.181494   .6540533     1.81   0.072    -.1058178    2.468806
        cdum9 |   .5400375    .393352     1.37   0.171    -.2341604    1.314235
       cdum10 |   1.092926   .5024415     2.18   0.030     .1040171    2.081834
       cdum11 |          0  (omitted)
        _cons |   1.749943   .8302596     2.11   0.036     .1158204    3.384065
-------------------------------------------------------------------------------
(39 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        324
                                                F(44, 279)        =       8.76
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5840
                                                Root MSE          =     1.9972

-------------------------------------------------------------------------------
              |               Robust
    F2.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |   .0049902   .0168653     0.30   0.768    -.0282091    .0381895
          L1. |   .0005288   .0240751     0.02   0.982    -.0468632    .0479207
          L2. |   .0043111   .0149229     0.29   0.773    -.0250647    .0336869
              |
       dlrgdp |
          L1. |   .1940038   .1071608     1.81   0.071    -.0169426    .4049503
          L2. |  -.1487639    .075817    -1.96   0.051    -.2980098    .0004821
              |
         year |
        1988  |  -.7374204    .925821    -0.80   0.426    -2.559902    1.085061
        1989  |  -2.998104   1.078808    -2.78   0.006     -5.12174   -.8744677
        1990  |  -2.686565   1.029374    -2.61   0.010    -4.712891   -.6602404
        1991  |  -2.491864   .8444843    -2.95   0.003    -4.154234    -.829494
        1992  |   1.019282   .9036814     1.13   0.260    -.7596176    2.798182
        1993  |      .1159   .9937583     0.12   0.907    -1.840316    2.072116
        1994  |  -.0159799   .8950959    -0.02   0.986    -1.777979    1.746019
        1995  |     .83979   .9791449     0.86   0.392     -1.08766     2.76724
        1996  |   1.532691   .9313683     1.65   0.101    -.3007104    3.366092
        1997  |   .9466712   .8901719     1.06   0.288     -.805635    2.698977
        1998  |    1.29457    .864343     1.50   0.135    -.4068918    2.996032
        1999  |  -.7282614   .8065633    -0.90   0.367    -2.315984     .859461
        2000  |  -1.308223   .8025658    -1.63   0.104    -2.888076    .2716302
        2001  |  -1.165928   .8495489    -1.37   0.171    -2.838267     .506412
        2002  |   1.075532   .8539481     1.26   0.209    -.6054672    2.756532
        2003  |   .6066621   .8194743     0.74   0.460    -1.006476      2.2198
        2004  |   .9677157    .800707     1.21   0.228    -.6084786     2.54391
        2005  |   .3896524   1.115071     0.35   0.727    -1.805368    2.584673
        2006  |  -3.114506   1.481053    -2.10   0.036    -6.029964   -.1990473
        2007  |  -8.789308   1.307945    -6.72   0.000      -11.364   -6.214614
        2008  |  -2.023601   1.250068    -1.62   0.107    -4.484365    .4371623
        2009  |  -1.567729     .99409    -1.58   0.116    -3.524599    .3891399
        2010  |  -2.136272    1.27152    -1.68   0.094    -4.639263    .3667187
        2011  |  -2.651352   1.136312    -2.33   0.020    -4.888186   -.4145182
        2012  |   -.771488   .9109585    -0.85   0.398    -2.564713    1.021737
        2013  |  -.0531602   .9574556    -0.06   0.956    -1.937914    1.831594
        2014  |  -.4605225   .9487732    -0.49   0.628    -2.328185    1.407141
        2015  |  -.6400644   .8501819    -0.75   0.452     -2.31365    1.033521
        2016  |  -.6428252   .8468339    -0.76   0.448     -2.30982     1.02417
              |
        cdum1 |   .3827368   .4876562     0.78   0.433     -.577216     1.34269
        cdum2 |   .1973429    .447322     0.44   0.659    -.6832118    1.077898
        cdum3 |   .8641133   .5203664     1.66   0.098    -.1602295    1.888456
        cdum4 |   .2513459   .5020329     0.50   0.617    -.7369075    1.239599
        cdum5 |   .4018892   .5141288     0.78   0.435     -.610175    1.413953
        cdum6 |    .668547   .5190866     1.29   0.199    -.3532766    1.690371
        cdum7 |   2.914847    .925577     3.15   0.002     1.092846    4.736848
        cdum8 |   1.389373   .6529293     2.13   0.034     .1040793    2.674666
        cdum9 |   .6471347   .4045108     1.60   0.111    -.1491461    1.443415
       cdum10 |   1.018782   .5105175     2.00   0.047     .0138265    2.023737
       cdum11 |          0  (omitted)
        _cons |   2.065707   .7978243     2.59   0.010     .4951876    3.636227
-------------------------------------------------------------------------------
(50 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        313
                                                F(43, 269)        =       8.87
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5919
                                                Root MSE          =     1.9952

-------------------------------------------------------------------------------
              |               Robust
    F3.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |    .002483    .015352     0.16   0.872    -.0277424    .0327084
          L1. |   .0006621   .0221999     0.03   0.976    -.0430455    .0443697
          L2. |   .0076477   .0146368     0.52   0.602    -.0211696     .036465
              |
       dlrgdp |
          L1. |   .0746157   .0957489     0.78   0.436    -.1138967    .2631281
          L2. |  -.1912367   .0829354    -2.31   0.022    -.3545217   -.0279516
              |
         year |
        1988  |  -2.621841   .9645763    -2.72   0.007     -4.52092   -.7227624
        1989  |   -2.06382   .8503269    -2.43   0.016    -3.737962   -.3896773
        1990  |  -1.989239   .7148309    -2.78   0.006    -3.396614   -.5818646
        1991  |   1.120914    .732911     1.53   0.127    -.3220568    2.563886
        1992  |    .723624   1.035109     0.70   0.485    -1.314321    2.761569
        1993  |    .062391   .8123568     0.08   0.939    -1.536995    1.661777
        1994  |   1.409744     .89514     1.57   0.116    -.3526275    3.172115
        1995  |   1.499489   .8870186     1.69   0.092    -.2468929     3.24587
        1996  |   1.604133   .7568937     2.12   0.035     .1139436    3.094322
        1997  |   2.130056   .7896051     2.70   0.007     .5754646    3.684648
        1998  |  -.1859423   .6790921    -0.27   0.784    -1.522954    1.151069
        1999  |  -.6482735   .7067027    -0.92   0.360    -2.039645    .7430983
        2000  |  -.2494455   .7234542    -0.34   0.731    -1.673798    1.174907
        2001  |   1.331541   .7205549     1.85   0.066    -.0871028    2.750186
        2002  |   1.344546   .6865765     1.96   0.051     -.007201    2.696293
        2003  |    1.51842   .6642136     2.29   0.023     .2107019    2.826138
        2004  |   1.059353   1.070178     0.99   0.323    -1.047637    3.166343
        2005  |   -2.82383   1.402008    -2.01   0.045    -5.584134   -.0635262
        2006  |  -8.018763   1.222145    -6.56   0.000    -10.42495   -5.612577
        2007  |  -1.468585   1.146484    -1.28   0.201    -3.725808    .7886381
        2008  |  -1.581537   1.045623    -1.51   0.132    -3.640183    .4771088
        2009  |  -2.401243   .9868687    -2.43   0.016    -4.344212   -.4582742
        2010  |  -1.122648   1.075273    -1.04   0.297    -3.239668    .9943728
        2011  |  -1.823424   .9390833    -1.94   0.053    -3.672311    .0254641
        2012  |  -.0029386    .804947    -0.00   0.997    -1.587736    1.581859
        2013  |   .1056722   .8701634     0.12   0.903    -1.607525    1.818869
        2014  |  -.4807103   .7568504    -0.64   0.526    -1.970814    1.009393
        2015  |  -.2268432   .7678952    -0.30   0.768    -1.738692    1.285006
              |
        cdum1 |   .3046776   .5089075     0.60   0.550    -.6972707    1.306626
        cdum2 |   .1878559   .4599361     0.41   0.683    -.7176763    1.093388
        cdum3 |   .8855556   .5360035     1.65   0.100    -.1697398    1.940851
        cdum4 |   .1744328   .5082094     0.34   0.732    -.8261411    1.175007
        cdum5 |   .3278965   .5274887     0.62   0.535    -.7106349    1.366428
        cdum6 |   .7291421   .5351007     1.36   0.174    -.3243759     1.78266
        cdum7 |   3.216556    .889212     3.62   0.000     1.465856    4.967256
        cdum8 |   1.624519   .6455159     2.52   0.012     .3536134    2.895425
        cdum9 |    .812688   .4186968     1.94   0.053    -.0116516    1.637028
       cdum10 |   1.024202   .5279186     1.94   0.053    -.0151756     2.06358
       cdum11 |          0  (omitted)
        _cons |   1.964262   .6670206     2.94   0.004     .6510168    3.277506
-------------------------------------------------------------------------------
(61 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        302
                                                F(42, 259)        =       9.00
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6002
                                                Root MSE          =     1.9928

-------------------------------------------------------------------------------
              |               Robust
    F4.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |  -.0039077    .015132    -0.26   0.796     -.033705    .0258897
          L1. |   .0177528   .0215417     0.82   0.411    -.0246663     .060172
          L2. |  -.0046262   .0131755    -0.35   0.726     -.030571    .0213185
              |
       dlrgdp |
          L1. |  -.0686435   .0786275    -0.87   0.383    -.2234741     .086187
          L2. |  -.1482795   .0718202    -2.06   0.040    -.2897053   -.0068537
              |
         year |
        1988  |      .3622   1.004953     0.36   0.719    -1.616718    2.341118
        1989  |   .6129705   .8522897     0.72   0.473    -1.065329     2.29127
        1990  |   3.647839   .8390221     4.35   0.000     1.995666    5.300012
        1991  |   3.154207   1.105372     2.85   0.005     .9775468    5.330867
        1992  |   2.764529   .9468243     2.92   0.004      .900075    4.628983
        1993  |   3.580964   1.003275     3.57   0.000      1.60535    5.556578
        1994  |   3.892777    1.01108     3.85   0.000     1.901792    5.883762
        1995  |   3.726148   .9320584     4.00   0.000      1.89077    5.561525
        1996  |   4.785285    .898152     5.33   0.000     3.016675    6.553895
        1997  |   2.469901   .8161953     3.03   0.003     .8626771    4.077124
        1998  |   1.866534   .8500316     2.20   0.029     .1926809    3.540387
        1999  |   2.393793   .8788083     2.72   0.007     .6632736    4.124312
        2000  |   4.108426   .8662068     4.74   0.000     2.402721    5.814131
        2001  |   3.813127   .8162782     4.67   0.000      2.20574    5.420514
        2002  |   4.301545   .7986411     5.39   0.000     2.728888    5.874201
        2003  |   3.631749   1.139678     3.19   0.002     1.387533    5.875964
        2004  |   -.271882   1.447447    -0.19   0.851    -3.122144     2.57838
        2005  |  -5.661324   1.294992    -4.37   0.000    -8.211378    -3.11127
        2006  |   1.227854   1.231928     1.00   0.320    -1.198016    3.653723
        2007  |   .9912021   1.137493     0.87   0.384     -1.24871    3.231115
        2008  |   .0197183   1.042772     0.02   0.985    -2.033672    2.073109
        2009  |   1.297951   .9713661     1.34   0.183    -.6148292    3.210732
        2010  |   1.230368   .9907318     1.24   0.215    -.7205468    3.181283
        2011  |   1.390257   .9990039     1.39   0.165     -.576947    3.357461
        2012  |   2.421184   .8843036     2.74   0.007      .679844    4.162524
        2013  |   2.064619   .8457239     2.44   0.015     .3992482    3.729989
        2014  |   2.075346   .8571068     2.42   0.016     .3875604    3.763131
              |
        cdum1 |   .0547971   .5171187     0.11   0.916    -.9634951    1.073089
        cdum2 |   .0027255   .4637649     0.01   0.995    -.9105045    .9159554
        cdum3 |   .7207901   .5523357     1.30   0.193    -.3668504    1.808431
        cdum4 |   .0835865   .5092552     0.16   0.870    -.9192212    1.086394
        cdum5 |   .1080722   .5351906     0.20   0.840    -.9458067    1.161951
        cdum6 |   .6304384   .5398261     1.17   0.244    -.4325686    1.693446
        cdum7 |   3.082175   .8145155     3.78   0.000     1.478259    4.686091
        cdum8 |   1.571672   .6486134     2.42   0.016     .2944451    2.848899
        cdum9 |   .8070461   .4162676     1.94   0.054    -.0126537    1.626746
       cdum10 |   .9394439   .5430622     1.73   0.085    -.1299355    2.008823
       cdum11 |          0  (omitted)
        _cons |  -.1353391   .8276018    -0.16   0.870    -1.765024    1.494346
-------------------------------------------------------------------------------
(72 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        291
                                                F(41, 249)        =       9.35
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6014
                                                Root MSE          =     1.9811

-------------------------------------------------------------------------------
              |               Robust
    F5.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |   .0063439   .0120346     0.53   0.599    -.0173587    .0300466
          L1. |   .0047061   .0203141     0.23   0.817    -.0353034    .0447155
          L2. |  -.0022156   .0141028    -0.16   0.875    -.0299916    .0255604
              |
       dlrgdp |
          L1. |  -.1470122   .0752287    -1.95   0.052    -.2951779    .0011534
          L2. |  -.0793844   .0722192    -1.10   0.273    -.2216228    .0628539
              |
         year |
        1988  |   .2600007   .8511785     0.31   0.760    -1.416427    1.936428
        1989  |   3.371772    .807354     4.18   0.000     1.781659    4.961886
        1990  |   2.832648   1.045194     2.71   0.007     .7741011    4.891196
        1991  |   2.695825    .907331     2.97   0.003     .9088028    4.482847
        1992  |    3.51315   1.005065     3.50   0.001     1.533637    5.492664
        1993  |   3.411522   1.005318     3.39   0.001     1.431511    5.391533
        1994  |   3.089427   .9026858     3.42   0.001     1.311554      4.8673
        1995  |   4.240695   .9089838     4.67   0.000     2.450417    6.030972
        1996  |   2.203368   .7869907     2.80   0.006     .6533609    3.753375
        1997  |    1.44178   .8261963     1.75   0.082    -.1854442    3.069004
        1998  |   1.969454   .8746793     2.25   0.025     .2467413    3.692167
        1999  |   3.816845   .8545445     4.47   0.000     2.133788    5.499902
        2000  |   3.487216   .8043516     4.34   0.000     1.903016    5.071416
        2001  |   4.085482   .7949189     5.14   0.000      2.51986    5.651104
        2002  |   3.519218   1.090492     3.23   0.001     1.371453    5.666983
        2003  |  -.5782762   1.435221    -0.40   0.687    -3.404998    2.248445
        2004  |  -6.132805   1.277921    -4.80   0.000    -8.649717   -3.615894
        2005  |   .7839238   1.245697     0.63   0.530    -1.669522    3.237369
        2006  |   .6530048   1.125255     0.58   0.562    -1.563227    2.869237
        2007  |  -.3331433   1.024291    -0.33   0.745    -2.350523    1.684236
        2008  |   1.275286   .9720711     1.31   0.191    -.6392437    3.189816
        2009  |   1.546228   .8185677     1.89   0.060    -.0659713    3.158427
        2010  |   .9750723   .9315149     1.05   0.296    -.8595807    2.809725
        2011  |   1.579241   1.065168     1.48   0.139    -.5186469    3.677128
        2012  |    1.81613   .8207194     2.21   0.028     .1996932    3.432567
        2013  |   1.663014   .8077483     2.06   0.041     .0721241    3.253904
              |
        cdum1 |   .0005062   .5396258     0.00   0.999    -1.062307    1.063319
        cdum2 |   -.129523   .4609736    -0.28   0.779    -1.037427    .7783814
        cdum3 |   .5902221   .5605982     1.05   0.293    -.5138967    1.694341
        cdum4 |    .247676   .4958762     0.50   0.618    -.7289705    1.224323
        cdum5 |  -.0064604     .54552    -0.01   0.991    -1.080882    1.067961
        cdum6 |   .6053238   .5532926     1.09   0.275    -.4844065    1.695054
        cdum7 |   3.049458   .8582049     3.55   0.000     1.359192    4.739724
        cdum8 |   1.551368    .690624     2.25   0.026     .1911583    2.911577
        cdum9 |   .7021371   .4111793     1.71   0.089    -.1076957     1.51197
       cdum10 |   .9263109   .5731617     1.62   0.107    -.2025521    2.055174
       cdum11 |          0  (omitted)
        _cons |   .2727505   .7920164     0.34   0.731    -1.287155    1.832656
-------------------------------------------------------------------------------
(83 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        280
                                                F(40, 239)        =      10.65
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6069
                                                Root MSE          =     1.9695

-------------------------------------------------------------------------------
              |               Robust
    F6.dlrgdp | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |   .0067597   .0162149     0.42   0.677    -.0251827    .0387021
          L1. |  -.0168127   .0181538    -0.93   0.355    -.0525746    .0189492
          L2. |   .0192058   .0115615     1.66   0.098    -.0035697    .0419813
              |
       dlrgdp |
          L1. |  -.1539948   .0811558    -1.90   0.059    -.3138667    .0058772
          L2. |  -.0658089   .0882065    -0.75   0.456    -.2395703    .1079526
              |
         year |
        1988  |   3.232024   .5989587     5.40   0.000     2.052112    4.411936
        1989  |   2.732438   .8463938     3.23   0.001     1.065094    4.399783
        1990  |   2.683931   .6429306     4.17   0.000     1.417397    3.950465
        1991  |   3.823472   .9028374     4.23   0.000     2.044937    5.602007
        1992  |   3.883214   .8534261     4.55   0.000     2.202017    5.564412
        1993  |   2.827618   .7364161     3.84   0.000     1.376923    4.278313
        1994  |   3.586997   .6828898     5.25   0.000     2.241745    4.932249
        1995  |   1.920793   .5891337     3.26   0.001     .7602356    3.081351
        1996  |   1.314453   .6075705     2.16   0.031     .1175762     2.51133
        1997  |   1.659908   .6214684     2.67   0.008     .4356526    2.884163
        1998  |   3.532292    .596768     5.92   0.000     2.356696    4.707889
        1999  |     3.3811   .5596656     6.04   0.000     2.278593    4.483607
        2000  |   3.838719   .5106852     7.52   0.000       2.8327    4.844738
        2001  |   3.602672   .8800619     4.09   0.000     1.869004    5.336341
        2002  |  -.4980761   1.214037    -0.41   0.682    -2.889656    1.893503
        2003  |  -6.278153   1.166608    -5.38   0.000    -8.576299   -3.980006
        2004  |   .3634618   1.100768     0.33   0.742    -1.804984    2.531907
        2005  |   .4191992   1.016033     0.41   0.680    -1.582325    2.420724
        2006  |  -.5947324   .8511449    -0.70   0.485    -2.271436    1.081971
        2007  |   1.096606   .8128607     1.35   0.179    -.5046804    2.697892
        2008  |   1.942548   .6373745     3.05   0.003     .6869584    3.198137
        2009  |   1.943154    .657349     2.96   0.003     .6482165    3.238092
        2010  |   .8962213   .8243585     1.09   0.278    -.7277151    2.520158
        2011  |   1.332112   .8501562     1.57   0.118    -.3426445    3.006868
        2012  |   1.735546   .5441353     3.19   0.002     .6636323    2.807459
              |
        cdum1 |  -.1424651   .5475877    -0.26   0.795     -1.22118    .9362495
        cdum2 |  -.3576227   .4447833    -0.80   0.422    -1.233819    .5185734
        cdum3 |   .4234497   .5577488     0.76   0.448    -.6752817    1.522181
        cdum4 |   .2866905   .4830802     0.59   0.553    -.6649482    1.238329
        cdum5 |  -.2432263   .5294515    -0.46   0.646    -1.286214     .799761
        cdum6 |   .4326037   .5456833     0.79   0.429    -.6423593    1.507567
        cdum7 |   2.902697   .8533382     3.40   0.001     1.221672    4.583722
        cdum8 |   1.575533   .6726708     2.34   0.020     .2504118    2.900653
        cdum9 |    .471876   .3931627     1.20   0.231    -.3026307    1.246383
       cdum10 |   .9123784   .5714558     1.60   0.112    -.2133549    2.038112
       cdum11 |          0  (omitted)
        _cons |    .545447   .6722468     0.81   0.418    -.7788384    1.869732
-------------------------------------------------------------------------------
(94 missing values generated)
0   .01169072   .01454868
1   .01297092   .01774588
2   .00499022   .01686116
3   .00248296   .01534811
4   -.00390766   .01512792
5   .00634395   .01203121
6   .00675967   .01621008

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20 SD 02/19/22
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs
>  for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  putexcel set $fxlsout, modify sheet("Table 2")
.  qui putexcel A1 = "Table 2 - Estimated Growth Impacts"
.  qui putexcel A3 = "y"
.  qui putexcel B3 = "Method"
.  qui putexcel C3 = "Sample"
.  qui putexcel D2 = "Impact in year"
.  qui putexcel D3   = "0"
.  qui putexcel E3   = "1-2"
.  qui putexcel F3   = "3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  .46762863
r2  .34540697
r3  .16478785

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .58194714
r2   .6224397
r3  .42630092

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`est'"

.  qui putexcel C`rn'   = "`smple'"

.  qui putexcel D`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel D`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(0 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         32        2.94        2.94
       1986 |         32        2.94        5.88
       1987 |         32        2.94        8.82
       1988 |         32        2.94       11.76
       1989 |         32        2.94       14.71
       1990 |         32        2.94       17.65
       1991 |         32        2.94       20.59
       1992 |         32        2.94       23.53
       1993 |         32        2.94       26.47
       1994 |         32        2.94       29.41
       1995 |         32        2.94       32.35
       1996 |         32        2.94       35.29
       1997 |         32        2.94       38.24
       1998 |         32        2.94       41.18
       1999 |         32        2.94       44.12
       2000 |         32        2.94       47.06
       2001 |         32        2.94       50.00
       2002 |         32        2.94       52.94
       2003 |         32        2.94       55.88
       2004 |         32        2.94       58.82
       2005 |         32        2.94       61.76
       2006 |         32        2.94       64.71
       2007 |         32        2.94       67.65
       2008 |         32        2.94       70.59
       2009 |         32        2.94       73.53
       2010 |         32        2.94       76.47
       2011 |         32        2.94       79.41
       2012 |         32        2.94       82.35
       2013 |         32        2.94       85.29
       2014 |         32        2.94       88.24
       2015 |         32        2.94       91.18
       2016 |         32        2.94       94.12
       2017 |         32        2.94       97.06
       2018 |         32        2.94      100.00
------------+-----------------------------------
      Total |      1,088      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        AUT |         34        3.13        3.13
        BEL |         34        3.13        6.25
        BGR |         34        3.13        9.38
        CHE |         34        3.13       12.50
        CYP |         34        3.13       15.63
        CZE |         34        3.13       18.75
        DEU |         34        3.13       21.88
        DNK |         34        3.13       25.00
        ESP |         34        3.13       28.13
        EST |         34        3.13       31.25
        FIN |         34        3.13       34.38
        FRA |         34        3.13       37.50
        GBR |         34        3.13       40.63
        GRC |         34        3.13       43.75
        HRV |         34        3.13       46.88
        HUN |         34        3.13       50.00
        IRL |         34        3.13       53.13
        ISL |         34        3.13       56.25
        ITA |         34        3.13       59.38
        LIE |         34        3.13       62.50
        LTU |         34        3.13       65.63
        LUX |         34        3.13       68.75
        LVA |         34        3.13       71.88
        MLT |         34        3.13       75.00
        NLD |         34        3.13       78.13
        NOR |         34        3.13       81.25
        POL |         34        3.13       84.38
        PRT |         34        3.13       87.50
        ROU |         34        3.13       90.63
        SVK |         34        3.13       93.75
        SVN |         34        3.13       96.88
        SWE |         34        3.13      100.00
------------+-----------------------------------
      Total |      1,088      100.00

Fixed-effects (within) regression               Number of obs     =        664
Group variable: cnum                            Number of groups  =         30

R-squared:                                      Obs per group:
     Within  = 0.3331                                         min =          4
     Between = 0.1273                                         avg =       22.1
     Overall = 0.2941                                         max =         28

                                                F(29,29)          =          .
corr(u_i, Xb) = 0.0019                          Prob > F          =          .

                                   (Std. err. adjusted for 30 clusters in cnum)
-------------------------------------------------------------------------------
              |               Robust
     dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          D1. |   .0081128   .0488451     0.17   0.869    -.0917866    .1080123
          LD. |   .0253137   .0382003     0.66   0.513    -.0528147    .1034421
         L2D. |   .0509261   .0275375     1.85   0.075    -.0053945    .1072467
         L3D. |  -.0038089   .0199797    -0.19   0.850    -.0446721    .0370542
         L4D. |   .0127845   .0144373     0.89   0.383    -.0167431    .0423121
         L5D. |   .0156971   .0162099     0.97   0.341     -.017456    .0488502
          L6. |   .0126892   .0165749     0.77   0.450    -.0212102    .0465886
              |
         year |
        1992  |  -.2677143   .3367997    -0.79   0.433    -.9565471    .4211185
        1993  |   -.360824   .6390694    -0.56   0.577    -1.667868    .9462196
        1994  |    2.03782   1.184157     1.72   0.096     -.384052    4.459692
        1995  |    3.12524   1.756527     1.78   0.086     -.467262    6.717741
        1996  |     2.4784   1.618617     1.53   0.137     -.832043    5.788842
        1997  |   2.775035   1.668107     1.66   0.107     -.636628    6.186697
        1998  |   3.369949   1.586523     2.12   0.042     .1251457    6.614752
        1999  |   3.088019   1.586097     1.95   0.061    -.1559133    6.331951
        2000  |   2.961307   1.589031     1.86   0.073    -.2886265    6.211241
        2001  |   2.777328   1.587251     1.75   0.091    -.4689646    6.023621
        2002  |   2.197808   1.628997     1.35   0.188    -1.133864    5.529481
        2003  |   2.504973   1.581921     1.58   0.124    -.7304189    5.740365
        2004  |   2.458787   1.564599     1.57   0.127    -.7411778    5.658751
        2005  |   3.020192   1.576527     1.92   0.065    -.2041684    6.244552
        2006  |   3.995678   1.586314     2.52   0.018     .7513012    7.240054
        2007  |    4.09888   1.585229     2.59   0.015     .8567215    7.341038
        2008  |   3.094966   1.616297     1.91   0.065    -.2107326    6.400664
        2009  |  -1.072972   1.698108    -0.63   0.532    -4.545993    2.400049
        2010  |   .2900744   1.573342     0.18   0.855    -2.927772     3.50792
        2011  |   1.978497   1.622753     1.22   0.233    -1.340405    5.297399
        2012  |   1.616851   1.616416     1.00   0.325    -1.689091    4.922794
        2013  |   1.736373   1.549275     1.12   0.272    -1.432251    4.904997
        2014  |   2.947804   1.529975     1.93   0.064    -.1813473    6.076955
        2015  |   3.077615   1.521578     2.02   0.052    -.0343616    6.189592
        2016  |   3.290903   1.513582     2.17   0.038     .1952802    6.386527
        2017  |    4.03479    1.55906     2.59   0.015     .8461539    7.223426
        2018  |   3.642627   1.577029     2.31   0.028     .4172395    6.868014
              |
        _cons |  -1.823386   1.534478    -1.19   0.244    -4.961746    1.314974
--------------+----------------------------------------------------------------
      sigma_u |  .85791431
      sigma_e |   1.815548
          rho |  .18253342   (fraction of variance due to u_i)
-------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20 SD 02/19/22
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs
>  for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  putexcel set $fxlsout, modify sheet("Table 2")
.  qui putexcel A1 = "Table 2 - Estimated Growth Impacts"
.  qui putexcel A3 = "y"
.  qui putexcel B3 = "Method"
.  qui putexcel C3 = "Sample"
.  qui putexcel D2 = "Impact in year"
.  qui putexcel D3   = "0"
.  qui putexcel E3   = "1-2"
.  qui putexcel F3   = "3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1  .09735411
r2  .45743904
r3  .09869054

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .58614111
r2  .37935376
r3  .15357284

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`est'"

.  qui putexcel C`rn'   = "`smple'"

.  qui putexcel D`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel D`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum6 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        648
                                                F(65, 582)        =      12.76
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5823
                                                Root MSE          =     1.5468

-------------------------------------------------------------------------------
              |               Robust
     dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0253434   .0251673     1.01   0.314    -.0240863    .0747731
          L1. |  -.0055436   .0370504    -0.15   0.881    -.0783123    .0672251
          L2. |  -.0090854   .0243905    -0.37   0.710    -.0569894    .0388187
              |
     dlemptot |
          L1. |   .5776887    .066435     8.70   0.000     .4472071    .7081702
          L2. |  -.1381985   .0659919    -2.09   0.037    -.2678098   -.0085872
              |
         year |
        1988  |  -.9231785   .4368981    -2.11   0.035    -1.781268   -.0650895
        1989  |  -.4806438   .8019132    -0.60   0.549     -2.05564    1.094352
        1990  |  -.6411251   .4424135    -1.45   0.148    -1.510047    .2277964
        1991  |  -2.496333   1.240134    -2.01   0.045    -4.932017   -.0606492
        1992  |  -1.899731   .8535653    -2.23   0.026    -3.576175   -.2232878
        1993  |  -1.693394   .6753501    -2.51   0.012    -3.019815   -.3669741
        1994  |   .5855731   .5743208     1.02   0.308    -.5424208    1.713567
        1995  |   .0708844   .6171297     0.11   0.909    -1.141188    1.282957
        1996  |  -.6078208   .5148134    -1.18   0.238    -1.618939    .4032977
        1997  |   .2770139    .575232     0.48   0.630    -.8527695    1.406797
        1998  |   .1700353   .4726101     0.36   0.719    -.7581938    1.098264
        1999  |  -.3442493   .4729819    -0.73   0.467    -1.273209      .58471
        2000  |   .0238404   .4354061     0.05   0.956    -.8313182     .878999
        2001  |  -.0532724   .4038643    -0.13   0.895    -.8464814    .7399367
        2002  |   -.648737   .5425648    -1.20   0.232     -1.71436    .4168865
        2003  |   -.001056   .4737843    -0.00   0.998    -.9315913    .9294794
        2004  |  -.2968354   .4199111    -0.71   0.480    -1.121561    .5278904
        2005  |   .3306076    .404883     0.82   0.415    -.4646021    1.125817
        2006  |   .9759607   .4327215     2.26   0.024     .1260747    1.825847
        2007  |   .5836604   .4155586     1.40   0.161    -.2325168    1.399837
        2008  |  -.3391932   .4278861    -0.79   0.428    -1.179582    .5011958
        2009  |  -3.688333   .6793777    -5.43   0.000    -5.022664   -2.354003
        2010  |  -.3858975   .5157775    -0.75   0.455    -1.398909    .6271144
        2011  |   .0143275   .5373254     0.03   0.979    -1.041006    1.069661
        2012  |  -1.108739   .4984871    -2.22   0.027    -2.087792   -.1296861
        2013  |  -.5621679   .4437871    -1.27   0.206    -1.433787    .3094514
        2014  |   .5599918   .4517505     1.24   0.216    -.3272681    1.447252
        2015  |   .0290819   .4181687     0.07   0.945    -.7922217    .8503854
        2016  |   .2071659    .414689     0.50   0.618    -.6073033    1.021635
        2017  |   .8253383   .4475336     1.84   0.066    -.0536393    1.704316
        2018  |   .2134227   .4016704     0.53   0.595    -.5754774    1.002323
              |
        cdum1 |   .5824024      .5659     1.03   0.304    -.5290526    1.693857
        cdum2 |   .5670545   .5724507     0.99   0.322    -.5572664    1.691375
        cdum3 |   .0840901   .6412129     0.13   0.896    -1.175283    1.343463
        cdum4 |   .6004362   .5264007     1.14   0.254    -.4334402    1.634313
        cdum5 |   .9687888   .6582668     1.47   0.142    -.3240791    2.261657
        cdum6 |          0  (omitted)
        cdum7 |    .373695   .5886565     0.63   0.526    -.7824549    1.529845
        cdum8 |   .2900189   .4858565     0.60   0.551    -.6642267    1.244265
        cdum9 |   .7773186   .6650858     1.17   0.243    -.5289421    2.083579
       cdum10 |   .1205054   .8743001     0.14   0.890    -1.596662    1.837673
       cdum11 |   .2439142   .4609399     0.53   0.597    -.6613941    1.149223
       cdum12 |   .5410282   .5509057     0.98   0.326    -.5409771    1.623034
       cdum13 |   .5047221   .5584015     0.90   0.366    -.5920055     1.60145
       cdum14 |   .0954462   .7262155     0.13   0.895    -1.330876    1.521769
       cdum15 |   .1778108   .6292845     0.28   0.778    -1.058134    1.413756
       cdum16 |   .4433204   .6373151     0.70   0.487    -.8083972    1.695038
       cdum17 |    1.08878   .6158714     1.77   0.078    -.1208213    2.298381
       cdum18 |   1.297139   .6039469     2.15   0.032     .1109579     2.48332
       cdum19 |   .3745622   .5698785     0.66   0.511    -.7447069    1.493831
       cdum20 |   3.745066   1.778401     2.11   0.036     .2521999    7.237932
       cdum21 |  -.2042005   .7519369    -0.27   0.786    -1.681041     1.27264
       cdum22 |   1.795654   .5995265     3.00   0.003      .618155    2.973153
       cdum23 |  -.2769107    .910063    -0.30   0.761    -2.064318    1.510497
       cdum24 |   1.302543   .6510728     2.00   0.046     .0238044    2.581281
       cdum25 |   .5292331   .5771006     0.92   0.359    -.6042204    1.662687
       cdum26 |   .3244606   .3068922     1.06   0.291    -.2782907    .9272118
       cdum27 |   .1795776   .6520958     0.28   0.783     -1.10117    1.460325
       cdum28 |   .0794507   .5876843     0.14   0.893     -1.07479    1.233691
       cdum29 |  -.7693147   .8856637    -0.87   0.385    -2.508801    .9701717
       cdum30 |          0  (omitted)
       cdum31 |   .3673737   .5235096     0.70   0.483    -.6608246    1.395572
       cdum32 |          0  (omitted)
        _cons |   .1650337   .5191902     0.32   0.751     -.854681    1.184748
-------------------------------------------------------------------------------
(440 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        618
                                                F(63, 553)        =          .
                                                Prob > F          =          .
                                                R-squared         =     0.4573
                                                Root MSE          =     1.7773

-------------------------------------------------------------------------------
              |               Robust
   F.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0273113   .0358525     0.76   0.447    -.0431125     .097735
          L1. |   .0109705   .0493732     0.22   0.824    -.0860115    .1079526
          L2. |  -.0271739   .0326633    -0.83   0.406    -.0913333    .0369856
              |
     dlemptot |
          L1. |   .2358261   .0787158     3.00   0.003     .0812076    .3904446
          L2. |  -.1817991   .0651193    -2.79   0.005    -.3097104   -.0538877
              |
         year |
        1988  |  -.0680492   .9617613    -0.07   0.944    -1.957201    1.821103
        1989  |    .048169   .4335963     0.11   0.912    -.8035281    .8998661
        1990  |  -1.793772   1.244229    -1.44   0.150    -4.237765    .6502211
        1991  |   -2.31509   1.494076    -1.55   0.122    -5.249849    .6196692
        1992  |  -1.989363   .9496458    -2.09   0.037    -3.854717   -.1240088
        1993  |   .4585095   .6930865     0.66   0.509    -.9028947    1.819914
        1994  |    1.20786   .5661305     2.13   0.033     .0958307    2.319889
        1995  |   .5242646   .5308258     0.99   0.324    -.5184168    1.566946
        1996  |   .8066747   .7885603     1.02   0.307    -.7422653    2.355615
        1997  |    1.69608   .4359466     3.89   0.000     .8397664    2.552394
        1998  |   .6679159   .5678283     1.18   0.240    -.4474482     1.78328
        1999  |   .7818525   .5307847     1.47   0.141    -.2607483    1.824453
        2000  |   .9541016   .4804206     1.99   0.048      .010429    1.897774
        2001  |   .2728943   .5931204     0.46   0.646    -.8921503    1.437939
        2002  |   .5881524   .5219194     1.13   0.260    -.4370345    1.613339
        2003  |   .6894522   .4979972     1.38   0.167    -.2887454     1.66765
        2004  |   1.064633   .4856252     2.19   0.029     .1107376    2.018529
        2005  |   2.103666   .5134848     4.10   0.000     1.095046    3.112285
        2006  |   2.065058   .4883743     4.23   0.000     1.105762    3.024353
        2007  |   .9434727   .5002282     1.89   0.060    -.0391071    1.926053
        2008  |  -2.845028   .7743215    -3.67   0.000    -4.365999   -1.324057
        2009  |  -1.429088   .5291744    -2.70   0.007    -2.468526   -.3896508
        2010  |       .975   .6306834     1.55   0.123    -.2638281    2.213828
        2011  |  -.4344722   .6355566    -0.68   0.495    -1.682873    .8139282
        2012  |  -.4675358   .5572248    -0.84   0.402    -1.562072    .6270002
        2013  |    1.17387    .512825     2.29   0.022     .1665464    2.181193
        2014  |   1.257296   .4757697     2.64   0.008     .3227593    2.191833
        2015  |   1.157514   .4760906     2.43   0.015     .2223464    2.092681
        2016  |   1.886686   .5078863     3.71   0.000     .8890634    2.884308
        2017  |   1.642134   .4650988     3.53   0.000     .7285579    2.555711
              |
        cdum1 |   .6212371   .7097455     0.88   0.382    -.7728898    2.015364
        cdum2 |   .5674831   .7165158     0.79   0.429    -.8399425    1.974909
        cdum3 |  -.2267462   .7931806    -0.29   0.775    -1.784762    1.331269
        cdum4 |   .6943409   .6792676     1.02   0.307    -.6399193    2.028601
        cdum5 |   1.215523   .8463674     1.44   0.152    -.4469649    2.878012
        cdum6 |          0  (omitted)
        cdum7 |   .2528273   .7290139     0.35   0.729    -1.179148    1.684802
        cdum8 |   .1735595   .5983629     0.29   0.772    -1.001783    1.348902
        cdum9 |   .8932243   .8639821     1.03   0.302    -.8038639    2.590313
       cdum10 |  -.0282466   1.007963    -0.03   0.978     -2.00815    1.951657
       cdum11 |   .0297919   .5903973     0.05   0.960    -1.129904    1.189487
       cdum12 |   .5497116   .6988801     0.79   0.432    -.8230728    1.922496
       cdum13 |   .5368671   .6987022     0.77   0.443    -.8355678    1.909302
       cdum14 |  -.4359967   .8625594    -0.51   0.613     -2.13029    1.258297
       cdum15 |  -.0393532    .782357    -0.05   0.960    -1.576108    1.497402
       cdum16 |   .3520719    .779808     0.45   0.652    -1.179676     1.88382
       cdum17 |   1.337757   .7764004     1.72   0.085     -.187298    2.862811
       cdum18 |   1.899902   .7428389     2.56   0.011     .4407712    3.359033
       cdum19 |   .2591457   .7099243     0.37   0.715    -1.135332    1.653624
       cdum20 |   6.633436   .7243408     9.16   0.000      5.21064    8.056232
       cdum21 |  -.7196233   .9103281    -0.79   0.430    -2.507747      1.0685
       cdum22 |   2.633782   .7558733     3.48   0.001     1.149048    4.118516
       cdum23 |  -.7103036   1.070165    -0.66   0.507     -2.81239    1.391782
       cdum24 |   1.876833   .8281584     2.27   0.024     .2501121    3.503554
       cdum25 |   .5154652   .7180448     0.72   0.473    -.8949637    1.925894
       cdum26 |   .3802703   .3833068     0.99   0.322     -.372645    1.133186
       cdum27 |  -.0316305   .8228504    -0.04   0.969    -1.647925    1.584664
       cdum28 |  -.2922226   .7425973    -0.39   0.694    -1.750879    1.166434
       cdum29 |   -1.47399   .9258715    -1.59   0.112    -3.292645    .3446655
       cdum30 |          0  (omitted)
       cdum31 |   .2328784   .6336452     0.37   0.713    -1.011767    1.477524
       cdum32 |          0  (omitted)
        _cons |  -.3171344   .6539788    -0.48   0.628    -1.601721     .967452
-------------------------------------------------------------------------------
(470 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        588
                                                F(62, 525)        =       8.70
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4397
                                                Root MSE          =     1.7879

-------------------------------------------------------------------------------
              |               Robust
  F2.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   .0436436   .0340554     1.28   0.201     -.023258    .1105453
          L1. |  -.0516657   .0438434    -1.18   0.239    -.1377958    .0344644
          L2. |    .016461    .023852     0.69   0.490     -.030396     .063318
              |
     dlemptot |
          L1. |  -.0036551   .0624368    -0.06   0.953    -.1263117    .1190015
          L2. |  -.1259412   .0498493    -2.53   0.012    -.2238699   -.0280125
              |
         year |
        1988  |  -.0793046   .9655683    -0.08   0.935    -1.976157    1.817547
        1989  |  -1.791314   1.439298    -1.24   0.214    -4.618806    1.036177
        1990  |  -2.219718   1.642208    -1.35   0.177    -5.445824    1.006389
        1991  |  -2.429611   1.413344    -1.72   0.086    -5.206115    .3468935
        1992  |   .2820054   1.149865     0.25   0.806    -1.976896    2.540906
        1993  |   1.063998   .9439788     1.13   0.260    -.7904415    2.918438
        1994  |   .6285273   .9406693     0.67   0.504    -1.219411    2.476465
        1995  |   1.274639   1.049769     1.21   0.225    -.7876252    3.336903
        1996  |   1.552489   .9070915     1.71   0.088    -.2294859    3.334463
        1997  |   1.624885   .9393211     1.73   0.084     -.220405    3.470174
        1998  |   .8590465    .968614     0.89   0.376    -1.043789    2.761882
        1999  |   .9422814   .9365065     1.01   0.315    -.8974789    2.782042
        2000  |   .3878241   .9944053     0.39   0.697    -1.565678    2.341326
        2001  |    .644411   .9453376     0.68   0.496    -1.212698     2.50152
        2002  |   .6120858   .9342312     0.66   0.513    -1.223205    2.447376
        2003  |   1.173817   .9289779     1.26   0.207    -.6511536    2.998787
        2004  |   2.069163   .9422795     2.20   0.029     .2180617    3.920264
        2005  |   2.210837    .931536     2.37   0.018     .3808411    4.040833
        2006  |   1.208008   .9370058     1.29   0.198    -.6327335    3.048749
        2007  |  -2.650726   1.109305    -2.39   0.017    -4.829948   -.4715038
        2008  |  -1.370803   .9559841    -1.43   0.152    -3.248827    .5072211
        2009  |   .3102158    .998169     0.31   0.756     -1.65068    2.271112
        2010  |  -.2266481   1.014521    -0.22   0.823    -2.219667    1.766371
        2011  |  -.6257478   .9765495    -0.64   0.522    -2.544172    1.292677
        2012  |   .8050933     .94469     0.85   0.394    -1.050744     2.66093
        2013  |   1.198443   .9162624     1.31   0.191    -.6015481    2.998434
        2014  |   1.320493   .9183667     1.44   0.151    -.4836312    3.124618
        2015  |   1.892265   .9331537     2.03   0.043     .0590915    3.725439
        2016  |   1.811505   .9115186     1.99   0.047     .0208337    3.602177
              |
        cdum1 |   .3860474   .6380658     0.61   0.545    -.8674282    1.639523
        cdum2 |   .3348288   .6443891     0.52   0.604     -.931069    1.600727
        cdum3 |  -.4243871   .7117936    -0.60   0.551    -1.822701    .9739264
        cdum4 |   .5999345   .6249549     0.96   0.338     -.627785    1.827654
        cdum5 |    1.06839   .8083436     1.32   0.187    -.5195952    2.656375
        cdum6 |          0  (omitted)
        cdum7 |  -.0566997   .6503587    -0.09   0.931    -1.334325    1.220925
        cdum8 |   -.130258   .5136775    -0.25   0.800    -1.139374    .8788579
        cdum9 |   .6089256   .8442069     0.72   0.471    -1.049513    2.267364
       cdum10 |  -.1584766   .8911262    -0.18   0.859    -1.909088    1.592134
       cdum11 |  -.3137322   .5401944    -0.58   0.562     -1.37494    .7474759
       cdum12 |   .2610948   .6193861     0.42   0.674    -.9556848    1.477874
       cdum13 |   .3192523   .6290932     0.51   0.612    -.9165968    1.555101
       cdum14 |  -.8419289   .8349393    -1.01   0.314    -2.482161    .7983033
       cdum15 |  -.3990853   .7201504    -0.55   0.580    -1.813816    1.015645
       cdum16 |   .0195024   .7228197     0.03   0.978    -1.400472    1.439477
       cdum17 |   1.119898   .7055084     1.59   0.113    -.2660686    2.505864
       cdum18 |   1.975205   .6534307     3.02   0.003     .6915449    3.258865
       cdum19 |  -.0388023   .6352859    -0.06   0.951    -1.286817    1.209212
       cdum20 |          0  (omitted)
       cdum21 |  -1.098286   .8503509    -1.29   0.197    -2.768794    .5722225
       cdum22 |   2.755742   .6824149     4.04   0.000     1.415143    4.096341
       cdum23 |  -1.080613   1.041366    -1.04   0.300     -3.12637    .9651445
       cdum24 |   1.877611   .8042114     2.33   0.020     .2977432    3.457478
       cdum25 |   .1979827   .6392269     0.31   0.757    -1.057774    1.453739
       cdum26 |   .2785913   .3347601     0.83   0.406    -.3790426    .9362252
       cdum27 |  -.1670769   .7556191    -0.22   0.825    -1.651485    1.317331
       cdum28 |  -.7497835   .6845525    -1.10   0.274    -2.094582     .595015
       cdum29 |  -2.117114   .8616368    -2.46   0.014    -3.809794   -.4244351
       cdum30 |          0  (omitted)
       cdum31 |  -.1151961   .5611988    -0.21   0.837    -1.217667     .987275
       cdum32 |          0  (omitted)
        _cons |   .0589749   1.125122     0.05   0.958     -2.15132     2.26927
-------------------------------------------------------------------------------
(500 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        559
                                                F(61, 497)        =       8.26
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4499
                                                Root MSE          =     1.7754

-------------------------------------------------------------------------------
              |               Robust
  F3.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |   -.011119   .0247236    -0.45   0.653    -.0596946    .0374566
          L1. |   .0056584   .0317998     0.18   0.859    -.0568203    .0681371
          L2. |   .0011012   .0190708     0.06   0.954    -.0363681    .0385705
              |
     dlemptot |
          L1. |  -.0998702   .0555259    -1.80   0.073    -.2089646    .0092242
          L2. |  -.0407687   .0518647    -0.79   0.432    -.1426698    .0611325
              |
         year |
        1988  |  -1.696168   1.175348    -1.44   0.150    -4.005431    .6130953
        1989  |  -2.098208   1.381021    -1.52   0.129    -4.811567    .6151515
        1990  |  -1.985655   1.132034    -1.75   0.080    -4.209817    .2385074
        1991  |   .6010717   .8422791     0.71   0.476    -1.053795    2.255939
        1992  |   1.315351   .5074316     2.59   0.010     .3183758    2.312327
        1993  |   1.069413   .4803254     2.23   0.026     .1256939    2.013131
        1994  |   1.477294   .6785524     2.18   0.030     .1441088    2.810479
        1995  |   1.830132   .4518497     4.05   0.000      .942361    2.717903
        1996  |   1.801375   .4753151     3.79   0.000     .8675005     2.73525
        1997  |   1.892575   .5171469     3.66   0.000     .8765114    2.908639
        1998  |     1.1157   .4928225     2.26   0.024     .1474273    2.083972
        1999  |   .5726614   .5928713     0.97   0.335    -.5921816    1.737504
        2000  |   .8473572   .5070987     1.67   0.095    -.1489643    1.843679
        2001  |   .8050247   .4869409     1.65   0.099    -.1516918    1.761741
        2002  |   1.374687   .4759823     2.89   0.004     .4395018    2.309873
        2003  |   2.289446   .5011844     4.57   0.000     1.304744    3.274147
        2004  |   2.387751   .4792578     4.98   0.000      1.44613    3.329372
        2005  |   1.398805   .4873014     2.87   0.004     .4413806     2.35623
        2006  |   -2.48126   .7898318    -3.14   0.002    -4.033081   -.9294392
        2007  |  -1.187477   .5252173    -2.26   0.024    -2.219397   -.1555566
        2008  |   .5271013   .5950524     0.89   0.376     -.642027     1.69623
        2009  |   .0504927   .5946402     0.08   0.932    -1.117826    1.218811
        2010  |  -.2818531   .5822667    -0.48   0.629    -1.425861    .8621546
        2011  |   .9339571   .5202499     1.80   0.073    -.0882031    1.956117
        2012  |   1.337221   .4565921     2.93   0.004     .4401327     2.23431
        2013  |   1.559421   .4644788     3.36   0.001     .6468369    2.472005
        2014  |   2.106718   .4975717     4.23   0.000     1.129115    3.084322
        2015  |   2.000901   .4581136     4.37   0.000     1.100823    2.900979
              |
        cdum1 |  -.1690457   .6379275    -0.26   0.791    -1.422413    1.084322
        cdum2 |  -.2796747   .6433251    -0.43   0.664    -1.543647    .9842975
        cdum3 |  -.8613688   .6976296    -1.23   0.218    -2.232036    .5092981
        cdum4 |   .1658503   .6213904     0.27   0.790    -1.055026    1.386726
        cdum5 |   .5203291   .8296494     0.63   0.531    -1.109723    2.150381
        cdum6 |          0  (omitted)
        cdum7 |   -.642437   .6463045    -0.99   0.321    -1.912263    .6273889
        cdum8 |  -.6481924   .4991824    -1.30   0.195     -1.62896    .3325756
        cdum9 |  -.1481937   .8322767    -0.18   0.859    -1.783408    1.487021
       cdum10 |  -.7363569   .9201597    -0.80   0.424    -2.544239    1.071526
       cdum11 |  -.8394132   .5500002    -1.53   0.128    -1.920025     .241199
       cdum12 |  -.3857824   .6059863    -0.64   0.525    -1.576393    .8048283
       cdum13 |  -.2376838   .6301129    -0.38   0.706    -1.475697     1.00033
       cdum14 |  -1.438245   .8599605    -1.67   0.095    -3.127851     .251361
       cdum15 |  -.9514594   .7320979    -1.30   0.194    -2.389848    .4869289
       cdum16 |  -.5494294   .7295083    -0.75   0.452     -1.98273     .883871
       cdum17 |   .4756409   .7081239     0.67   0.502    -.9156446    1.866926
       cdum18 |   1.434803   .6883185     2.08   0.038     .0824297    2.787175
       cdum19 |  -.6763611   .6330797    -1.07   0.286    -1.920204    .5674813
       cdum20 |          0  (omitted)
       cdum21 |  -1.464492   .8359947    -1.75   0.080    -3.107011    .1780277
       cdum22 |   2.108777   .6666645     3.16   0.002     .7989485    3.418605
       cdum23 |  -1.478606   1.066548    -1.39   0.166    -3.574105    .6168926
       cdum24 |    1.51466   .7866453     1.93   0.055    -.0309005     3.06022
       cdum25 |   -.422358   .6354672    -0.66   0.507    -1.670891    .8261754
       cdum26 |   .1852238   .3544827     0.52   0.602    -.5112456    .8816931
       cdum27 |  -.5858858   .7395132    -0.79   0.429    -2.038843    .8670717
       cdum28 |  -1.446755    .679596    -2.13   0.034    -2.781991   -.1115201
       cdum29 |  -2.723808    .891701    -3.05   0.002    -4.475776   -.9718394
       cdum30 |          0  (omitted)
       cdum31 |  -.6326061   .5645368    -1.12   0.263    -1.741779    .4765668
       cdum32 |          0  (omitted)
        _cons |   .4378714   .5973836     0.73   0.464    -.7358372     1.61158
-------------------------------------------------------------------------------
(529 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        530
                                                F(60, 469)        =       8.19
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4513
                                                Root MSE          =     1.7957

-------------------------------------------------------------------------------
              |               Robust
  F4.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |  -.0183583   .0211373    -0.87   0.386    -.0598938    .0231772
          L1. |   .0170042   .0288892     0.59   0.556    -.0397642    .0737725
          L2. |  -.0075333   .0213611    -0.35   0.724    -.0495086    .0344419
              |
     dlemptot |
          L1. |  -.0490846   .0512008    -0.96   0.338     -.149696    .0515267
          L2. |  -.0802845   .0504263    -1.59   0.112    -.1793739    .0188049
              |
         year |
        1988  |  -.2855149   1.787789    -0.16   0.873    -3.798583    3.227554
        1989  |  -.1909888   1.598134    -0.12   0.905    -3.331378    2.949401
        1990  |   2.225749   1.299435     1.71   0.087    -.3276856    4.779184
        1991  |   3.240137   1.230981     2.63   0.009     .8212158    5.659058
        1992  |   2.985759   1.216072     2.46   0.014     .5961355    5.375382
        1993  |   3.596656    1.28773     2.79   0.005     1.066223     6.12709
        1994  |   3.352033   1.222671     2.74   0.006     .9494413    5.754625
        1995  |   3.242147   1.234406     2.63   0.009     .8164957    5.667799
        1996  |   3.589102   1.217016     2.95   0.003     1.197624    5.980581
        1997  |   2.951359   1.228216     2.40   0.017      .537871    5.364846
        1998  |   2.225043   1.262885     1.76   0.079    -.2565713    4.706656
        1999  |   2.590448   1.227616     2.11   0.035       .17814    5.002757
        2000  |   2.553702   1.221837     2.09   0.037     .1527498    4.954654
        2001  |   3.081645   1.214907     2.54   0.012     .6943101     5.46898
        2002  |   4.063326   1.222502     3.32   0.001     1.661067    6.465584
        2003  |   4.127035   1.215969     3.39   0.001     1.737613    6.516458
        2004  |   3.101247   1.217754     2.55   0.011     .7083189    5.494176
        2005  |  -.8134944   1.369487    -0.59   0.553    -3.504584    1.877595
        2006  |   .3880951   1.240951     0.31   0.755    -2.050417    2.826607
        2007  |   2.141999   1.262408     1.70   0.090    -.3386774    4.622676
        2008  |   1.850367   1.262139     1.47   0.143    -.6297804    4.330515
        2009  |   1.902939   1.242372     1.53   0.126     -.538365    4.344243
        2010  |   2.923946   1.253033     2.33   0.020     .4616932    5.386199
        2011  |    2.80829   1.221262     2.30   0.022     .4084677    5.208113
        2012  |   3.190673   1.220533     2.61   0.009     .7922822    5.589063
        2013  |   3.854416   1.231911     3.13   0.002     1.433668    6.275164
        2014  |    3.60687   1.217233     2.96   0.003     1.214964    5.998775
              |
        cdum1 |  -.3010244   .7060285    -0.43   0.670    -1.688395    1.086346
        cdum2 |  -.4502572   .7130275    -0.63   0.528    -1.851381    .9508668
        cdum3 |  -.9206926   .7535576    -1.22   0.222     -2.40146    .5600745
        cdum4 |  -.0043351   .6825276    -0.01   0.995    -1.345526    1.336856
        cdum5 |   .3876706   .9252326     0.42   0.675    -1.430444    2.205785
        cdum6 |          0  (omitted)
        cdum7 |  -.7294532   .7115754    -1.03   0.306    -2.127724    .6688173
        cdum8 |  -.7839248   .5634516    -1.39   0.165    -1.891127    .3232772
        cdum9 |  -.4131278   .8776965    -0.47   0.638    -2.137832    1.311576
       cdum10 |  -.8894321   1.018819    -0.87   0.383    -2.891447    1.112583
       cdum11 |  -.9773127   .6261758    -1.56   0.119     -2.20777    .2531447
       cdum12 |  -.5959393   .6645184    -0.90   0.370    -1.901741    .7098625
       cdum13 |  -.3917357   .7038281    -0.56   0.578    -1.774783    .9913111
       cdum14 |  -1.599153   .9359133    -1.71   0.088    -3.438256     .239949
       cdum15 |   -1.03377   .8050589    -1.28   0.200    -2.615739    .5481993
       cdum16 |  -.6905056    .791868    -0.87   0.384    -2.246554    .8655426
       cdum17 |   .2250941   .7948138     0.28   0.777    -1.336743    1.786931
       cdum18 |   1.298304   .7620648     1.70   0.089    -.1991801    2.795788
       cdum19 |  -.8906968   .7021419    -1.27   0.205     -2.27043    .4890366
       cdum20 |          0  (omitted)
       cdum21 |  -1.392267   .8792857    -1.58   0.114    -3.120094    .3355604
       cdum22 |   1.788872   .7157443     2.50   0.013     .3824091    3.195334
       cdum23 |  -1.721246   1.165006    -1.48   0.140    -4.010523    .5680312
       cdum24 |   1.379795   .8499525     1.62   0.105    -.2903913    3.049982
       cdum25 |  -.6265595   .7020764    -0.89   0.373    -2.006164    .7530452
       cdum26 |   .1823373   .3752612     0.49   0.627    -.5550641    .9197387
       cdum27 |  -.5606452   .7706217    -0.73   0.467    -2.074944    .9536534
       cdum28 |  -1.687035    .742753    -2.27   0.024    -3.146571   -.2274995
       cdum29 |  -2.874411   .9523367    -3.02   0.003    -4.745786   -1.003036
       cdum30 |          0  (omitted)
       cdum31 |  -.7424249   .6356413    -1.17   0.243    -1.991482    .5066326
       cdum32 |          0  (omitted)
        _cons |  -1.134489   1.176767    -0.96   0.336    -3.446877    1.177898
-------------------------------------------------------------------------------
(558 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        501
                                                F(59, 441)        =       9.41
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4746
                                                Root MSE          =     1.7359

-------------------------------------------------------------------------------
              |               Robust
  F5.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |  -.0149315   .0205317    -0.73   0.467    -.0552835    .0254206
          L1. |   .0170334   .0261104     0.65   0.515    -.0342829    .0683497
          L2. |  -.0107734    .017457    -0.62   0.537    -.0450826    .0235358
              |
     dlemptot |
          L1. |  -.0716649   .0450639    -1.59   0.112    -.1602316    .0169017
          L2. |  -.1081366   .0537604    -2.01   0.045    -.2137951   -.0024782
              |
         year |
        1988  |   .1631278   1.885845     0.09   0.931    -3.543232    3.869488
        1989  |   2.563565   1.586905     1.62   0.107    -.5552707      5.6824
        1990  |   3.315319   1.482807     2.24   0.026     .4010723    6.229566
        1991  |    3.30326   1.485147     2.22   0.027     .3844153    6.222105
        1992  |   3.883316   1.559942     2.49   0.013     .8174716    6.949161
        1993  |   3.532515   1.499816     2.36   0.019     .5848394    6.480191
        1994  |   3.231696   1.525667     2.12   0.035     .2332147    6.230178
        1995  |   3.461045    1.52972     2.26   0.024     .4545967    6.467493
        1996  |   3.156557   1.500042     2.10   0.036     .2084382    6.104675
        1997  |   2.281609   1.516607     1.50   0.133    -.6990673    5.262285
        1998  |   2.808604   1.510345     1.86   0.064    -.1597647    5.776973
        1999  |   2.851188   1.503858     1.90   0.059    -.1044309    5.806807
        2000  |   3.402232   1.502217     2.26   0.024     .4498371    6.354626
        2001  |   4.328187   1.501718     2.88   0.004     1.376774      7.2796
        2002  |   4.430936   1.495506     2.96   0.003     1.491732     7.37014
        2003  |   3.395247   1.500014     2.26   0.024     .4471825    6.343312
        2004  |  -.5784567   1.622493    -0.36   0.722    -3.767235    2.610322
        2005  |   .6245106   1.517146     0.41   0.681    -2.357224    3.606245
        2006  |    2.32664   1.536746     1.51   0.131    -.6936151    5.346895
        2007  |   2.075489   1.530349     1.36   0.176    -.9321938    5.083171
        2008  |   2.289907   1.521229     1.51   0.133    -.6998537    5.279667
        2009  |   3.510426   1.502444     2.34   0.020     .5575862    6.463267
        2010  |   3.298179   1.512919     2.18   0.030     .3247527    6.271606
        2011  |   3.111252   1.510717     2.06   0.040     .1421528    6.080351
        2012  |   3.926839   1.512424     2.60   0.010     .9543838    6.899293
        2013  |   3.850325   1.499773     2.57   0.011      .902734    6.797916
              |
        cdum1 |  -.2030385   .7318538    -0.28   0.782    -1.641393    1.235316
        cdum2 |  -.3729871   .7421256    -0.50   0.616    -1.831529    1.085555
        cdum3 |  -.9160686   .7804472    -1.17   0.241    -2.449927    .6177894
        cdum4 |   .0431413   .7194609     0.06   0.952    -1.370857    1.457139
        cdum5 |   .4823418   .9884174     0.49   0.626    -1.460252    2.424936
        cdum6 |          0  (omitted)
        cdum7 |  -.6529441   .7385411    -0.88   0.377    -2.104442    .7985535
        cdum8 |   -.770342   .5942928    -1.30   0.196     -1.93834     .397656
        cdum9 |  -.4038805   .9044342    -0.45   0.655    -2.181417    1.373656
       cdum10 |  -.9067297   1.053078    -0.86   0.390    -2.976405    1.162946
       cdum11 |  -.8168888   .6603564    -1.24   0.217    -2.114725    .4809478
       cdum12 |  -.5999545   .6806669    -0.88   0.379    -1.937709    .7377995
       cdum13 |  -.3695328   .7328505    -0.50   0.614    -1.809846    1.070781
       cdum14 |   -1.73175   .9509073    -1.82   0.069    -3.600623    .1371234
       cdum15 |  -1.048497   .8370134    -1.25   0.211    -2.693528     .596534
       cdum16 |  -.6611614   .8291544    -0.80   0.426    -2.290746    .9684237
       cdum17 |   .2918643   .8598126     0.34   0.734    -1.397975    1.981704
       cdum18 |   1.348136   .7342474     1.84   0.067    -.0949226    2.791195
       cdum19 |  -.9358141   .7257588    -1.29   0.198     -2.36219    .4905616
       cdum20 |          0  (omitted)
       cdum21 |  -1.696915   .8763128    -1.94   0.053    -3.419184     .025353
       cdum22 |   1.943681   .7484761     2.60   0.010     .4726574    3.414704
       cdum23 |  -1.889271   1.220033    -1.55   0.122    -4.287073    .5085317
       cdum24 |   1.542483   .8835829     1.75   0.082    -.1940733     3.27904
       cdum25 |  -.5773568   .7308509    -0.79   0.430     -2.01374    .8590268
       cdum26 |   .2397516   .3821375     0.63   0.531    -.5112853    .9907885
       cdum27 |    -.32269   .7587287    -0.43   0.671    -1.813863    1.168483
       cdum28 |  -1.708866   .7742213    -2.21   0.028    -3.230488   -.1872445
       cdum29 |  -2.410095   .7632239    -3.16   0.002    -3.910103   -.9100872
       cdum30 |          0  (omitted)
       cdum31 |  -.8053563    .668805    -1.20   0.229    -2.119798    .5090848
       cdum32 |          0  (omitted)
        _cons |   -1.40315   1.486824    -0.94   0.346    -4.325291     1.51899
-------------------------------------------------------------------------------
(587 missing values generated)
note: cdum6 omitted because of collinearity.
note: cdum20 omitted because of collinearity.
note: cdum30 omitted because of collinearity.
note: cdum32 omitted because of collinearity.

Linear regression                               Number of obs     =        472
                                                F(58, 413)        =       9.58
                                                Prob > F          =     0.0000
                                                R-squared         =     0.4884
                                                Root MSE          =     1.7266

-------------------------------------------------------------------------------
              |               Robust
  F6.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_U~w |
          --. |  -.0045351   .0212255    -0.21   0.831    -.0462585    .0371883
          L1. |   .0007198   .0291366     0.02   0.980    -.0565547    .0579942
          L2. |  -.0014257    .020165    -0.07   0.944    -.0410645    .0382131
              |
     dlemptot |
          L1. |  -.1368719   .0559233    -2.45   0.015    -.2468017   -.0269421
          L2. |  -.0299944   .0539009    -0.56   0.578    -.1359488      .07596
              |
         year |
        1988  |   2.474634   1.500725     1.65   0.100    -.4753772    5.424645
        1989  |    3.19472   1.335943     2.39   0.017     .5686241    5.820815
        1990  |   3.029288   1.328658     2.28   0.023     .4175125    5.641063
        1991  |   3.829358   1.419711     2.70   0.007     1.038596    6.620119
        1992  |   3.456911   1.337254     2.59   0.010     .8282374    6.085584
        1993  |   2.985778   1.387818     2.15   0.032     .2577109    5.713845
        1994  |   3.112985   1.379151     2.26   0.025     .4019541    5.824015
        1995  |    2.68239   1.356183     1.98   0.049     .0165073    5.348274
        1996  |   2.089377   1.340841     1.56   0.120    -.5463473    4.725102
        1997  |   1.271537   1.345936     0.94   0.345    -1.374203    3.917276
        1998  |   2.690032    1.34092     2.01   0.045     .0541526    5.325912
        1999  |    3.29765   1.339188     2.46   0.014     .6651757    5.930125
        2000  |   4.211961   1.341347     3.14   0.002     1.575243    6.848679
        2001  |   4.297329    1.33094     3.23   0.001     1.681067    6.913591
        2002  |   3.307402   1.330698     2.49   0.013     .6916163    5.923189
        2003  |  -.7055975   1.469102    -0.48   0.631    -3.593447    2.182252
        2004  |   .4952592   1.351397     0.37   0.714    -2.161216    3.151734
        2005  |   2.162406   1.376108     1.57   0.117    -.5426441    4.867456
        2006  |   1.857889   1.370795     1.36   0.176    -.8367171    4.552495
        2007  |   2.104763   1.359395     1.55   0.122    -.5674335     4.77696
        2008  |   3.433863   1.337418     2.57   0.011     .8048669     6.06286
        2009  |   3.470622   1.325951     2.62   0.009     .8641675    6.077076
        2010  |    3.04437    1.35227     2.25   0.025       .38618    5.702559
        2011  |   3.676773   1.355454     2.71   0.007     1.012323    6.341223
        2012  |   3.714267   1.327705     2.80   0.005     1.104365     6.32417
              |
        cdum1 |   -.079496   .6572875    -0.12   0.904    -1.371542     1.21255
        cdum2 |  -.2085481   .6674115    -0.31   0.755    -1.520495    1.103399
        cdum3 |  -.9637907    .692373    -1.39   0.165    -2.324805    .3972239
        cdum4 |   .2337956   .6581061     0.36   0.723     -1.05986    1.527451
        cdum5 |    .468714   .9648158     0.49   0.627    -1.427848    2.365276
        cdum6 |          0  (omitted)
        cdum7 |  -.4635006    .651832    -0.71   0.477    -1.744823    .8178215
        cdum8 |  -.6603433   .5205228    -1.27   0.205    -1.683548    .3628612
        cdum9 |  -.4468942    .845611    -0.53   0.597    -2.109132    1.215344
       cdum10 |  -.9087887   1.061723    -0.86   0.393    -2.995843    1.178266
       cdum11 |  -.4765333   .5822487    -0.82   0.414    -1.621074    .6680072
       cdum12 |  -.4666753   .5977733    -0.78   0.435    -1.641733    .7083824
       cdum13 |  -.2806232   .6596926    -0.43   0.671    -1.577397    1.016151
       cdum14 |  -1.692586    .902543    -1.88   0.061    -3.466737    .0815646
       cdum15 |  -1.057204   .7674944    -1.38   0.169    -2.565887    .4514786
       cdum16 |    -.63323   .7716559    -0.82   0.412    -2.150093     .883633
       cdum17 |   .3412198   .8594257     0.40   0.692    -1.348174    2.030614
       cdum18 |   1.074202   .6862621     1.57   0.118       -.2748    2.423205
       cdum19 |   -.905252   .6447815    -1.40   0.161    -2.172715    .3622109
       cdum20 |          0  (omitted)
       cdum21 |  -1.753476   .8144055    -2.15   0.032    -3.354373   -.1525794
       cdum22 |   2.079467   .6760222     3.08   0.002     .7505938    3.408341
       cdum23 |   -1.86002   1.231528    -1.51   0.132    -4.280865    .5608252
       cdum24 |   1.834978   .8069225     2.27   0.023     .2487903    3.421165
       cdum25 |  -.4023953   .6550699    -0.61   0.539    -1.690082    .8852918
       cdum26 |   .2607806   .3418436     0.76   0.446    -.4111898    .9327511
       cdum27 |  -.0739153   .6764523    -0.11   0.913    -1.403634    1.255804
       cdum28 |   -1.54309   .7141521    -2.16   0.031    -2.946917   -.1392638
       cdum29 |  -2.325601   .6976476    -3.33   0.001    -3.696984   -.9542178
       cdum30 |          0  (omitted)
       cdum31 |  -.6475095   .6083255    -1.06   0.288     -1.84331    .5482908
       cdum32 |          0  (omitted)
        _cons |  -1.393476    1.41061    -0.99   0.324    -4.166346    1.379394
-------------------------------------------------------------------------------
(616 missing values generated)
0   .02534339   .02516508
1   .02731127   .03581685
2   .04364364   .034052
3   -.011119   .02472086
4   -.01835832   .02113473
5   -.01493145   .02052892
6   -.00453509   .02122231

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20 SD 02/19/22
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs
>  for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  putexcel set $fxlsout, modify sheet("Table 2")
.  qui putexcel A1 = "Table 2 - Estimated Growth Impacts"
.  qui putexcel A3 = "y"
.  qui putexcel B3 = "Method"
.  qui putexcel C3 = "Sample"
.  qui putexcel D2 = "Impact in year"
.  qui putexcel D3   = "0"
.  qui putexcel E3   = "1-2"
.  qui putexcel F3   = "3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
            c1
r1   .30412067
r2   .41854863
r3  -.08306872

. mat list seirfavg

seirfavg[3,1]
           r1
r1    .301981
r2  .38706084
r3  .21064124

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`est'"

.  qui putexcel C`rn'   = "`smple'"

.  qui putexcel D`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel D`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
(714 observations deleted)

Panel variable: cnum (strongly balanced)
 Time variable: year, 1985 to 2018
         Delta: 1 unit

       Year |      Freq.     Percent        Cum.
------------+-----------------------------------
       1985 |         11        2.94        2.94
       1986 |         11        2.94        5.88
       1987 |         11        2.94        8.82
       1988 |         11        2.94       11.76
       1989 |         11        2.94       14.71
       1990 |         11        2.94       17.65
       1991 |         11        2.94       20.59
       1992 |         11        2.94       23.53
       1993 |         11        2.94       26.47
       1994 |         11        2.94       29.41
       1995 |         11        2.94       32.35
       1996 |         11        2.94       35.29
       1997 |         11        2.94       38.24
       1998 |         11        2.94       41.18
       1999 |         11        2.94       44.12
       2000 |         11        2.94       47.06
       2001 |         11        2.94       50.00
       2002 |         11        2.94       52.94
       2003 |         11        2.94       55.88
       2004 |         11        2.94       58.82
       2005 |         11        2.94       61.76
       2006 |         11        2.94       64.71
       2007 |         11        2.94       67.65
       2008 |         11        2.94       70.59
       2009 |         11        2.94       73.53
       2010 |         11        2.94       76.47
       2011 |         11        2.94       79.41
       2012 |         11        2.94       82.35
       2013 |         11        2.94       85.29
       2014 |         11        2.94       88.24
       2015 |         11        2.94       91.18
       2016 |         11        2.94       94.12
       2017 |         11        2.94       97.06
       2018 |         11        2.94      100.00
------------+-----------------------------------
      Total |        374      100.00

   LOCATION |      Freq.     Percent        Cum.
------------+-----------------------------------
        CHE |         34        9.09        9.09
        DNK |         34        9.09       18.18
        ESP |         34        9.09       27.27
        FIN |         34        9.09       36.36
        FRA |         34        9.09       45.45
        GBR |         34        9.09       54.55
        IRL |         34        9.09       63.64
        ISL |         34        9.09       72.73
        NOR |         34        9.09       81.82
        SVN |         34        9.09       90.91
        SWE |         34        9.09      100.00
------------+-----------------------------------
      Total |        374      100.00

Fixed-effects (within) regression               Number of obs     =        262
Group variable: cnum                            Number of groups  =         11

R-squared:                                      Obs per group:
     Within  = 0.4913                                         min =         10
     Between = 0.0151                                         avg =       23.8
     Overall = 0.3904                                         max =         28

                                                F(10,10)          =          .
corr(u_i, Xb) = -0.2552                         Prob > F          =          .

                                   (Std. err. adjusted for 11 clusters in cnum)
-------------------------------------------------------------------------------
              |               Robust
     dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          D1. |   .0099757   .0235722     0.42   0.681    -.0425463    .0624978
          LD. |   .0190899   .0186194     1.03   0.329    -.0223967    .0605765
         L2D. |   .0190424   .0134161     1.42   0.186    -.0108505    .0489354
         L3D. |   .0006396    .010575     0.06   0.953    -.0229231    .0242023
         L4D. |   .0090939   .0063768     1.43   0.184    -.0051146    .0233023
         L5D. |   .0154511   .0070366     2.20   0.053    -.0002275    .0311296
          L6. |   .0172574   .0090574     1.91   0.086    -.0029237    .0374385
              |
         year |
        1992  |  -.5051258   .3491963    -1.45   0.179    -1.283184     .272932
        1993  |  -.4166136   .4238124    -0.98   0.349    -1.360927    .5276994
        1994  |   2.270696   1.069158     2.12   0.060     -.111536    4.652929
        1995  |   3.451041   1.819225     1.90   0.087    -.6024454    7.504527
        1996  |   2.369228   1.693458     1.40   0.192    -1.404031    6.142488
        1997  |   2.913109   1.808458     1.61   0.138    -1.116388    6.942605
        1998  |   3.669348   1.576902     2.33   0.042     .1557913    7.182905
        1999  |   3.744941   1.542248     2.43   0.036     .3085976    7.181284
        2000  |   3.589266   1.580273     2.27   0.046     .0681993    7.110334
        2001  |   3.064946   1.575069     1.95   0.080    -.4445263    6.574419
        2002  |   2.284316    1.60294     1.43   0.185    -1.287257    5.855889
        2003  |    1.65275   1.556132     1.06   0.313    -1.814529     5.12003
        2004  |   2.193435   1.521028     1.44   0.180    -1.195627    5.582496
        2005  |   2.872624   1.581551     1.82   0.099    -.6512918    6.396541
        2006  |   3.736498   1.553951     2.40   0.037     .2740796    7.198917
        2007  |   4.039565   1.576043     2.56   0.028     .5279219    7.551209
        2008  |   2.654356   1.723859     1.54   0.155    -1.186642    6.495353
        2009  |  -1.956798   1.888039    -1.04   0.324    -6.163612    2.250015
        2010  |   .1679212   1.568066     0.11   0.917    -3.325948    3.661791
        2011  |   1.518145   1.630161     0.93   0.374     -2.11408    5.150369
        2012  |   1.347407   1.601029     0.84   0.420    -2.219908    4.914722
        2013  |   1.664462   1.435078     1.16   0.273    -1.533091    4.862016
        2014  |   2.405774   1.301843     1.85   0.094    -.4949126     5.30646
        2015  |   2.570054   1.319071     1.95   0.080    -.3690183    5.509127
        2016  |   2.708912    1.34991     2.01   0.073    -.2988753    5.716699
        2017  |   2.975163   1.396283     2.13   0.059    -.1359498    6.086276
        2018  |   2.930059   1.525213     1.92   0.084    -.4683278    6.328445
              |
        _cons |   -1.77231   1.492048    -1.19   0.262      -5.0968     1.55218
--------------+----------------------------------------------------------------
      sigma_u |   .8597493
      sigma_e |  1.5454735
          rho |  .23633308   (fraction of variance due to u_i)
-------------------------------------------------------------------------------

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20 SD 02/19/22
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs
>  for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  putexcel set $fxlsout, modify sheet("Table 2")
.  qui putexcel A1 = "Table 2 - Estimated Growth Impacts"
.  qui putexcel A3 = "y"
.  qui putexcel B3 = "Method"
.  qui putexcel C3 = "Sample"
.  qui putexcel D2 = "Impact in year"
.  qui putexcel D3   = "0"
.  qui putexcel E3   = "1-2"
.  qui putexcel F3   = "3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           y1
r1   .3990292
r2  .76264648
r3  .33579388

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .94288685
r2   .5985079
r3  .23002538

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`est'"

.  qui putexcel C`rn'   = "`smple'"

.  qui putexcel D`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel D`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        264
                                                F(46, 217)        =      18.32
                                                Prob > F          =     0.0000
                                                R-squared         =     0.7749
                                                Root MSE          =     1.0125

-------------------------------------------------------------------------------
              |               Robust
     dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |   .0206396   .0098284     2.10   0.037     .0012682     .040011
          L1. |  -.0195107   .0140772    -1.39   0.167    -.0472563    .0082349
          L2. |    .004619     .01009     0.46   0.648     -.015268     .024506
              |
     dlemptot |
          L1. |   .8627301   .0930728     9.27   0.000     .6792877    1.046172
          L2. |  -.2355635   .0870132    -2.71   0.007    -.4070628   -.0640643
              |
         year |
        1988  |  -.8335848    .564946    -1.48   0.142    -1.947069    .2798991
        1989  |  -.1048815   .8149999    -0.13   0.898    -1.711211    1.501448
        1990  |  -.3346121   .7176736    -0.47   0.642    -1.749115    1.079891
        1991  |  -2.236427    1.21545    -1.84   0.067    -4.632025    .1591722
        1992  |  -1.036253   .6532775    -1.59   0.114    -2.323835     .251328
        1993  |  -.8905434   .6193393    -1.44   0.152    -2.111234    .3301473
        1994  |   1.346173   .7759624     1.73   0.084    -.1832146    2.875561
        1995  |   .1051115   .8559952     0.12   0.902    -1.582018    1.792241
        1996  |  -.6977537   .7009334    -1.00   0.321    -2.079263    .6837554
        1997  |   .6449886     .61525     1.05   0.296    -.5676423    1.857619
        1998  |   .7431983   .6377584     1.17   0.245    -.5137957    2.000192
        1999  |   .2619969    .536284     0.49   0.626    -.7949955    1.318989
        2000  |   .2827657   .5061889     0.56   0.577    -.7149105    1.280442
        2001  |  -.1258739   .4904454    -0.26   0.798     -1.09252    .8407726
        2002  |  -.4740736    .544082    -0.87   0.385    -1.546435    .5982882
        2003  |  -.5498941   .5675807    -0.97   0.334    -1.668571    .5687827
        2004  |   .3409166   .5266584     0.65   0.518    -.6971041    1.378937
        2005  |   .4177828   .5514436     0.76   0.450    -.6690884    1.504654
        2006  |   .7969939   .5215082     1.53   0.128    -.2308759    1.824864
        2007  |    .521778   .4942287     1.06   0.292    -.4523251    1.495881
        2008  |  -.9123114   .6527518    -1.40   0.164    -2.198857     .374234
        2009  |  -3.647798   .7637554    -4.78   0.000    -5.153127    -2.14247
        2010  |   1.102635   .7067267     1.56   0.120    -.2902925    2.495562
        2011  |  -.1105434   .6569942    -0.17   0.867     -1.40545    1.184364
        2012  |  -.8859169   .5836781    -1.52   0.131    -2.036321     .264487
        2013  |  -.1450995   .5518274    -0.26   0.793    -1.232727    .9425281
        2014  |   .2070043   .5334441     0.39   0.698    -.8443907    1.258399
        2015  |  -.0477108   .5335875    -0.09   0.929    -1.099388    1.003967
        2016  |   .1024902   .5310927     0.19   0.847    -.9442704    1.149251
        2017  |   .1747499   .5360505     0.33   0.745    -.8817821    1.231282
        2018  |   .0043547   .5412922     0.01   0.994    -1.062509    1.071218
              |
        cdum1 |   .6669278   .5296847     1.26   0.209    -.3770575    1.710913
        cdum2 |   .4574164   .5147346     0.89   0.375    -.5571031    1.471936
        cdum3 |     .78708   .6299176     1.25   0.213    -.4544601     2.02862
        cdum4 |   .4151879   .4601343     0.90   0.368    -.4917166    1.322092
        cdum5 |   .6591813   .5699627     1.16   0.249    -.4641903    1.782553
        cdum6 |   .6504348   .5769501     1.13   0.261    -.4867086    1.787578
        cdum7 |   1.049481   .6346776     1.65   0.100    -.2014412    2.300402
        cdum8 |   1.213377    .610547     1.99   0.048     .0100155    2.416738
        cdum9 |   .4677776   .3996054     1.17   0.243    -.3198271    1.255382
       cdum10 |   .5262288    .509649     1.03   0.303     -.478267    1.530725
       cdum11 |          0  (omitted)
        _cons |  -.2659841   .6600411    -0.40   0.687    -1.566896    1.034928
-------------------------------------------------------------------------------
(110 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        253
                                                F(45, 207)        =      13.22
                                                Prob > F          =     0.0000
                                                R-squared         =     0.6081
                                                Root MSE          =     1.3352

-------------------------------------------------------------------------------
              |               Robust
   F.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |   .0190374   .0134128     1.42   0.157    -.0074058    .0454806
          L1. |  -.0172287   .0189014    -0.91   0.363    -.0544926    .0200352
          L2. |   .0058942   .0149452     0.39   0.694    -.0235701    .0353585
              |
     dlemptot |
          L1. |   .5531949   .0899414     6.15   0.000     .3758763    .7305135
          L2. |  -.3070269   .1084887    -2.83   0.005    -.5209113   -.0931425
              |
         year |
        1988  |   .0336239   1.066951     0.03   0.975     -2.06986    2.137108
        1989  |   .4638343   .5728807     0.81   0.419    -.6655945    1.593263
        1990  |  -1.471745   1.501479    -0.98   0.328    -4.431896    1.488407
        1991  |  -2.000342   1.460314    -1.37   0.172    -4.879338    .8786539
        1992  |  -.8890623   .8354976    -1.06   0.289    -2.536238    .7581132
        1993  |   1.348566   .7181654     1.88   0.062    -.0672904    2.764422
        1994  |   1.975883   .8109922     2.44   0.016     .3770196    3.574746
        1995  |   .5313495   .7540068     0.70   0.482    -.9551677    2.017867
        1996  |   .8063803   .9765112     0.83   0.410    -1.118802    2.731563
        1997  |   1.995142   .6373377     3.13   0.002     .7386369    3.251647
        1998  |   1.717901   .7379244     2.33   0.021     .2630905    3.172712
        1999  |   1.344575   .6628673     2.03   0.044     .0377385    2.651412
        2000  |   1.042883   .6076861     1.72   0.088    -.1551646     2.24093
        2001  |   .3690398   .6105797     0.60   0.546    -.8347123    1.572792
        2002  |   .0166907   .7086435     0.02   0.981    -1.380393    1.413775
        2003  |   .8308937   .6844884     1.21   0.226    -.5185685    2.180356
        2004  |   1.582502   .6882147     2.30   0.022     .2256933    2.939311
        2005  |   1.949502   .6257563     3.12   0.002     .7158295    3.183175
        2006  |   2.021455   .6539926     3.09   0.002     .7321153    3.310795
        2007  |   .4435992   .7280976     0.61   0.543    -.9918382    1.879037
        2008  |  -3.484128   1.099674    -3.17   0.002    -5.652125   -1.316131
        2009  |  -.9593686   .6952651    -1.38   0.169    -2.330077    .4113398
        2010  |   2.052895   .7880826     2.60   0.010     .4991978    3.606592
        2011  |  -.4193156   .8427476    -0.50   0.619    -2.080784    1.242153
        2012  |   -.208435   .6846953    -0.30   0.761    -1.558305    1.141435
        2013  |    1.07213   .6413949     1.67   0.096    -.1923737    2.336634
        2014  |   1.006604    .641071     1.57   0.118    -.2572617    2.270469
        2015  |   .9612525   .6673088     1.44   0.151    -.3543403    2.276845
        2016  |    1.19969   .6447865     1.86   0.064    -.0715004    2.470881
        2017  |   1.176395   .6655552     1.77   0.079    -.1357408    2.488531
              |
        cdum1 |   .9140648   .7325309     1.25   0.214    -.5301129    2.358242
        cdum2 |   .4443858   .6926153     0.64   0.522    -.9210986     1.80987
        cdum3 |   1.060735   .8626262     1.23   0.220     -.639924    2.761395
        cdum4 |   .3059291   .6344538     0.48   0.630    -.9448904    1.556749
        cdum5 |   .7990417   .7924872     1.01   0.315    -.7633392    2.361423
        cdum6 |   .8318234   .7871396     1.06   0.292    -.7200146    2.383662
        cdum7 |    1.44757   .8492187     1.70   0.090    -.2266567    3.121796
        cdum8 |   1.988457   .8556571     2.32   0.021     .3015373    3.675377
        cdum9 |   .5879551   .5418393     1.09   0.279    -.4802758    1.656186
       cdum10 |   .5182363   .6545417     0.79   0.429    -.7721863    1.808659
       cdum11 |          0  (omitted)
        _cons |  -.8587093   .8598608    -1.00   0.319    -2.553917    .8364981
-------------------------------------------------------------------------------
(121 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        242
                                                F(44, 197)        =       7.70
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5626
                                                Root MSE          =     1.4053

-------------------------------------------------------------------------------
              |               Robust
  F2.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |    .010838   .0135192     0.80   0.424     -.015823     .037499
          L1. |  -.0234746   .0177203    -1.32   0.187    -.0584205    .0114713
          L2. |   .0199932   .0110942     1.80   0.073    -.0018855    .0418718
              |
     dlemptot |
          L1. |   .2923133   .1049774     2.78   0.006     .0852896    .4993371
          L2. |  -.3407134   .1032758    -3.30   0.001    -.5443815   -.1370452
              |
         year |
        1988  |    .026688   1.079534     0.02   0.980    -2.102239    2.155615
        1989  |  -1.419484    1.57772    -0.90   0.369    -4.530873    1.691904
        1990  |  -2.035608   1.868976    -1.09   0.277    -5.721376     1.65016
        1991  |  -2.026242   1.452544    -1.39   0.165    -4.890774    .8382893
        1992  |   1.143268   1.143766     1.00   0.319     -1.11233    3.398866
        1993  |   1.491477   1.093204     1.36   0.174    -.6644085    3.647362
        1994  |   1.030469   1.064077     0.97   0.334    -1.067976    3.128913
        1995  |   1.143923    1.18765     0.96   0.337    -1.198217    3.486062
        1996  |   1.385224    1.05285     1.32   0.190    -.6910781    3.461527
        1997  |   1.793668   1.124436     1.60   0.112    -.4238092    4.011145
        1998  |   1.662609   1.107824     1.50   0.135    -.5221076    3.847325
        1999  |   1.131989   1.063253     1.06   0.288    -.9648307    3.228809
        2000  |   .6199964    1.06047     0.58   0.559    -1.471334    2.711327
        2001  |   .0723896   1.118202     0.06   0.948    -2.132794    2.277573
        2002  |   .7524834   1.131467     0.67   0.507    -1.478859    2.983826
        2003  |   1.469503   1.141502     1.29   0.199    -.7816302    3.720636
        2004  |   2.216559    1.06892     2.07   0.039      .108563    4.324554
        2005  |   2.144756   1.055241     2.03   0.043     .0637377    4.225774
        2006  |   .7700336   1.133938     0.68   0.498    -1.466183     3.00625
        2007  |  -3.213732    1.35319    -2.37   0.019     -5.88233   -.5451342
        2008  |   -1.36391     1.1477    -1.19   0.236    -3.627265    .8994443
        2009  |   .4444125   1.138798     0.39   0.697    -1.801387    2.690212
        2010  |   .8877521   1.138831     0.78   0.437    -1.358113    3.133617
        2011  |  -.7914985   1.116422    -0.71   0.479    -2.993171    1.410174
        2012  |   .3278757   1.047543     0.31   0.755    -1.737962    2.393714
        2013  |   1.074129    1.04719     1.03   0.306    -.9910125     3.13927
        2014  |   1.068352   1.039045     1.03   0.305    -.9807278    3.117432
        2015  |   1.259408   1.040096     1.21   0.227    -.7917431    3.310559
        2016  |   1.357682   1.037273     1.31   0.192    -.6879024    3.403267
              |
        cdum1 |   .9159061    .652947     1.40   0.162    -.3717571    2.203569
        cdum2 |   .1412427   .5767695     0.24   0.807    -.9961922    1.278678
        cdum3 |   .9106512   .8383598     1.09   0.279    -.7426605    2.563963
        cdum4 |  -.0419589   .5402456    -0.08   0.938    -1.107366    1.023448
        cdum5 |   .5539381    .683801     0.81   0.419    -.7945714    1.902448
        cdum6 |   .6812167   .6900159     0.99   0.325    -.6795493    2.041983
        cdum7 |   1.407548   .7437711     1.89   0.060    -.0592273    2.874324
        cdum8 |   2.169014   .7743982     2.80   0.006     .6418398    3.696189
        cdum9 |   .4975541   .4528679     1.10   0.273    -.3955372    1.390645
       cdum10 |   .1353318   .5564515     0.24   0.808    -.9620345    1.232698
       cdum11 |          0  (omitted)
        _cons |  -.3460494   1.263992    -0.27   0.785    -2.838741    2.146642
-------------------------------------------------------------------------------
(132 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        231
                                                F(43, 187)        =       7.78
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5487
                                                Root MSE          =      1.425

-------------------------------------------------------------------------------
              |               Robust
  F3.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |  -.0062248    .010746    -0.58   0.563    -.0274237    .0149742
          L1. |   .0057487   .0144813     0.40   0.692     -.022819    .0343164
          L2. |   .0061517   .0098129     0.63   0.531    -.0132065    .0255099
              |
     dlemptot |
          L1. |  -.0733327   .1070953    -0.68   0.494    -.2846029    .1379375
          L2. |  -.1149185   .0829947    -1.38   0.168    -.2786447    .0488076
              |
         year |
        1988  |  -1.680404   1.227984    -1.37   0.173    -4.102886    .7420783
        1989  |  -2.073723   1.442249    -1.44   0.152    -4.918892    .7714451
        1990  |  -2.037321   1.184944    -1.72   0.087    -4.374897    .3002556
        1991  |    .529296   .7696188     0.69   0.492     -.988955    2.047547
        1992  |   1.254437   .5250974     2.39   0.018     .2185615    2.290313
        1993  |   .7889753   .4815335     1.64   0.103    -.1609608    1.738911
        1994  |   1.490917   .6326484     2.36   0.019     .2428719    2.738962
        1995  |   1.534621   .4179695     3.67   0.000     .7100793    2.359162
        1996  |   1.566843   .4728355     3.31   0.001     .6340656     2.49962
        1997  |    1.67304   .5808416     2.88   0.004     .5271958    2.818884
        1998  |   1.364989   .4452658     3.07   0.002     .4865995    2.243379
        1999  |   .7305478    .480911     1.52   0.130    -.2181603    1.679256
        2000  |   .2255323   .5834781     0.39   0.700    -.9255131    1.376578
        2001  |   .7952743   .5929151     1.34   0.181    -.3743878    1.964936
        2002  |   1.421435   .6177863     2.30   0.023     .2027088    2.640161
        2003  |   2.143824   .4866124     4.41   0.000     1.183869     3.10378
        2004  |   2.290199    .475078     4.82   0.000     1.352998      3.2274
        2005  |   .9115381    .537315     1.70   0.091    -.1484399    1.971516
        2006  |  -2.959782   .9382074    -3.15   0.002    -4.810613   -1.108951
        2007  |  -1.140389   .5838692    -1.95   0.052    -2.292206    .0114276
        2008  |   .2649147   .6759748     0.39   0.696    -1.068602    1.598431
        2009  |  -.0178493   .6754278    -0.03   0.979    -1.350287    1.314588
        2010  |  -.1947237   .5891087    -0.33   0.741    -1.356877    .9674292
        2011  |   .2134143   .4871842     0.44   0.662     -.747669    1.174498
        2012  |   .8065224   .4404278     1.83   0.069    -.0623232    1.675368
        2013  |   1.153368   .4596898     2.51   0.013     .2465234    2.060212
        2014  |   1.381458   .4613369     2.99   0.003     .4713644    2.291551
        2015  |   1.460913   .4609871     3.17   0.002     .5515094    2.370316
              |
        cdum1 |   .8761594   .6768371     1.29   0.197     -.459058    2.211377
        cdum2 |  -.0853411   .5650718    -0.15   0.880    -1.200076    1.029394
        cdum3 |   .6483122   .8927407     0.73   0.469    -1.112825     2.40945
        cdum4 |  -.3120867   .5558808    -0.56   0.575     -1.40869    .7845166
        cdum5 |   .3092537   .6854408     0.45   0.652    -1.042937    1.661444
        cdum6 |   .5212278   .7016592     0.74   0.459    -.8629571    1.905413
        cdum7 |   1.250656   .7531372     1.66   0.098    -.2350811    2.736393
        cdum8 |   2.304656   .8031007     2.87   0.005     .7203546    3.888958
        cdum9 |    .513832   .4889355     1.05   0.295    -.4507063     1.47837
       cdum10 |  -.0939698   .5677535    -0.17   0.869    -1.213995    1.026055
       cdum11 |          0  (omitted)
        _cons |  -.0305742   .5969784    -0.05   0.959    -1.208252    1.147104
-------------------------------------------------------------------------------
(143 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        220
                                                F(42, 177)        =       7.11
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5478
                                                Root MSE          =     1.4479

-------------------------------------------------------------------------------
              |               Robust
  F4.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |  -.0043323   .0098397    -0.44   0.660    -.0237505    .0150859
          L1. |   .0091108   .0142713     0.64   0.524    -.0190529    .0372746
          L2. |     .00035     .01017     0.03   0.973      -.01972      .02042
              |
     dlemptot |
          L1. |  -.1440862   .0921287    -1.56   0.120    -.3258982    .0377258
          L2. |  -.0551604   .0882367    -0.63   0.533    -.2292917    .1189709
              |
         year |
        1988  |    -.31454   1.893177    -0.17   0.868    -4.050644    3.421564
        1989  |  -.3174087   1.715032    -0.19   0.853    -3.701952    3.067134
        1990  |   2.111095   1.383217     1.53   0.129    -.6186252    4.840815
        1991  |   3.022356   1.299762     2.33   0.021      .457331     5.58738
        1992  |   2.581922    1.31407     1.96   0.051    -.0113388    5.175182
        1993  |   3.133547    1.37286     2.28   0.024     .4242663    5.842827
        1994  |   2.983733   1.316735     2.27   0.025     .3852131    5.582253
        1995  |   2.958379   1.330788     2.22   0.027     .3321261    5.584632
        1996  |   3.334461   1.312256     2.54   0.012       .74478    5.924142
        1997  |    2.96852   1.289201     2.30   0.022     .4243382    5.512702
        1998  |   2.332728   1.289546     1.81   0.072    -.2121357    4.877591
        1999  |   1.883161   1.322548     1.42   0.156    -.7268304    4.493152
        2000  |   2.502307   1.335905     1.87   0.063    -.1340442    5.138659
        2001  |   3.160692   1.353285     2.34   0.021     .4900426    5.831342
        2002  |   3.914688   1.293745     3.03   0.003     1.361536    6.467839
        2003  |   4.054693   1.294277     3.13   0.002     1.500493    6.608894
        2004  |    2.59181    1.32902     1.95   0.053    -.0309543    5.214574
        2005  |  -1.352629   1.526654    -0.89   0.377    -4.365416    1.660157
        2006  |   .4573641   1.328917     0.34   0.731    -2.165197    3.079926
        2007  |   1.884029   1.355548     1.39   0.166    -.7910862    4.559145
        2008  |   1.772209   1.353607     1.31   0.192    -.8990752    4.443494
        2009  |   1.850904   1.315203     1.41   0.161    -.7445935    4.446402
        2010  |   2.058609   1.389783     1.48   0.140    -.6840675    4.801285
        2011  |   2.241891   1.314879     1.71   0.090    -.3529659    4.836748
        2012  |   2.763989   1.294412     2.14   0.034     .2095223    5.318455
        2013  |   2.993761   1.302259     2.30   0.023     .4238083    5.563714
        2014  |   3.068451   1.303494     2.35   0.020     .4960624     5.64084
              |
        cdum1 |   .8634107   .7435188     1.16   0.247    -.6038919    2.330713
        cdum2 |  -.0988002   .6258937    -0.16   0.875    -1.333975    1.136374
        cdum3 |   .5423856    .943545     0.57   0.566     -1.31966    2.404431
        cdum4 |  -.3293001   .6372503    -0.52   0.606    -1.586886     .928286
        cdum5 |   .2632318   .7476779     0.35   0.725    -1.212279    1.738742
        cdum6 |    .522068    .782369     0.67   0.505    -1.021904     2.06604
        cdum7 |   1.163386   .8278442     1.41   0.162    -.4703289    2.797101
        cdum8 |   2.465474   .8565408     2.88   0.004      .775127     4.15582
        cdum9 |   .5572602    .514543     1.08   0.280    -.4581684    1.572689
       cdum10 |   -.072462   .6343755    -0.11   0.909    -1.324375    1.179451
       cdum11 |          0  (omitted)
        _cons |  -1.672948   1.315618    -1.27   0.205    -4.269263    .9233675
-------------------------------------------------------------------------------
(154 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        209
                                                F(41, 167)        =       7.75
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5392
                                                Root MSE          =     1.4487

-------------------------------------------------------------------------------
              |               Robust
  F5.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |  -.0011992   .0099962    -0.12   0.905    -.0209343     .018536
          L1. |   .0119408   .0129398     0.92   0.357    -.0136058    .0374874
          L2. |  -.0071921   .0095139    -0.76   0.451    -.0259751    .0115909
              |
     dlemptot |
          L1. |  -.1650622   .1019539    -1.62   0.107    -.3663469    .0362224
          L2. |  -.0036356   .0887682    -0.04   0.967    -.1788881     .171617
              |
         year |
        1988  |   .1254917   2.003105     0.06   0.950    -3.829181    4.080164
        1989  |   2.452153   1.721153     1.42   0.156    -.9458699    5.850175
        1990  |   3.302061   1.611071     2.05   0.042     .1213691    6.482752
        1991  |   3.183914   1.593824     2.00   0.047      .037274    6.330553
        1992  |   3.538597   1.683514     2.10   0.037     .2148841    6.862311
        1993  |   3.308963   1.626626     2.03   0.044     .0975615    6.520364
        1994  |   3.015293   1.665652     1.81   0.072    -.2731561    6.303743
        1995  |   3.356518    1.64989     2.03   0.043     .0991877    6.613848
        1996  |   3.374007   1.579859     2.14   0.034     .2549383    6.493076
        1997  |   2.170366    1.63649     1.33   0.187    -1.060509     5.40124
        1998  |   2.120298   1.632034     1.30   0.196     -1.10178    5.342376
        1999  |   2.815818   1.628402     1.73   0.086    -.3990896    6.030725
        2000  |   3.504173   1.654694     2.12   0.036     .2373584    6.770988
        2001  |   4.321899   1.604004     2.69   0.008      1.15516    7.488638
        2002  |   4.511154    1.60124     2.82   0.005     1.349873    7.672435
        2003  |   3.045618   1.637288     1.86   0.065    -.1868331    6.278068
        2004  |  -1.039471   1.819195    -0.57   0.569    -4.631055    2.552113
        2005  |   .7215446   1.641383     0.44   0.661    -2.518989    3.962078
        2006  |   2.121326   1.654862     1.28   0.202    -1.145821    5.388472
        2007  |   2.048158   1.641584     1.25   0.214    -1.192773     5.28909
        2008  |   2.376305     1.6089     1.48   0.142    -.8000987    5.552709
        2009  |   2.979289    1.60021     1.86   0.064    -.1799587    6.138537
        2010  |   2.582152   1.716817     1.50   0.134    -.8073105    5.971615
        2011  |   2.976335   1.620255     1.84   0.068    -.2224861    6.175157
        2012  |   3.383599   1.600303     2.11   0.036     .2241669    6.543031
        2013  |   3.383368   1.618709     2.09   0.038     .1875974    6.579139
              |
        cdum1 |   .7543669   .7795533     0.97   0.335    -.7846826    2.293416
        cdum2 |  -.1898993   .6478536    -0.29   0.770    -1.468938    1.089139
        cdum3 |   .3139594   .9841219     0.32   0.750    -1.628964    2.256883
        cdum4 |  -.2519225   .6799196    -0.37   0.711    -1.594268    1.090423
        cdum5 |   .1092012   .7630544     0.14   0.886    -1.397275    1.615677
        cdum6 |   .3933676   .8201892     0.48   0.632    -1.225908    2.012643
        cdum7 |   .9767376   .8929638     1.09   0.276    -.7862149     2.73969
        cdum8 |   2.496382   .8711785     2.87   0.005     .7764395    4.216324
        cdum9 |    .507245   .5052014     1.00   0.317    -.4901595    1.504649
       cdum10 |  -.1900008   .6671422    -0.28   0.776     -1.50712    1.127119
       cdum11 |          0  (omitted)
        _cons |  -1.937714   1.659516    -1.17   0.245    -5.214047    1.338619
-------------------------------------------------------------------------------
(165 missing values generated)
note: cdum11 omitted because of collinearity.

Linear regression                               Number of obs     =        198
                                                F(40, 157)        =       7.55
                                                Prob > F          =     0.0000
                                                R-squared         =     0.5363
                                                Root MSE          =     1.4073

-------------------------------------------------------------------------------
              |               Robust
  F6.dlemptot | Coefficient  std. err.      t    P>|t|     [95% conf. interval]
--------------+----------------------------------------------------------------
rater_LCU_~18 |
          --. |   .0051116   .0107436     0.48   0.635    -.0161091    .0263323
          L1. |  -.0025528   .0179793    -0.14   0.887    -.0380654    .0329597
          L2. |   .0006134   .0133741     0.05   0.963     -.025803    .0270297
              |
     dlemptot |
          L1. |  -.1268565   .0941189    -1.35   0.180    -.3127591    .0590462
          L2. |  -.0071087   .0841683    -0.08   0.933     -.173357    .1591396
              |
         year |
        1988  |   2.474782   1.590412     1.56   0.122    -.6665819    5.616146
        1989  |   3.212166   1.435299     2.24   0.027     .3771795    6.047153
        1990  |   3.069796   1.415088     2.17   0.032     .2747299    5.864863
        1991  |   3.767296   1.500831     2.51   0.013       .80287    6.731721
        1992  |   3.381027   1.448722     2.33   0.021     .5195284    6.242527
        1993  |    2.95848   1.493272     1.98   0.049     .0089861    5.907974
        1994  |   2.902522   1.497579     1.94   0.054    -.0554805    5.860524
        1995  |   2.896645   1.406785     2.06   0.041     .1179781    5.675313
        1996  |   2.113493   1.418185     1.49   0.138    -.6876915    4.914677
        1997  |   1.239601   1.443972     0.86   0.392    -1.612517    4.091719
        1998  |   2.575852   1.467528     1.76   0.081    -.3227923    5.474497
        1999  |   3.355553   1.480859     2.27   0.025     .4305769    6.280528
        2000  |    4.20186   1.432353     2.93   0.004     1.372692    7.031028
        2001  |   4.462266   1.419166     3.14   0.002     1.659144    7.265389
        2002  |   3.059781    1.43662     2.13   0.035     .2221846    5.897378
        2003  |  -1.020705   1.633114    -0.63   0.533    -4.246414    2.205005
        2004  |   .5732318   1.482128     0.39   0.699    -2.354252    3.500715
        2005  |    1.91639   1.479478     1.30   0.197    -1.005858    4.838638
        2006  |   1.791577   1.466532     1.22   0.224    -1.105101    4.688254
        2007  |    2.17634   1.430997     1.52   0.130    -.6501502     5.00283
        2008  |   3.057279   1.396217     2.19   0.030     .2994867    5.815071
        2009  |   3.147937   1.435239     2.19   0.030     .3130672    5.982806
        2010  |   2.718922   1.512118     1.80   0.074    -.2677977    5.705641
        2011  |   3.184703   1.429523     2.23   0.027     .3611254     6.00828
        2012  |   3.382519   1.403747     2.41   0.017     .6098527    6.155185
              |
        cdum1 |   .7489689   .7575501     0.99   0.324    -.7473359    2.245274
        cdum2 |  -.2391814   .6057727    -0.39   0.693    -1.435697    .9573343
        cdum3 |   .0675812   .9447482     0.07   0.943    -1.798475    1.933637
        cdum4 |   -.064742   .6408894    -0.10   0.920     -1.33062    1.201136
        cdum5 |   .0320375   .7112011     0.05   0.964    -1.372719    1.436794
        cdum6 |   .2792066   .7826596     0.36   0.722    -1.266694    1.825107
        cdum7 |   .8327492   .9453169     0.88   0.380     -1.03443    2.699929
        cdum8 |    1.94281   .8772534     2.21   0.028     .2100689    3.675552
        cdum9 |   .4372843   .4698393     0.93   0.353    -.4907372    1.365306
       cdum10 |  -.1980744   .6496135    -0.30   0.761    -1.481184    1.085035
       cdum11 |          0  (omitted)
        _cons |   -1.81522   1.555516    -1.17   0.245    -4.887659    1.257219
-------------------------------------------------------------------------------
(176 missing values generated)
0   .02063962   .00982449
1   .01903738   .01340703
2   .01083801   .013513
3   -.00622475   .01074066
4   -.0043323   .00983437
5   -.00119916   .00999031
6   .00511157   .01073673

. * EUctax_IRF_AERPP_out_r1.do   JS 1/8/20 SD 02/19/22
. *   called from EUctax_IRF_AERPP.do
. *   Writes excel spreadsheet of IRFs and SEs
. *   Input are coefficient-level IRFs, VCV matrix, and (for LP) X-variable IRFs
>  for innovation
. *   Outputs are IRFs for $40 carbon tax
. *
. quietly

. local y "$y"

. local x "$x"

. local est "$est"

. local controls "$controls"

. local smple "$smple"

. local p $p

. local pp1 = `p'+1

. if irfno == 1 {
.  putexcel set $fxlsout, modify sheet("Table 2")
.  qui putexcel A1 = "Table 2 - Estimated Growth Impacts"
.  qui putexcel A3 = "y"
.  qui putexcel B3 = "Method"
.  qui putexcel C3 = "Sample"
.  qui putexcel D2 = "Impact in year"
.  qui putexcel D3   = "0"
.  qui putexcel E3   = "1-2"
.  qui putexcel F3   = "3-5"
. }

. * --------- Compute IRF wrt scaled shock and its VCV ------------
. if ("`est'" == "DL") {
.  mat ratefac = swfac*xpath[1,1]
.  mat irf = ratefac*b99[1..`pp1',1]
.  mat virf = ratefac*ratefac*v99[1..`pp1',1..`pp1']
. }

. if ("`est'" == "LP") {
.  * (i) compute the shocks to x that deliver the desired x path 
.  mat B = I(`p'+1)
.  forvalues h = 1/`p' {
  2.   forvalues i = 1/`h' {
  3.    mat B[`h'+1,`i'] = theta11[`h'-`i'+2,1]'
  4.   }
  5.  }
.  mat epsx = inv(B)*xpath*swfac
.  * (ii) compute IRF and its covariance matrix wrt the x shocks
.  mat shockmat = I(`pp1')
.  forvalues i = 1/`pp1' {
  2.   forvalues j = `i'/`pp1' {
  3.    mat shockmat[`i',`j'] = epsx[`j'-`i'+1,1]
  4.   }
  5.   /*
>  * Alternative (equivalent) VIRF calculation
>  mat L = J(`p'+1,`p'+1,0)
>  forvalues i = 1/`p' {
>   mat L[`i'+1,`i']=1
>  }
>  mat S = I(`p'+1) 
>  mat Lp = I(`p'+1)
>  forvalues i = 1/`p' {
>   mat Lp = Lp*L
>   mat S = S , Lp
>  }
>  mat list Lp
>  mat list S
>  mat H = vec(I(`p'+1)) * vec(I(`p'+1))'
>  mat list H
>  mat D = epsx' # S
>  mat virf88 = D * (H # v99) * D'
>  mat list virf88
>  mat list virf
>  */
.  }
.  mat irf = shockmat'*b99
.  mat virf = shockmat'*v99*shockmat
.  }

. *
. mat seirf = vecdiag(cholesky(diag(vecdiag(virf))))'

. * IRF at lag 0, average of 1&2, average of 3,4,&5
. mat A = [1  ,0  ,0  ,0  ,0  ,0  ,0\    ///
>          0  ,0.5,0.5,0  ,0  ,0  ,0\    ///
>              0  ,0  ,0  ,1/3,1/3,1/3,0]

. mat irfavg = A*irf

. mat seirfavg = vecdiag(cholesky(diag(vecdiag(A*virf*A'))))'

. mat list irfavg

irfavg[3,1]
           c1
r1  .82558489
r2  .57690674
r3  .05399162

. mat list seirfavg

seirfavg[3,1]
           r1
r1  .39297972
r2  .47960197
r3  .34975264

. 
. local rn = irfno*2+2

. local rnp1 = `rn'+1

.  qui putexcel A`rn'   = "`y'"

.  qui putexcel B`rn'   = "`est'"

.  qui putexcel C`rn'   = "`smple'"

.  qui putexcel D`rn'   = matrix(irfavg'), nformat(###.00)

.  qui putexcel D`rnp1' = matrix(seirfavg'), nformat(###.00)

.  
. noisily

. 
end of do-file

. log close
      name:  <unnamed>
       log:  C:\Users\gmetcalf\Dropbox\Metcalf_Stock\AER PP Submission Materials
> \Metcalf Stock Data Replication Public Folder\master.txt
  log type:  text
 closed on:  21 Mar 2022, 16:16:39
--------------------------------------------------------------------------------
